function va(q){var w=0;return function(){return w<q.length?{done:!1,value:q[w++]}:{done:!0}}}function fd(q){var w="undefined"!=typeof Symbol&&Symbol.iterator&&q[Symbol.iterator];return w?w.call(q):{next:va(q)}}var vd="function"==typeof Object.create?Object.create:function(q){function w(){}w.prototype=q;return new w},He="function"==typeof Object.defineProperties?Object.defineProperty:function(q,w,x){if(q==Array.prototype||q==Object.prototype)return q;q[w]=x.value;return q};
function Se(q){q=["object"==typeof globalThis&&globalThis,q,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var w=0;w<q.length;++w){var x=q[w];if(x&&x.Math==Math)return x}throw Error("Cannot find global object");}var Ig=Se(this);function Jg(q,w){if(w)a:{var x=Ig;q=q.split(".");for(var J=0;J<q.length-1;J++){var ja=q[J];if(!(ja in x))break a;x=x[ja]}q=q[q.length-1];J=x[q];w=w(J);w!=J&&null!=w&&He(x,q,{configurable:!0,writable:!0,value:w})}}var Ng;
if("function"==typeof Object.setPrototypeOf)Ng=Object.setPrototypeOf;else{var Og;a:{var Pg={a:!0},Qg={};try{Qg.__proto__=Pg;Og=Qg.a;break a}catch(q){}Og=!1}Ng=Og?function(q,w){q.__proto__=w;if(q.__proto__!==w)throw new TypeError(q+" is not extensible");return q}:null}var Rg=Ng;
function Sg(q,w){q.prototype=vd(w.prototype);q.prototype.constructor=q;if(Rg)Rg(q,w);else for(var x in w)if("prototype"!=x)if(Object.defineProperties){var J=Object.getOwnPropertyDescriptor(w,x);J&&Object.defineProperty(q,x,J)}else q[x]=w[x];q.bi=w.prototype}
Jg("Symbol",function(q){function w(fa){if(this instanceof w)throw new TypeError("Symbol is not a constructor");return new x(J+(fa||"")+"_"+ja++,fa)}function x(fa,Mb){this.Pf=fa;He(this,"description",{configurable:!0,writable:!0,value:Mb})}if(q)return q;x.prototype.toString=function(){return this.Pf};var J="jscomp_symbol_"+(1E9*Math.random()>>>0)+"_",ja=0;return w});
Jg("Symbol.iterator",function(q){if(q)return q;q=Symbol("Symbol.iterator");for(var w="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),x=0;x<w.length;x++){var J=Ig[w[x]];"function"===typeof J&&"function"!=typeof J.prototype[q]&&He(J.prototype,q,{configurable:!0,writable:!0,value:function(){return ih(va(this))}})}return q});function ih(q){q={next:q};q[Symbol.iterator]=function(){return this};return q}
function jh(q,w){q instanceof String&&(q+="");var x=0,J=!1,ja={next:function(){if(!J&&x<q.length){var fa=x++;return{value:w(fa,q[fa]),done:!1}}J=!0;return{done:!0,value:void 0}}};ja[Symbol.iterator]=function(){return ja};return ja}Jg("Array.prototype.keys",function(q){return q?q:function(){return jh(this,function(w){return w})}});Jg("Object.is",function(q){return q?q:function(w,x){return w===x?0!==w||1/w===1/x:w!==w&&x!==x}});
Jg("Array.prototype.includes",function(q){return q?q:function(w,x){var J=this;J instanceof String&&(J=String(J));var ja=J.length;x=x||0;for(0>x&&(x=Math.max(x+ja,0));x<ja;x++){var fa=J[x];if(fa===w||Object.is(fa,w))return!0}return!1}});
Jg("String.prototype.includes",function(q){return q?q:function(w,x){if(null==this)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(w instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return-1!==(this+"").indexOf(w,x||0)}});Jg("Array.prototype.values",function(q){return q?q:function(){return jh(this,function(w,x){return x})}});
function kh(q,w){return Object.prototype.hasOwnProperty.call(q,w)}
Jg("WeakMap",function(q){function w(z){this.Oc=(E+=Math.random()+1).toString();if(z){z=fd(z);for(var G;!(G=z.next()).done;)G=G.value,this.set(G[0],G[1])}}function x(){}function J(z){var G=typeof z;return"object"===G&&null!==z||"function"===G}function ja(z){if(!kh(z,Mb)){var G=new x;He(z,Mb,{value:G})}}function fa(z){var G=Object[z];G&&(Object[z]=function(T){if(T instanceof x)return T;Object.isExtensible(T)&&ja(T);return G(T)})}if(function(){if(!q||!Object.seal)return!1;try{var z=Object.seal({}),G=
Object.seal({}),T=new q([[z,2],[G,3]]);if(2!=T.get(z)||3!=T.get(G))return!1;T.delete(z);T.set(G,4);return!T.has(z)&&4==T.get(G)}catch(lc){return!1}}())return q;var Mb="$jscomp_hidden_"+Math.random();fa("freeze");fa("preventExtensions");fa("seal");var E=0;w.prototype.set=function(z,G){if(!J(z))throw Error("Invalid WeakMap key");ja(z);if(!kh(z,Mb))throw Error("WeakMap key fail: "+z);z[Mb][this.Oc]=G;return this};w.prototype.get=function(z){return J(z)&&kh(z,Mb)?z[Mb][this.Oc]:void 0};w.prototype.has=
function(z){return J(z)&&kh(z,Mb)&&kh(z[Mb],this.Oc)};w.prototype.delete=function(z){return J(z)&&kh(z,Mb)&&kh(z[Mb],this.Oc)?delete z[Mb][this.Oc]:!1};return w});
Jg("Map",function(q){function w(){var E={};return E.Cb=E.next=E.head=E}function x(E,z){var G=E.Ab;return ih(function(){if(G){for(;G.head!=E.Ab;)G=G.Cb;for(;G.next!=G.head;)return G=G.next,{done:!1,value:z(G)};G=null}return{done:!0,value:void 0}})}function J(E,z){var G=z&&typeof z;"object"==G||"function"==G?fa.has(z)?G=fa.get(z):(G=""+ ++Mb,fa.set(z,G)):G="p_"+z;var T=E.Kc[G];if(T&&kh(E.Kc,G))for(E=0;E<T.length;E++){var lc=T[E];if(z!==z&&lc.key!==lc.key||z===lc.key)return{id:G,list:T,index:E,Ja:lc}}return{id:G,
list:T,index:-1,Ja:void 0}}function ja(E){this.Kc={};this.Ab=w();this.size=0;if(E){E=fd(E);for(var z;!(z=E.next()).done;)z=z.value,this.set(z[0],z[1])}}if(function(){if(!q||"function"!=typeof q||!q.prototype.entries||"function"!=typeof Object.seal)return!1;try{var E=Object.seal({x:4}),z=new q(fd([[E,"s"]]));if("s"!=z.get(E)||1!=z.size||z.get({x:4})||z.set({x:4},"t")!=z||2!=z.size)return!1;var G=z.entries(),T=G.next();if(T.done||T.value[0]!=E||"s"!=T.value[1])return!1;T=G.next();return T.done||4!=
T.value[0].x||"t"!=T.value[1]||!G.next().done?!1:!0}catch(lc){return!1}}())return q;var fa=new WeakMap;ja.prototype.set=function(E,z){E=0===E?0:E;var G=J(this,E);G.list||(G.list=this.Kc[G.id]=[]);G.Ja?G.Ja.value=z:(G.Ja={next:this.Ab,Cb:this.Ab.Cb,head:this.Ab,key:E,value:z},G.list.push(G.Ja),this.Ab.Cb.next=G.Ja,this.Ab.Cb=G.Ja,this.size++);return this};ja.prototype.delete=function(E){E=J(this,E);return E.Ja&&E.list?(E.list.splice(E.index,1),E.list.length||delete this.Kc[E.id],E.Ja.Cb.next=E.Ja.next,
E.Ja.next.Cb=E.Ja.Cb,E.Ja.head=null,this.size--,!0):!1};ja.prototype.clear=function(){this.Kc={};this.Ab=this.Ab.Cb=w();this.size=0};ja.prototype.has=function(E){return!!J(this,E).Ja};ja.prototype.get=function(E){return(E=J(this,E).Ja)&&E.value};ja.prototype.entries=function(){return x(this,function(E){return[E.key,E.value]})};ja.prototype.keys=function(){return x(this,function(E){return E.key})};ja.prototype.values=function(){return x(this,function(E){return E.value})};ja.prototype.forEach=function(E,
z){for(var G=this.entries(),T;!(T=G.next()).done;)T=T.value,E.call(z,T[1],T[0],this)};ja.prototype[Symbol.iterator]=ja.prototype.entries;var Mb=0;return ja});
Jg("Set",function(q){function w(x){this.tb=new Map;if(x){x=fd(x);for(var J;!(J=x.next()).done;)this.add(J.value)}this.size=this.tb.size}if(function(){if(!q||"function"!=typeof q||!q.prototype.entries||"function"!=typeof Object.seal)return!1;try{var x=Object.seal({x:4}),J=new q(fd([x]));if(!J.has(x)||1!=J.size||J.add(x)!=J||1!=J.size||J.add({x:4})!=J||2!=J.size)return!1;var ja=J.entries(),fa=ja.next();if(fa.done||fa.value[0]!=x||fa.value[1]!=x)return!1;fa=ja.next();return fa.done||fa.value[0]==x||
4!=fa.value[0].x||fa.value[1]!=fa.value[0]?!1:ja.next().done}catch(Mb){return!1}}())return q;w.prototype.add=function(x){x=0===x?0:x;this.tb.set(x,x);this.size=this.tb.size;return this};w.prototype.delete=function(x){x=this.tb.delete(x);this.size=this.tb.size;return x};w.prototype.clear=function(){this.tb.clear();this.size=0};w.prototype.has=function(x){return this.tb.has(x)};w.prototype.entries=function(){return this.tb.entries()};w.prototype.values=function(){return this.tb.values()};w.prototype.keys=
w.prototype.values;w.prototype[Symbol.iterator]=w.prototype.values;w.prototype.forEach=function(x,J){var ja=this;this.tb.forEach(function(fa){return x.call(J,fa,fa,ja)})};return w});
(function(q){function w(){this.touches=[]}function x(b,a){this.Ld=this.Md=!1;this.jf=this.Tb=this.Ub=this.I=this.J=0;this.Wc=this.Ee=!1;this.x=this.y=0;this.id=b;this.Hh=a}function J(){this.ye=this.xe=this.J=this.I=this.y=this.x=this.Ub=this.Tb=0;this.we=this.vf=this.ue=this.ve=this.uf=this.te=this.right=this.left=this.yf=!1;this.ff=0;this.xc=this.uc=!1}function ja(){this.wf=new Set;this.se=new Set;this.Le=new Set;this.gf=new Set;this.keys=new ae}function fa(){}function Mb(b,a,c,e,f){this.Rc=new J;
this.touches=new w;this.keyboard=e?new ja:null;this.eb=0;this.de(b,c,a,f)}function E(){}function z(){return sc.apply(this,arguments)||this}function G(){return Ie.apply(this,arguments)||this}function T(b,a,c){M.Ba=!0;var e=M.call(this)||this;M.Ba=!1;e.ma(b,a,c);return e}function lc(b){M.Ba=!0;var a=M.call(this)||this;M.Ba=!1;a.ma(b);return a}function wd(b){M.Ba=!0;var a=M.call(this)||this;M.Ba=!1;a.ma(b);return a}function Id(b,a){M.Ba=!0;var c=M.call(this)||this;M.Ba=!1;c.ma(b,a);return c}function Te(b){var a=
M.call(this,b)||this;a.buffer=new Id(b,34963);return a}function Fc(b,a){M.Ba=!0;var c=M.call(this)||this;M.Ba=!1;c.ma(b,a);return c}function Xb(b,a,c){null==c&&(c=0);this.buffer=b;b=b.buffer;switch(b.o){case 0:var e=b.buffer.g;break;case 1:e=b.buffer.g}this.g=e;this.location=a;this.Lc=c}function nd(b){var a=M.call(this,b)||this;a.Jf=33071;a.Kf=33071;a.Vc=9729;a.Ya=b.createTexture();a.me=new Jd(b,[a],!1);return a}function Gc(b){M.Ba=!0;var a=M.call(this)||this;M.Ba=!1;a.ma(b);return a}function Kd(b,
a,c,e,f,g){null==g&&(g=9728);null==f&&(f=1);this.za=0;this.hb=[];this.Ha=[[],[]];this.B=b;this.Ah=f;for(var h=0;h<f;){++h;var m=b.createTexture(a,c,e),l=b.createTexture(a,c,e);m.Vc=g;m.g.bindTexture(3553,m.Ya);switch(g){case 9728:m.g.texParameteri(3553,10240,9728);m.g.texParameteri(3553,10241,9728);break;case 9729:m.g.texParameteri(3553,10240,9729),m.g.texParameteri(3553,10241,9729)}m.g.bindTexture(3553,null);l.Vc=g;l.g.bindTexture(3553,l.Ya);switch(g){case 9728:l.g.texParameteri(3553,10240,9728);
l.g.texParameteri(3553,10241,9728);break;case 9729:l.g.texParameteri(3553,10240,9729),l.g.texParameteri(3553,10241,9729)}l.g.bindTexture(3553,null);this.Ha[0].push(m);this.Ha[1].push(l)}this.hb.push(new Jd(b.g,this.Ha[0],!0));this.hb.push(new Jd(b.g,this.Ha[1],!0))}function Ue(b,a,c,e,f){this.I=this.J=this.W=this.K=this.L=this.G=0;this.ba=this.aa=this.$=this.Z=1;this.X=new be(b,35048);this.U=new be(a,35048);this.V=new be(c,35048);this.Y=new be(e,35048);this.S=new Kg(f,35048)}function xd(b,a){M.Ba=
!0;var c=M.call(this)||this;M.Ba=!1;c.ma(b,a);return c}function Tg(b){this.Mf=new ae;this.lb=b}function Kg(b,a){this.h=!1;this.length=0;this.data=new Int32Array(512);this.buffer=b;this.usage=a;this.maxLength=this.data.length}function Ug(){this.Ng=new Hc(0,0,0);this.zh=new Hc(0,0,0);this.Sb=new Vg(0,0,0,0)}function Ia(b){this.Xc=[];this.Sd=[];this.Qc=Array(G.Fa.hg);this.Of=!1;this.kb=new Ve(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);this.Za=new Ve(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);this.wc=new Ve(1,0,0,0,0,1,
0,0,0,0,1,0,0,0,0,1);this.ie=new Hc(0,0,0);this.fe=new Hc(0,0,0);this.he=new Hc(0,0,0);this.je=new Hc(0,0,0);this.gd=!1;this.od=new ae;this.canvas=b;this.g=b.getContext("webgl2",{premultipliedAlpha:!1,preserveDrawingBuffer:!0});this.jh();this.re();this.Nh();this.Jd=this.qc();this.Ua=this.Jd.Bc;this.$b=new lc(this.g);this.ge=Math.PI/3;this.Ye=1;this.fd=.1;this.ed=1E4;var a=this.kb,c=this.fd,e=this.ed,f=1/Math.tan(.5*this.ld());a.fa=f/(this.Uc/this.zc);a.ga=0;a.ha=0;a.na=0;a.ia=0;a.ja=f;a.ka=0;a.oa=
0;a.ca=0;a.da=0;a.ea=-(e+c)/(e-c);a.pa=-2*c*e/(e-c);a.qa=0;a.ra=0;a.sa=-1;a.ta=0;this.gd=!1;a=this.he;a.x=0;a.y=0;a.z=1;a=this.fe;a.x=0;a.y=0;a.z=0;a=this.ie;a.x=0;a.y=1;a.z=0;this.screen(b.width,b.height);this.Nb=this.nd=null;this.Yb=this.Xb=!1;b=0;for(a=this.Qc.length;b<a;)this.Qc[b++]=new Ug;this.Rb=0}function Jd(b,a,c){var e=M.call(this,b)||this;e.Ha=a.slice();e.depth=b.createRenderbuffer();e.td=b.createFramebuffer();c&&e.qf();return e}function M(b){M.Ba||this.ma(b)}function be(b,a){this.h=!1;
this.length=0;this.data=new Float32Array(512);this.buffer=b;this.usage=a;this.maxLength=this.data.length}function od(b,a){this.dc=b;this.canvas=a;this.resize();this.tc=new gd(We(this,this.update),We(this,this.fb));this.frameRate(Je.Yd(60))}function gd(b,a){this.ke=!1;this.lf=!0;this.count=0;this.Zb=16.666666666666668;this.update=b;this.fb=a}function Vg(b,a,c,e){this.x=b;this.y=a;this.z=c;this.w=e}function Hc(b,a,c){this.x=b;this.y=a;this.z=c}function Ve(b,a,c,e,f,g,h,m,l,u,K,H,C,r,p,B){this.fa=b;
this.ga=a;this.ha=c;this.na=e;this.ia=f;this.ja=g;this.ka=h;this.oa=m;this.ca=l;this.da=u;this.ea=K;this.pa=H;this.qa=C;this.ra=r;this.sa=p;this.ta=B}function Ld(){}function Xe(){}function ae(){this.C=Object.create(null)}function Ye(b,a,c){a=hb.call(this,String(b),a,c)||this;a.value=b;return a}function hb(b,a,c){a=Error.call(this,b);this.message=a.message;"stack"in a&&(this.stack=a.stack);this.message=b;this.Dg=null!=c?c:this}function Ke(){return ib.apply(this,arguments)||this}function yd(){return ib.apply(this,
arguments)||this}function Jc(){return ib.apply(this,arguments)||this}function tc(){return ib.apply(this,arguments)||this}function Md(){return ib.apply(this,arguments)||this}function Le(){return hd.apply(this,arguments)||this}function Qc(){return ib.apply(this,arguments)||this}function Nd(){return ib.apply(this,arguments)||this}function Me(){return hd.apply(this,arguments)||this}function Ne(){return ib.apply(this,arguments)||this}function Od(){return ib.apply(this,arguments)||this}function Oe(){return hd.apply(this,
arguments)||this}function hd(){return Pd.apply(this,arguments)||this}function Rc(){return ib.apply(this,arguments)||this}function ib(){return Pd.apply(this,arguments)||this}function Ze(){return Ie.apply(this,arguments)||this}function N(b,a,c,e){Ic.Ba=!0;var f=Ic.call(this)||this;Ic.Ba=!1;f.ma(b,a,c,e);return f}function Ic(b,a,c,e){Ic.Ba||this.ma(b,a,c,e)}function pd(){}function zd(){return sc.apply(this,arguments)||this}function Ad(){return sc.apply(this,arguments)||this}function sc(){return Pd.apply(this,
arguments)||this}function uc(b,a,c){this.data=b;this.name=a;this.type=c}function Pd(){}function Ie(){}function mc(){}function A(){return Ld.Ic(this,"")}function We(b,a){if(null==a)return null;null==a.ce&&(a.ce=q.Re++);var c;null==b.pe?b.pe={}:c=b.pe[a.ce];null==c&&(c=a.bind(b),b.pe[a.ce]=c);return c}var Sc=Sc||{},k;mc.remove=function(b,a){a=b.indexOf(a);if(-1==a)return!1;b.splice(a,1);return!0};mc.now=function(){return Date.now()};mc.D=!0;Math.D=!0;Ie.D=!0;Pd.D=!0;var n=Sc["hgsl.AttributeType"]={yb:!0,
Ca:null,m:{A:"Float",o:0,v:"hgsl.AttributeType",toString:A},wa:{A:"Int",o:1,v:"hgsl.AttributeType",toString:A},Hc:{A:"UInt",o:2,v:"hgsl.AttributeType",toString:A},i:(k=function(b){return{o:3,ab:b,v:"hgsl.AttributeType",toString:A}},k.A="Vec",k.F=["dim"],k),l:(k=function(b){return{o:4,ab:b,v:"hgsl.AttributeType",toString:A}},k.A="IVec",k.F=["dim"],k),ae:(k=function(b){return{o:5,ab:b,v:"hgsl.AttributeType",toString:A}},k.A="UVec",k.F=["dim"],k),j:(k=function(b,a){return{o:6,cols:b,rows:a,v:"hgsl.AttributeType",
toString:A}},k.A="Mat",k.F=["cols","rows"],k)};n.Ca=[n.m,n.wa,n.Hc,n.i,n.l,n.ae,n.j];var d=Sc["hgsl.UniformType"]={yb:!0,Ca:null,m:{A:"Float",o:0,v:"hgsl.UniformType",toString:A},wa:{A:"Int",o:1,v:"hgsl.UniformType",toString:A},Hc:{A:"UInt",o:2,v:"hgsl.UniformType",toString:A},Dc:{A:"Bool",o:3,v:"hgsl.UniformType",toString:A},i:(k=function(b){return{o:4,ab:b,v:"hgsl.UniformType",toString:A}},k.A="Vec",k.F=["dim"],k),l:(k=function(b){return{o:5,ab:b,v:"hgsl.UniformType",toString:A}},k.A="IVec",k.F=
["dim"],k),ae:(k=function(b){return{o:6,ab:b,v:"hgsl.UniformType",toString:A}},k.A="UVec",k.F=["dim"],k),Tf:(k=function(b){return{o:7,ab:b,v:"hgsl.UniformType",toString:A}},k.A="BVec",k.F=["dim"],k),j:(k=function(b,a){return{o:8,cols:b,rows:a,v:"hgsl.UniformType",toString:A}},k.A="Mat",k.F=["cols","rows"],k),s:(k=function(b){return{o:9,type:b,v:"hgsl.UniformType",toString:A}},k.A="Sampler",k.F=["type"],k),Array:(k=function(b,a){return{o:10,type:b,size:a,v:"hgsl.UniformType",toString:A}},k.A="Array",
k.F=["type","size"],k),Gc:{A:"Struct",o:11,v:"hgsl.UniformType",toString:A}};d.Ca=[d.m,d.wa,d.Hc,d.Dc,d.i,d.l,d.ae,d.Tf,d.j,d.s,d.Array,d.Gc];var t=Sc["hgsl.SamplerType"]={yb:!0,Ca:null,u:{A:"Sampler2D",o:0,v:"hgsl.SamplerType",toString:A},pg:{A:"Sampler3D",o:1,v:"hgsl.SamplerType",toString:A},qg:{A:"SamplerCube",o:2,v:"hgsl.SamplerType",toString:A},rg:{A:"SamplerCubeShadow",o:3,v:"hgsl.SamplerType",toString:A},og:{A:"Sampler2DShadow",o:4,v:"hgsl.SamplerType",toString:A},mg:{A:"Sampler2DArray",o:5,
v:"hgsl.SamplerType",toString:A},ng:{A:"Sampler2DArrayShadow",o:6,v:"hgsl.SamplerType",toString:A},bg:{A:"ISampler2D",o:7,v:"hgsl.SamplerType",toString:A},dg:{A:"ISampler3D",o:8,v:"hgsl.SamplerType",toString:A},eg:{A:"ISamplerCube",o:9,v:"hgsl.SamplerType",toString:A},cg:{A:"ISampler2DArray",o:10,v:"hgsl.SamplerType",toString:A},tg:{A:"USampler2D",o:11,v:"hgsl.SamplerType",toString:A},vg:{A:"USampler3D",o:12,v:"hgsl.SamplerType",toString:A},wg:{A:"USamplerCube",o:13,v:"hgsl.SamplerType",toString:A},
ug:{A:"USampler2DArray",o:14,v:"hgsl.SamplerType",toString:A}};t.Ca=[t.u,t.pg,t.qg,t.rg,t.og,t.mg,t.ng,t.bg,t.dg,t.eg,t.cg,t.tg,t.vg,t.wg,t.ug];uc.D=!0;Sg(sc,Pd);sc.D=!0;Sg(Ad,sc);Ad.D=!0;Sg(zd,sc);zd.D=!0;pd.lc=function(b){return Ld.Ic(b,"")};pd.D=!0;Ic.prototype.ma=function(b,a,c,e){null==e&&(e=!0);null==c&&(c=!1);null==a&&(a=Pe.Se);this.canvas=b;this.ub=new od(this,b);switch(a.o){case 0:this.input=new Mb(b,this.ub,b,c,e);break;case 1:this.input=new Mb(b,this.ub,window.document.documentElement,
c,e);break;case 2:this.input=null}this.ne=-1;this.Hf();this.ub.Gg()};Ic.prototype.Ge=function(){};Ic.prototype.Hf=function(){};Ic.prototype.update=function(){};Ic.prototype.fb=function(){};Ic.D=!0;Sg(N,Ic);N.prototype.ma=function(b,a,c,e){this.rc=this.Xd=!1;this.hc=new Hc(0,0,0);this.Vb=new Hc(0,0,0);this.ic=new Hc(0,0,0);this.Bd=this.sd=1;this.hf=!1;this.Je=0;this.Yg="pos vel mass gvel0 gvel1 gvel2 jacobian density aeration weightsX weightsY weightsZ rand".split(" ");this.sf=this.Oa=0;this.Ob=null;
Ic.prototype.ma.call(this,b,a,c,e)};N.prototype.Hf=function(){function b(C){h.Je!=C&&(h.Je=C,h.Nf())}this.ub.frameRate(Je.Yd(60));this.ub.ah();var a=this.B=new Ia(this.canvas),c=null;c=Math.PI/3;a.ge=c;a.Ye=2;a.fd=.1;a.ed=1E4;c=a.kb;var e=a.fd,f=a.ed,g=1/Math.tan(.5*a.ld());c.fa=g/(a.Uc/a.zc);c.ga=0;c.ha=0;c.na=0;c.ia=0;c.ja=g;c.ka=0;c.oa=0;c.ca=0;c.da=0;c.ea=-(f+e)/(f-e);c.pa=-2*e*f/(f-e);c.qa=0;c.ra=0;c.sa=-1;c.ta=0;this.B.fh();this.B.g.disable(2929);this.M=this.B.od;this.re();var h=this;a=h.B.bf();
c=a.nb;this.H={buffer:a.buffer,nb:a.nb,Db:a.Db,Sb:c[0],Me:c[1],Kd:c[2],ec:[c[3],c[4],c[5]],Id:c[6],pd:c[7],bd:c[8],wb:[c[9],c[10],c[11]],Bf:c[12]};a=h.B.bf();c=a.nb;this.yc={buffer:a.buffer,nb:a.nb,Db:a.Db,Sb:c[0],Me:c[1],Kd:c[2],ec:[c[3],c[4],c[5]],Id:c[6],pd:c[7],bd:c[8],wb:[c[9],c[10],c[11]],Bf:c[12]};a=hd.attributes;this.Ch=[new Xb(this.H.Sb,a.Cd.location),new Xb(this.H.Me,a.Ed.location),new Xb(this.H.Kd,a.Ad.location),new Xb(this.H.ec[0],a.wd.location),new Xb(this.H.ec[1],a.xd.location),new Xb(this.H.ec[2],
a.yd.location),new Xb(this.H.Id,a.zd.location),new Xb(this.H.pd,a.vd.location),new Xb(this.H.bd,a.ud.location),new Xb(this.H.wb[0],a.Fd.location),new Xb(this.H.wb[1],a.Gd.location),new Xb(this.H.wb[2],a.Hd.location),new Xb(this.H.Bf,a.Dd.location)];a=Md.attributes;this.Bh=this.B.qc([ha.pc(),ha.va(this.H.Sb,a.fc.location,1),ha.va(this.H.Id,a.Ce.location,1),ha.va(this.H.pd,a.Be.location,1),ha.va(this.H.bd,a.ze.location,1)]);a=tc.attributes;this.Nd=this.B.qc([ha.pc(),ha.$d(),ha.va(this.H.Sb,a.fc.location,
1),ha.va(this.H.Id,a.Ce.location,1),ha.va(this.H.pd,a.Be.location,1),ha.va(this.H.bd,a.ze.location,1)]);a=Nd.attributes;this.Ie=this.B.qc([ha.pc(),ha.va(this.H.Sb,a.fc.location,1),ha.va(this.H.Me,a.Gh.location,1),ha.va(this.H.Kd,a.De.location,1),ha.va(this.H.ec[0],a.Dh.location,1),ha.va(this.H.ec[1],a.Eh.location,1),ha.va(this.H.ec[2],a.Fh.location,1),ha.va(this.H.wb[0],a.Oe.location,1),ha.va(this.H.wb[1],a.Pe.location,1),ha.va(this.H.wb[2],a.Qe.location,1)]);a=Od.attributes;this.He=this.B.qc([ha.pc(),
ha.va(this.H.Sb,a.fc.location,1),ha.va(this.H.Kd,a.De.location,1),ha.va(this.H.wb[0],a.Oe.location,1),ha.va(this.H.wb[1],a.Pe.location,1),ha.va(this.H.wb[2],a.Qe.location,1)]);this.Th=this.B.qc();this.hh();this.gh();this.lh();this.mh();this.nh();this.Pc(N.pf);a=window.document.getElementById("low");c=window.document.getElementById("medium");e=window.document.getElementById("high");f=window.document.getElementById("super");g=window.document.getElementById("box");var m=window.document.getElementById("sphere"),
l=window.document.getElementById("cylinder"),u=window.document.getElementById("ink"),K=window.document.getElementById("foam"),H=window.document.getElementById("particles");e.checked=!0;g.checked=!0;a.onclick=function(){h.Pc(N.qh)};c.onclick=function(){h.Pc(N.xh)};e.onclick=function(){h.Pc(N.pf)};f.onclick=function(){h.Pc(N.Oh)};g.onclick=function(){b(0)};m.onclick=function(){b(1)};l.onclick=function(){b(2)};H.onclick=function(){h.hf=H.checked};u.oninput=function(){h.Bd=u.valueAsNumber};K.oninput=
function(){h.sd=K.valueAsNumber};this.ub.start()};N.prototype.Nf=function(){var b=this.M,a=Rc.N.mode.name;switch(this.Je){case 0:var c=Rc.Fa.Sf;break;case 1:c=Rc.Fa.lg;break;case 2:c=Rc.Fa.$f}b.C[a]=v.wa(c);this.M.C[Rc.N.size.name]=v.m(this.Ob.Fb);this.Wb(this.Og,this.Ga)};N.prototype.Pc=function(b){this.Ob=b;this.Oa=b.bc*b.nc*b.ac;this.rf();var a=ib.N;this.M.C[a.Va.R.name]=v.Gb(b.xb,b.Eb);this.M.C[a.Va.O.name]=v.be(1/b.xb,1/b.Eb);this.M.C[a.Va.P.name]=v.Gb(b.xb-1,b.Eb-1);this.M.C[a.Va.shift.name]=
v.Gb(0,N.log2(b.xb));this.M.C[a.Xa.R.name]=v.Ec(b.$a,b.pb,b.ob);this.M.C[a.Xa.O.name]=v.Hb(1/b.$a,1/b.pb,1/b.ob);this.M.C[a.Xa.P.name]=v.Ec(b.$a-1,b.pb-1,b.ob-1);this.M.C[a.Xa.shift.name]=v.Ec(0,N.log2(b.$a),N.log2(b.$a)+N.log2(b.pb));this.M.C[a.Wa.R.name]=v.Gb(b.cc,b.oc);this.M.C[a.Wa.O.name]=v.be(1/b.cc,1/b.oc);this.M.C[a.Wa.P.name]=v.Gb(b.cc-1,b.oc-1);this.M.C[a.Wa.shift.name]=v.Gb(0,N.log2(b.cc));this.M.C[a.cb.jb.name]=v.m(b.Ea);this.M.C[a.cb.ib.name]=v.m(b.Ea*b.Ea*b.Ea);var c=.5*(b.$a-1.6*b.bc),
e=.5*(b.ob-1.6*b.ac);this.M.C[Qc.N.$h.name]=v.Ec((1>c?1:c)|0,1,(1>e?1:e)|0);this.M.C[a.gb.name]=v.m(1);this.kh();null!=this.la&&this.la.xa();this.la=new Kd(this.B,b.xb,b.Eb,5131,Ze.Fa.sg);null!=this.Ga&&this.Ga.xa();this.Ga=new Kd(this.B,b.xb,b.Eb,5126);this.Nf()};N.prototype.re=function(){var b={Sh:this.Yg,kind:35980};this.Vg=this.createShader(Md.source);this.Sg=this.createShader(tc.source);this.Wg=this.createShader(Ke.source);this.ee=this.createShader(Jc.source);this.Ih=this.createShader(yd.source);
this.tf=this.createShader(Le.source,b);this.Pg=this.createShader(Oe.source,b);this.Lh=this.createShader(Od.source);this.zf=this.createShader(Me.source,b);this.Mh=this.createShader(Nd.source);this.$e=this.createShader(Ne.source);this.af=this.createShader(Qc.source);this.Og=this.createShader(Rc.source);this.createShader(Ad.source);this.createShader(zd.source)};N.prototype.rf=function(){var b=this.canvas.width/this.Ob.Cc|0,a=this.canvas.height/this.Ob.Cc|0,c=this.Da;null!=c&&c.xa();this.Da=new Kd(this.B,
b,a,5126);c=this.Ia;null!=c&&c.xa();this.Ia=new Kd(this.B,b,a,5131)};N.prototype.Eg=function(b){var a=this.Ob,c=this.H.Db*this.Oa,e=[];a=a.Fc*a.Ea*a.Ea*a.Ea;for(var f=0,g=0;g<b.length;){var h=b[g];++g;if(this.Oa==this.sf)break;var m=h.y,l=h.z;e.push(h.x);e.push(m);e.push(l);m=h.Yh;l=h.Zh;e.push(h.Xh);e.push(m);e.push(l);e.push(a);e.push(0);e.push(0);e.push(0);e.push(0);e.push(0);e.push(0);e.push(0);e.push(0);e.push(0);e.push(1);e.push(1);e.push(0);e.push(0);e.push(0);e.push(0);e.push(0);e.push(0);
e.push(0);e.push(0);e.push(0);e.push(0);h=Math.random();m=Math.random();e.push(Math.random());e.push(h);e.push(m);this.Oa++;++f}if(0!=f){if(e.length!=this.H.Db*f)throw hb.Sa("buffer sizes mismatch");this.H.buffer.If(c,new Float32Array(e));this.yc.buffer.If(c,new Float32Array(e))}};N.prototype.kh=function(){var b=this.Ob;this.H.buffer.buffer.id=0;this.yc.buffer.buffer.id=1;for(var a=[],c=.5*b.$a,e=.5*b.pb,f=.5*b.ob,g=b.bc,h=b.nc,m=b.ac,l=[],u=b.Fc*b.Ea*b.Ea*b.Ea,K=0,H=b.bc;K<H;)for(var C=K++,r=0,p=
b.nc;r<p;)for(var B=r++,ka=0,P=b.ac;ka<P;){var W=ka++,bb=b.Ea,y=(C+.5-.5*g)*bb,Cb=(B+.5-.5*h)*bb;bb*=W+.5-.5*m;var la=0*Math.PI,ia=Math.sin(la),wb=Math.cos(la),Ja=1-wb;la=c+((0*Ja+wb)*y+(0*Ja-0*ia)*Cb+(0*Ja+1*ia)*bb)+(C>>8);var Ka=0*(e+((0*Ja+0*ia)*y+(1*Ja+wb)*Cb+(0*Ja-0*ia)*bb)+(B>>8))+(B+5)*b.Ea;W=f+((0*Ja-1*ia)*y+(0*Ja+0*ia)*Cb+(0*Ja+wb)*bb)+(W>>8);l.push(la);l.push(Ka);l.push(W);l.push(0);l.push(0);l.push(0);a.push(la);a.push(Ka);a.push(W);a.push(0);a.push(0);a.push(0);a.push(u);a.push(0);a.push(0);
a.push(0);a.push(0);a.push(0);a.push(0);a.push(0);a.push(0);a.push(0);a.push(1);a.push(1);a.push(0);a.push(0);a.push(0);a.push(0);a.push(0);a.push(0);a.push(0);a.push(0);a.push(0);a.push(0);W=Math.random();y=Math.random();a.push(Math.random());a.push(W);a.push(y)}if(a.length!=this.H.Db*this.Oa)throw hb.Sa("buffer sizes mismatch");this.H.buffer.upload(new Float32Array(a),35050);this.yc.buffer.upload(new Float32Array(a),35050);this.sf=this.Oa;this.Oa=0};N.prototype.Ge=function(){this.rf()};N.prototype.Zg=
function(){var b=this.H.nb.length,a=this.H,c=this.yc,e=a.buffer;a.buffer=c.buffer;c.buffer=e;for(a=0;a<b;){e=a++;c=this.H.nb[e];e=this.yc.nb[e];var f=c.buffer;c.buffer=e.buffer;e.buffer=f}};N.prototype.lh=function(){var b=this.He,a=b.Bc;b.mode=0;var c=a.X;c.length+3>c.maxLength&&c.expand();c.data[c.length++]=-1;c.data[c.length++]=0;c.data[c.length++]=0;c.h=!0;c=a.U;var e=a.ba,f=a.aa,g=a.$,h=a.Z;c.length+4>c.maxLength&&c.expand();c.data[c.length++]=e;c.data[c.length++]=f;c.data[c.length++]=g;c.data[c.length++]=
h;c.h=!0;c=a.V;e=a.I;f=a.J;g=a.W;c.length+3>c.maxLength&&c.expand();c.data[c.length++]=e;c.data[c.length++]=f;c.data[c.length++]=g;c.h=!0;c=a.Y;e=a.K;f=a.L;c.length+2>c.maxLength&&c.expand();c.data[c.length++]=e;c.data[c.length++]=f;c.h=!0;c=a.S;e=a.G;c.length+1>c.maxLength&&c.expand();c.data[c.length++]=e;c.h=!0;a.G++;c=a.X;c.length+3>c.maxLength&&c.expand();c.data[c.length++]=0;c.data[c.length++]=0;c.data[c.length++]=0;c.h=!0;c=a.U;e=a.ba;f=a.aa;g=a.$;h=a.Z;c.length+4>c.maxLength&&c.expand();c.data[c.length++]=
e;c.data[c.length++]=f;c.data[c.length++]=g;c.data[c.length++]=h;c.h=!0;c=a.V;e=a.I;f=a.J;g=a.W;c.length+3>c.maxLength&&c.expand();c.data[c.length++]=e;c.data[c.length++]=f;c.data[c.length++]=g;c.h=!0;c=a.Y;e=a.K;f=a.L;c.length+2>c.maxLength&&c.expand();c.data[c.length++]=e;c.data[c.length++]=f;c.h=!0;c=a.S;e=a.G;c.length+1>c.maxLength&&c.expand();c.data[c.length++]=e;c.h=!0;a.G++;c=a.X;c.length+3>c.maxLength&&c.expand();c.data[c.length++]=1;c.data[c.length++]=0;c.data[c.length++]=0;c.h=!0;c=a.U;
e=a.ba;f=a.aa;g=a.$;h=a.Z;c.length+4>c.maxLength&&c.expand();c.data[c.length++]=e;c.data[c.length++]=f;c.data[c.length++]=g;c.data[c.length++]=h;c.h=!0;c=a.V;e=a.I;f=a.J;g=a.W;c.length+3>c.maxLength&&c.expand();c.data[c.length++]=e;c.data[c.length++]=f;c.data[c.length++]=g;c.h=!0;c=a.Y;e=a.K;f=a.L;c.length+2>c.maxLength&&c.expand();c.data[c.length++]=e;c.data[c.length++]=f;c.h=!0;c=a.S;e=a.G;c.length+1>c.maxLength&&c.expand();c.data[c.length++]=e;c.h=!0;a.G++;a.upload();b.Aa.lb=this.Lh};N.prototype.mh=
function(){var b=this.Ie,a=b.Bc;b.mode=0;var c=a.X;c.length+3>c.maxLength&&c.expand();c.data[c.length++]=-1;c.data[c.length++]=-1;c.data[c.length++]=0;c.h=!0;var e=a.U,f=a.ba,g=a.aa,h=a.$,m=a.Z;e.length+4>e.maxLength&&e.expand();e.data[e.length++]=f;e.data[e.length++]=g;e.data[e.length++]=h;e.data[e.length++]=m;e.h=!0;var l=a.V,u=a.I,K=a.J,H=a.W;l.length+3>l.maxLength&&l.expand();l.data[l.length++]=u;l.data[l.length++]=K;l.data[l.length++]=H;l.h=!0;var C=a.Y,r=a.K,p=a.L;C.length+2>C.maxLength&&C.expand();
C.data[C.length++]=r;C.data[C.length++]=p;C.h=!0;var B=a.S,ka=a.G;B.length+1>B.maxLength&&B.expand();B.data[B.length++]=ka;B.h=!0;a.G++;var P=a.X;P.length+3>P.maxLength&&P.expand();P.data[P.length++]=-1;P.data[P.length++]=0;P.data[P.length++]=0;P.h=!0;var W=a.U,bb=a.ba,y=a.aa,Cb=a.$,la=a.Z;W.length+4>W.maxLength&&W.expand();W.data[W.length++]=bb;W.data[W.length++]=y;W.data[W.length++]=Cb;W.data[W.length++]=la;W.h=!0;var ia=a.V,wb=a.I,Ja=a.J,Ka=a.W;ia.length+3>ia.maxLength&&ia.expand();ia.data[ia.length++]=
wb;ia.data[ia.length++]=Ja;ia.data[ia.length++]=Ka;ia.h=!0;var jb=a.Y,Pb=a.K,xb=a.L;jb.length+2>jb.maxLength&&jb.expand();jb.data[jb.length++]=Pb;jb.data[jb.length++]=xb;jb.h=!0;var qa=a.S,Aa=a.G;qa.length+1>qa.maxLength&&qa.expand();qa.data[qa.length++]=Aa;qa.h=!0;a.G++;var Sa=a.X;Sa.length+3>Sa.maxLength&&Sa.expand();Sa.data[Sa.length++]=-1;Sa.data[Sa.length++]=1;Sa.data[Sa.length++]=0;Sa.h=!0;var Ba=a.U,Qb=a.ba,cb=a.aa,ba=a.$,db=a.Z;Ba.length+4>Ba.maxLength&&Ba.expand();Ba.data[Ba.length++]=Qb;
Ba.data[Ba.length++]=cb;Ba.data[Ba.length++]=ba;Ba.data[Ba.length++]=db;Ba.h=!0;var ca=a.V,kb=a.I,ra=a.J,La=a.W;ca.length+3>ca.maxLength&&ca.expand();ca.data[ca.length++]=kb;ca.data[ca.length++]=ra;ca.data[ca.length++]=La;ca.h=!0;var X=a.Y,ma=a.K,R=a.L;X.length+2>X.maxLength&&X.expand();X.data[X.length++]=ma;X.data[X.length++]=R;X.h=!0;var L=a.S,Ca=a.G;L.length+1>L.maxLength&&L.expand();L.data[L.length++]=Ca;L.h=!0;a.G++;var U=a.X;U.length+3>U.maxLength&&U.expand();U.data[U.length++]=0;U.data[U.length++]=
-1;U.data[U.length++]=0;U.h=!0;var Q=a.U,Da=a.ba,Y=a.aa,Eb=a.$,Fb=a.Z;Q.length+4>Q.maxLength&&Q.expand();Q.data[Q.length++]=Da;Q.data[Q.length++]=Y;Q.data[Q.length++]=Eb;Q.data[Q.length++]=Fb;Q.h=!0;var wa=a.V,Ma=a.I,Gb=a.J,Hb=a.W;wa.length+3>wa.maxLength&&wa.expand();wa.data[wa.length++]=Ma;wa.data[wa.length++]=Gb;wa.data[wa.length++]=Hb;wa.h=!0;var xa=a.Y,lb=a.K,Ta=a.L;xa.length+2>xa.maxLength&&xa.expand();xa.data[xa.length++]=lb;xa.data[xa.length++]=Ta;xa.h=!0;var yb=a.S,bc=a.G;yb.length+1>yb.maxLength&&
yb.expand();yb.data[yb.length++]=bc;yb.h=!0;a.G++;var Na=a.X;Na.length+3>Na.maxLength&&Na.expand();Na.data[Na.length++]=0;Na.data[Na.length++]=0;Na.data[Na.length++]=0;Na.h=!0;var Ua=a.U,ob=a.ba,nc=a.aa,cc=a.$,na=a.Z;Ua.length+4>Ua.maxLength&&Ua.expand();Ua.data[Ua.length++]=ob;Ua.data[Ua.length++]=nc;Ua.data[Ua.length++]=cc;Ua.data[Ua.length++]=na;Ua.h=!0;var sa=a.V,pc=a.I,Ac=a.J,dc=a.W;sa.length+3>sa.maxLength&&sa.expand();sa.data[sa.length++]=pc;sa.data[sa.length++]=Ac;sa.data[sa.length++]=dc;
sa.h=!0;var Ea=a.Y,I=a.K,oc=a.L;Ea.length+2>Ea.maxLength&&Ea.expand();Ea.data[Ea.length++]=I;Ea.data[Ea.length++]=oc;Ea.h=!0;var Nb=a.S,qc=a.G;Nb.length+1>Nb.maxLength&&Nb.expand();Nb.data[Nb.length++]=qc;Nb.h=!0;a.G++;var F=a.X;F.length+3>F.maxLength&&F.expand();F.data[F.length++]=0;F.data[F.length++]=1;F.data[F.length++]=0;F.h=!0;var D=a.U,V=a.ba,Va=a.aa,Oa=a.$,eb=a.Z;D.length+4>D.maxLength&&D.expand();D.data[D.length++]=V;D.data[D.length++]=Va;D.data[D.length++]=Oa;D.data[D.length++]=eb;D.h=!0;
var Wa=a.V,Pa=a.I,Ib=a.J,fb=a.W;Wa.length+3>Wa.maxLength&&Wa.expand();Wa.data[Wa.length++]=Pa;Wa.data[Wa.length++]=Ib;Wa.data[Wa.length++]=fb;Wa.h=!0;var Z=a.Y,pb=a.K,Yb=a.L;Z.length+2>Z.maxLength&&Z.expand();Z.data[Z.length++]=pb;Z.data[Z.length++]=Yb;Z.h=!0;var Db=a.S,zb=a.G;Db.length+1>Db.maxLength&&Db.expand();Db.data[Db.length++]=zb;Db.h=!0;a.G++;var aa=a.X;aa.length+3>aa.maxLength&&aa.expand();aa.data[aa.length++]=1;aa.data[aa.length++]=-1;aa.data[aa.length++]=0;aa.h=!0;var Fa=a.U,oa=a.ba,ta=
a.aa,Xa=a.$,Jb=a.Z;Fa.length+4>Fa.maxLength&&Fa.expand();Fa.data[Fa.length++]=oa;Fa.data[Fa.length++]=ta;Fa.data[Fa.length++]=Xa;Fa.data[Fa.length++]=Jb;Fa.h=!0;var Ya=a.V,Ab=a.I,Za=a.J,ya=a.W;Ya.length+3>Ya.maxLength&&Ya.expand();Ya.data[Ya.length++]=Ab;Ya.data[Ya.length++]=Za;Ya.data[Ya.length++]=ya;Ya.h=!0;var gb=a.Y,Rb=a.K,Ob=a.L;gb.length+2>gb.maxLength&&gb.expand();gb.data[gb.length++]=Rb;gb.data[gb.length++]=Ob;gb.h=!0;var Bb=a.S,$a=a.G;Bb.length+1>Bb.maxLength&&Bb.expand();Bb.data[Bb.length++]=
$a;Bb.h=!0;a.G++;var Qa=a.X;Qa.length+3>Qa.maxLength&&Qa.expand();Qa.data[Qa.length++]=1;Qa.data[Qa.length++]=0;Qa.data[Qa.length++]=0;Qa.h=!0;var za=a.U,Sb=a.ba,qb=a.aa,ec=a.$,fc=a.Z;za.length+4>za.maxLength&&za.expand();za.data[za.length++]=Sb;za.data[za.length++]=qb;za.data[za.length++]=ec;za.data[za.length++]=fc;za.h=!0;var Ga=a.V,O=a.I,S=a.J,Ra=a.W;Ga.length+3>Ga.maxLength&&Ga.expand();Ga.data[Ga.length++]=O;Ga.data[Ga.length++]=S;Ga.data[Ga.length++]=Ra;Ga.h=!0;var da=a.Y,rb=a.K,sb=a.L;da.length+
2>da.maxLength&&da.expand();da.data[da.length++]=rb;da.data[da.length++]=sb;da.h=!0;var Ha=a.S,tb=a.G;Ha.length+1>Ha.maxLength&&Ha.expand();Ha.data[Ha.length++]=tb;Ha.h=!0;a.G++;var pa=a.X;pa.length+3>pa.maxLength&&pa.expand();pa.data[pa.length++]=1;pa.data[pa.length++]=1;pa.data[pa.length++]=0;pa.h=!0;var ea=a.U,ub=a.ba,vb=a.aa,vc=a.$,mb=a.Z;ea.length+4>ea.maxLength&&ea.expand();ea.data[ea.length++]=ub;ea.data[ea.length++]=vb;ea.data[ea.length++]=vc;ea.data[ea.length++]=mb;ea.h=!0;var nb=a.V,gc=
a.I,hc=a.J,ic=a.W;nb.length+3>nb.maxLength&&nb.expand();nb.data[nb.length++]=gc;nb.data[nb.length++]=hc;nb.data[nb.length++]=ic;nb.h=!0;var Lb=a.Y,Bc=a.K,Zb=a.L;Lb.length+2>Lb.maxLength&&Lb.expand();Lb.data[Lb.length++]=Bc;Lb.data[Lb.length++]=Zb;Lb.h=!0;var ua=a.S,ab=a.G;ua.length+1>ua.maxLength&&ua.expand();ua.data[ua.length++]=ab;ua.h=!0;a.G++;a.upload();b.Aa.lb=this.Mh};N.prototype.hh=function(){var b=this.Bh,a=b.Bc;b.mode=4;var c=a.X;c.length+3>c.maxLength&&c.expand();c.data[c.length++]=-1;c.data[c.length++]=
-1;c.data[c.length++]=-1;c.h=!0;var e=a.U,f=a.ba,g=a.aa,h=a.$,m=a.Z;e.length+4>e.maxLength&&e.expand();e.data[e.length++]=f;e.data[e.length++]=g;e.data[e.length++]=h;e.data[e.length++]=m;e.h=!0;var l=a.V,u=a.I,K=a.J,H=a.W;l.length+3>l.maxLength&&l.expand();l.data[l.length++]=u;l.data[l.length++]=K;l.data[l.length++]=H;l.h=!0;var C=a.Y,r=a.K,p=a.L;C.length+2>C.maxLength&&C.expand();C.data[C.length++]=r;C.data[C.length++]=p;C.h=!0;var B=a.G++,ka=a.X;ka.length+3>ka.maxLength&&ka.expand();ka.data[ka.length++]=
-1;ka.data[ka.length++]=-1;ka.data[ka.length++]=1;ka.h=!0;var P=a.U,W=a.ba,bb=a.aa,y=a.$,Cb=a.Z;P.length+4>P.maxLength&&P.expand();P.data[P.length++]=W;P.data[P.length++]=bb;P.data[P.length++]=y;P.data[P.length++]=Cb;P.h=!0;var la=a.V,ia=a.I,wb=a.J,Ja=a.W;la.length+3>la.maxLength&&la.expand();la.data[la.length++]=ia;la.data[la.length++]=wb;la.data[la.length++]=Ja;la.h=!0;var Ka=a.Y,jb=a.K,Pb=a.L;Ka.length+2>Ka.maxLength&&Ka.expand();Ka.data[Ka.length++]=jb;Ka.data[Ka.length++]=Pb;Ka.h=!0;var xb=a.G++,
qa=a.X;qa.length+3>qa.maxLength&&qa.expand();qa.data[qa.length++]=-1;qa.data[qa.length++]=1;qa.data[qa.length++]=-1;qa.h=!0;var Aa=a.U,Sa=a.ba,Ba=a.aa,Qb=a.$,cb=a.Z;Aa.length+4>Aa.maxLength&&Aa.expand();Aa.data[Aa.length++]=Sa;Aa.data[Aa.length++]=Ba;Aa.data[Aa.length++]=Qb;Aa.data[Aa.length++]=cb;Aa.h=!0;var ba=a.V,db=a.I,ca=a.J,kb=a.W;ba.length+3>ba.maxLength&&ba.expand();ba.data[ba.length++]=db;ba.data[ba.length++]=ca;ba.data[ba.length++]=kb;ba.h=!0;var ra=a.Y,La=a.K,X=a.L;ra.length+2>ra.maxLength&&
ra.expand();ra.data[ra.length++]=La;ra.data[ra.length++]=X;ra.h=!0;var ma=a.G++,R=a.X;R.length+3>R.maxLength&&R.expand();R.data[R.length++]=-1;R.data[R.length++]=1;R.data[R.length++]=1;R.h=!0;var L=a.U,Ca=a.ba,U=a.aa,Q=a.$,Da=a.Z;L.length+4>L.maxLength&&L.expand();L.data[L.length++]=Ca;L.data[L.length++]=U;L.data[L.length++]=Q;L.data[L.length++]=Da;L.h=!0;var Y=a.V,Eb=a.I,Fb=a.J,wa=a.W;Y.length+3>Y.maxLength&&Y.expand();Y.data[Y.length++]=Eb;Y.data[Y.length++]=Fb;Y.data[Y.length++]=wa;Y.h=!0;var Ma=
a.Y,Gb=a.K,Hb=a.L;Ma.length+2>Ma.maxLength&&Ma.expand();Ma.data[Ma.length++]=Gb;Ma.data[Ma.length++]=Hb;Ma.h=!0;var xa=a.G++,lb=a.X;lb.length+3>lb.maxLength&&lb.expand();lb.data[lb.length++]=1;lb.data[lb.length++]=-1;lb.data[lb.length++]=-1;lb.h=!0;var Ta=a.U,yb=a.ba,bc=a.aa,Na=a.$,Ua=a.Z;Ta.length+4>Ta.maxLength&&Ta.expand();Ta.data[Ta.length++]=yb;Ta.data[Ta.length++]=bc;Ta.data[Ta.length++]=Na;Ta.data[Ta.length++]=Ua;Ta.h=!0;var ob=a.V,nc=a.I,cc=a.J,na=a.W;ob.length+3>ob.maxLength&&ob.expand();
ob.data[ob.length++]=nc;ob.data[ob.length++]=cc;ob.data[ob.length++]=na;ob.h=!0;var sa=a.Y,pc=a.K,Ac=a.L;sa.length+2>sa.maxLength&&sa.expand();sa.data[sa.length++]=pc;sa.data[sa.length++]=Ac;sa.h=!0;var dc=a.G++,Ea=a.X;Ea.length+3>Ea.maxLength&&Ea.expand();Ea.data[Ea.length++]=1;Ea.data[Ea.length++]=-1;Ea.data[Ea.length++]=1;Ea.h=!0;var I=a.U,oc=a.ba,Nb=a.aa,qc=a.$,F=a.Z;I.length+4>I.maxLength&&I.expand();I.data[I.length++]=oc;I.data[I.length++]=Nb;I.data[I.length++]=qc;I.data[I.length++]=F;I.h=!0;
var D=a.V,V=a.I,Va=a.J,Oa=a.W;D.length+3>D.maxLength&&D.expand();D.data[D.length++]=V;D.data[D.length++]=Va;D.data[D.length++]=Oa;D.h=!0;var eb=a.Y,Wa=a.K,Pa=a.L;eb.length+2>eb.maxLength&&eb.expand();eb.data[eb.length++]=Wa;eb.data[eb.length++]=Pa;eb.h=!0;var Ib=a.G++,fb=a.X;fb.length+3>fb.maxLength&&fb.expand();fb.data[fb.length++]=1;fb.data[fb.length++]=1;fb.data[fb.length++]=-1;fb.h=!0;var Z=a.U,pb=a.ba,Yb=a.aa,Db=a.$,zb=a.Z;Z.length+4>Z.maxLength&&Z.expand();Z.data[Z.length++]=pb;Z.data[Z.length++]=
Yb;Z.data[Z.length++]=Db;Z.data[Z.length++]=zb;Z.h=!0;var aa=a.V,Fa=a.I,oa=a.J,ta=a.W;aa.length+3>aa.maxLength&&aa.expand();aa.data[aa.length++]=Fa;aa.data[aa.length++]=oa;aa.data[aa.length++]=ta;aa.h=!0;var Xa=a.Y,Jb=a.K,Ya=a.L;Xa.length+2>Xa.maxLength&&Xa.expand();Xa.data[Xa.length++]=Jb;Xa.data[Xa.length++]=Ya;Xa.h=!0;var Ab=a.G++,Za=a.X;Za.length+3>Za.maxLength&&Za.expand();Za.data[Za.length++]=1;Za.data[Za.length++]=1;Za.data[Za.length++]=1;Za.h=!0;var ya=a.U,gb=a.ba,Rb=a.aa,Ob=a.$,Bb=a.Z;ya.length+
4>ya.maxLength&&ya.expand();ya.data[ya.length++]=gb;ya.data[ya.length++]=Rb;ya.data[ya.length++]=Ob;ya.data[ya.length++]=Bb;ya.h=!0;var $a=a.V,Qa=a.I,za=a.J,Sb=a.W;$a.length+3>$a.maxLength&&$a.expand();$a.data[$a.length++]=Qa;$a.data[$a.length++]=za;$a.data[$a.length++]=Sb;$a.h=!0;var qb=a.Y,ec=a.K,fc=a.L;qb.length+2>qb.maxLength&&qb.expand();qb.data[qb.length++]=ec;qb.data[qb.length++]=fc;qb.h=!0;var Ga=a.G++,O=a.S;O.length+3>O.maxLength&&O.expand();O.data[O.length++]=xb;O.data[O.length++]=ma;O.data[O.length++]=
B;O.h=!0;var S=a.S;S.length+3>S.maxLength&&S.expand();S.data[S.length++]=xb;S.data[S.length++]=xa;S.data[S.length++]=ma;S.h=!0;var Ra=a.S;Ra.length+3>Ra.maxLength&&Ra.expand();Ra.data[Ra.length++]=Ib;Ra.data[Ra.length++]=dc;Ra.data[Ra.length++]=Ab;Ra.h=!0;var da=a.S;da.length+3>da.maxLength&&da.expand();da.data[da.length++]=Ib;da.data[da.length++]=Ab;da.data[da.length++]=Ga;da.h=!0;var rb=a.S;rb.length+3>rb.maxLength&&rb.expand();rb.data[rb.length++]=xb;rb.data[rb.length++]=B;rb.data[rb.length++]=
dc;rb.h=!0;var sb=a.S;sb.length+3>sb.maxLength&&sb.expand();sb.data[sb.length++]=xb;sb.data[sb.length++]=dc;sb.data[sb.length++]=Ib;sb.h=!0;var Ha=a.S;Ha.length+3>Ha.maxLength&&Ha.expand();Ha.data[Ha.length++]=xa;Ha.data[Ha.length++]=Ga;Ha.data[Ha.length++]=Ab;Ha.h=!0;var tb=a.S;tb.length+3>tb.maxLength&&tb.expand();tb.data[tb.length++]=xa;tb.data[tb.length++]=Ab;tb.data[tb.length++]=ma;tb.h=!0;var pa=a.S;pa.length+3>pa.maxLength&&pa.expand();pa.data[pa.length++]=B;pa.data[pa.length++]=ma;pa.data[pa.length++]=
Ab;pa.h=!0;var ea=a.S;ea.length+3>ea.maxLength&&ea.expand();ea.data[ea.length++]=B;ea.data[ea.length++]=Ab;ea.data[ea.length++]=dc;ea.h=!0;var ub=a.S;ub.length+3>ub.maxLength&&ub.expand();ub.data[ub.length++]=xb;ub.data[ub.length++]=Ib;ub.data[ub.length++]=Ga;ub.h=!0;var vb=a.S;vb.length+3>vb.maxLength&&vb.expand();vb.data[vb.length++]=xb;vb.data[vb.length++]=Ga;vb.data[vb.length++]=xa;vb.h=!0;a.upload();b.Aa.lb=this.Vg};N.prototype.gh=function(){var b=this.Nd,a=b.Bc;b.mode=4;a.K=0;a.L=0;var c=a.X;
c.length+3>c.maxLength&&c.expand();c.data[c.length++]=-1;c.data[c.length++]=-1;c.data[c.length++]=0;c.h=!0;c=a.U;var e=a.ba,f=a.aa,g=a.$,h=a.Z;c.length+4>c.maxLength&&c.expand();c.data[c.length++]=e;c.data[c.length++]=f;c.data[c.length++]=g;c.data[c.length++]=h;c.h=!0;c=a.V;e=a.I;f=a.J;g=a.W;c.length+3>c.maxLength&&c.expand();c.data[c.length++]=e;c.data[c.length++]=f;c.data[c.length++]=g;c.h=!0;c=a.Y;e=a.K;f=a.L;c.length+2>c.maxLength&&c.expand();c.data[c.length++]=e;c.data[c.length++]=f;c.h=!0;c=
a.G++;a.K=0;a.L=1;e=a.X;e.length+3>e.maxLength&&e.expand();e.data[e.length++]=-1;e.data[e.length++]=1;e.data[e.length++]=0;e.h=!0;e=a.U;f=a.ba;g=a.aa;h=a.$;var m=a.Z;e.length+4>e.maxLength&&e.expand();e.data[e.length++]=f;e.data[e.length++]=g;e.data[e.length++]=h;e.data[e.length++]=m;e.h=!0;e=a.V;f=a.I;g=a.J;h=a.W;e.length+3>e.maxLength&&e.expand();e.data[e.length++]=f;e.data[e.length++]=g;e.data[e.length++]=h;e.h=!0;e=a.Y;f=a.K;g=a.L;e.length+2>e.maxLength&&e.expand();e.data[e.length++]=f;e.data[e.length++]=
g;e.h=!0;e=a.G++;a.K=1;a.L=0;f=a.X;f.length+3>f.maxLength&&f.expand();f.data[f.length++]=1;f.data[f.length++]=-1;f.data[f.length++]=0;f.h=!0;f=a.U;g=a.ba;h=a.aa;m=a.$;var l=a.Z;f.length+4>f.maxLength&&f.expand();f.data[f.length++]=g;f.data[f.length++]=h;f.data[f.length++]=m;f.data[f.length++]=l;f.h=!0;f=a.V;g=a.I;h=a.J;m=a.W;f.length+3>f.maxLength&&f.expand();f.data[f.length++]=g;f.data[f.length++]=h;f.data[f.length++]=m;f.h=!0;f=a.Y;g=a.K;h=a.L;f.length+2>f.maxLength&&f.expand();f.data[f.length++]=
g;f.data[f.length++]=h;f.h=!0;f=a.G++;a.K=1;a.L=1;g=a.X;g.length+3>g.maxLength&&g.expand();g.data[g.length++]=1;g.data[g.length++]=1;g.data[g.length++]=0;g.h=!0;g=a.U;h=a.ba;m=a.aa;l=a.$;var u=a.Z;g.length+4>g.maxLength&&g.expand();g.data[g.length++]=h;g.data[g.length++]=m;g.data[g.length++]=l;g.data[g.length++]=u;g.h=!0;g=a.V;h=a.I;m=a.J;l=a.W;g.length+3>g.maxLength&&g.expand();g.data[g.length++]=h;g.data[g.length++]=m;g.data[g.length++]=l;g.h=!0;g=a.Y;h=a.K;m=a.L;g.length+2>g.maxLength&&g.expand();
g.data[g.length++]=h;g.data[g.length++]=m;g.h=!0;g=a.G++;h=a.S;h.length+3>h.maxLength&&h.expand();h.data[h.length++]=c;h.data[h.length++]=f;h.data[h.length++]=g;h.h=!0;f=a.S;f.length+3>f.maxLength&&f.expand();f.data[f.length++]=c;f.data[f.length++]=g;f.data[f.length++]=e;f.h=!0;a.upload();b.Aa.lb=this.Sg};N.prototype.nh=function(){var b=this.Th,a=b.Bc;b.mode=1;var c=a.X;c.length+3>c.maxLength&&c.expand();c.data[c.length++]=0;c.data[c.length++]=0;c.data[c.length++]=0;c.h=!0;c=a.U;var e=a.ba,f=a.aa,
g=a.$,h=a.Z;c.length+4>c.maxLength&&c.expand();c.data[c.length++]=e;c.data[c.length++]=f;c.data[c.length++]=g;c.data[c.length++]=h;c.h=!0;c=a.V;e=a.I;f=a.J;g=a.W;c.length+3>c.maxLength&&c.expand();c.data[c.length++]=e;c.data[c.length++]=f;c.data[c.length++]=g;c.h=!0;c=a.Y;e=a.K;f=a.L;c.length+2>c.maxLength&&c.expand();c.data[c.length++]=e;c.data[c.length++]=f;c.h=!0;c=a.S;e=a.G;c.length+1>c.maxLength&&c.expand();c.data[c.length++]=e;c.h=!0;a.G++;c=a.X;c.length+3>c.maxLength&&c.expand();c.data[c.length++]=
1;c.data[c.length++]=0;c.data[c.length++]=0;c.h=!0;c=a.U;e=a.ba;f=a.aa;g=a.$;h=a.Z;c.length+4>c.maxLength&&c.expand();c.data[c.length++]=e;c.data[c.length++]=f;c.data[c.length++]=g;c.data[c.length++]=h;c.h=!0;c=a.V;e=a.I;f=a.J;g=a.W;c.length+3>c.maxLength&&c.expand();c.data[c.length++]=e;c.data[c.length++]=f;c.data[c.length++]=g;c.h=!0;c=a.Y;e=a.K;f=a.L;c.length+2>c.maxLength&&c.expand();c.data[c.length++]=e;c.data[c.length++]=f;c.h=!0;c=a.S;e=a.G;c.length+1>c.maxLength&&c.expand();c.data[c.length++]=
e;c.h=!0;a.G++;a.upload();b.Aa.lb=this.Wg};N.prototype.createShader=function(b,a){return this.B.createShader(b.Ta,b.Ka,a)};N.prototype.dd=function(){var b=this.M,a=ib.N.la.mb.name,c=v.We(this.la.Qb());b.C[a]=c;b=this.M;a=ib.N.la.Ga.name;c=v.s(this.Ga.Qb()[0]);b.C[a]=c;b=this.M;a=ib.N.Da.name;c=v.s(this.Da.Qb()[0]);b.C[a]=c;b=this.M;a=ib.N.Ia.name;c=v.s(this.Ia.Qb()[0]);b.C[a]=c};N.prototype.Wb=function(b,a){this.dd();this.B.lb(b);this.B.g.disable(3042);b=!this.Xd;null==b&&(b=!0);null==b&&(b=!0);a.B.kc(a.hb[a.za^
1],function(){var c=a.B;c.Mb();a.B.zb(0,0,0,1);a.B.nf();c.Pb()});b&&(a.za^=1);b=this.B;b.g.enable(3042);b.g.blendFuncSeparate(770,771,1,1);this.B.Kh()};N.prototype.mc=function(b){this.dd();this.B.mc(b,this.M,this.Ch,[this.yc.buffer],this.Oa);this.Xd||this.Zg()};N.prototype.Qh=function(){var b=this.hc,a=this.Vb;b.x=a.x;b.y=a.y;b.z=a.z;var c=0;var e=0;this.rc=!1;var f=0;this.input.Rc.uc&&(b=this.input.Rc,c=b.x,e=b.y,this.rc=b.left,f=b.ff);0<this.input.touches.touches.length&&(b=this.input.touches.touches[0],
b.Wc&&(this.rc=!0,c=b.x,e=b.y,f=b.jf));c/=this.ub.width;e/=this.ub.height;e=1-e;c=2*c-1;e=2*e-1;var g=this;this.Tc(function(){var h=g.ic,m=g.B,l=m.wc,u=m.Za,K=l.fa,H=l.ga,C=l.ha,r=l.na,p=l.ia,B=l.ja,ka=l.ka,P=l.oa,W=l.ca,bb=l.da,y=l.ea,Cb=l.pa,la=l.qa,ia=l.ra,wb=l.sa,Ja=l.ta,Ka=u.fa,jb=u.ga,Pb=u.ha,xb=u.na,qa=u.ia,Aa=u.ja,Sa=u.ka,Ba=u.oa,Qb=u.ca,cb=u.da,ba=u.ea,db=u.pa,ca=u.qa,kb=u.ra,ra=u.sa,La=u.ta,X=K*Ka+H*qa+C*Qb+r*ca,ma=K*jb+H*Aa+C*cb+r*kb,R=K*Pb+H*Sa+C*ba+r*ra,L=K*xb+H*Ba+C*db+r*La,Ca=p*Ka+
B*qa+ka*Qb+P*ca,U=p*jb+B*Aa+ka*cb+P*kb,Q=p*Pb+B*Sa+ka*ba+P*ra,Da=p*xb+B*Ba+ka*db+P*La,Y=W*Ka+bb*qa+y*Qb+Cb*ca,Eb=W*jb+bb*Aa+y*cb+Cb*kb,Fb=W*Pb+bb*Sa+y*ba+Cb*ra,wa=W*xb+bb*Ba+y*db+Cb*La,Ma=la*Ka+ia*qa+wb*Qb+Ja*ca,Gb=la*jb+ia*Aa+wb*cb+Ja*kb,Hb=la*Pb+ia*Sa+wb*ba+Ja*ra,xa=la*xb+ia*Ba+wb*db+Ja*La,lb=X*U-ma*Ca,Ta=X*Q-R*Ca,yb=X*Da-L*Ca,bc=ma*Q-R*U,Na=ma*Da-L*U,Ua=R*Da-L*Q,ob=Y*Gb-Eb*Ma,nc=Y*Hb-Fb*Ma,cc=Y*xa-wa*Ma,na=Eb*Hb-Fb*Gb,sa=Eb*xa-wa*Gb,pc=Fb*xa-wa*Hb,Ac=U*pc-Q*sa+Da*na,dc=Ca*pc-Q*cc+Da*nc,Ea=Ca*sa-
U*cc+Da*ob,I=X*Ac-ma*dc+R*Ea-L*(Ca*na-U*nc+Q*ob);0!=I&&(I=1/I);h.x=Ac*I*0+-(ma*pc-R*sa+L*na)*I*0+(Gb*Ua-Hb*Na+xa*bc)*I*0+-(Eb*Ua-Fb*Na+wa*bc)*I;h.y=-dc*I*0+(X*pc-R*cc+L*nc)*I*0+-(Ma*Ua-Hb*yb+xa*Ta)*I*0+(Y*Ua-Fb*yb+wa*Ta)*I;h.z=Ea*I*0+-(X*sa-ma*cc+L*ob)*I*0+(Ma*Na-Gb*yb+xa*lb)*I*0+-(Y*Na-Eb*yb+wa*lb)*I;var oc=g.B,Nb=c,qc=e,F=oc.kb,D=oc.Za,V=F.fa,Va=F.ga,Oa=F.ha,eb=F.na,Wa=F.ia,Pa=F.ja,Ib=F.ka,fb=F.oa,Z=F.ca,pb=F.da,Yb=F.ea,Db=F.pa,zb=F.qa,aa=F.ra,Fa=F.sa,oa=F.ta,ta=D.fa,Xa=D.ga,Jb=D.ha,Ya=D.na,Ab=
D.ia,Za=D.ja,ya=D.ka,gb=D.oa,Rb=D.ca,Ob=D.da,Bb=D.ea,$a=D.pa,Qa=D.qa,za=D.ra,Sb=D.sa,qb=D.ta,ec=V*ta+Va*Ab+Oa*Rb+eb*Qa,fc=V*Xa+Va*Za+Oa*Ob+eb*za,Ga=V*Jb+Va*ya+Oa*Bb+eb*Sb,O=V*Ya+Va*gb+Oa*$a+eb*qb,S=Wa*ta+Pa*Ab+Ib*Rb+fb*Qa,Ra=Wa*Xa+Pa*Za+Ib*Ob+fb*za,da=Wa*Jb+Pa*ya+Ib*Bb+fb*Sb,rb=Wa*Ya+Pa*gb+Ib*$a+fb*qb,sb=Z*ta+pb*Ab+Yb*Rb+Db*Qa,Ha=Z*Xa+pb*Za+Yb*Ob+Db*za,tb=Z*Jb+pb*ya+Yb*Bb+Db*Sb,pa=Z*Ya+pb*gb+Yb*$a+Db*qb,ea=zb*ta+aa*Ab+Fa*Rb+oa*Qa,ub=zb*Xa+aa*Za+Fa*Ob+oa*za,vb=zb*Jb+aa*ya+Fa*Bb+oa*Sb,vc=zb*Ya+aa*gb+
Fa*$a+oa*qb,mb=oc.wc,nb=mb.fa,gc=mb.ga,hc=mb.ha,ic=mb.na,Lb=mb.ia,Bc=mb.ja,Zb=mb.ka,ua=mb.oa,ab=mb.ca,Tb=mb.da,Ub=mb.ea,Cc=mb.pa,Tc=mb.qa,Uc=mb.ra,Vc=mb.sa,Wc=mb.ta,Kc=ec*nb+fc*Lb+Ga*ab+O*Tc,Lc=ec*gc+fc*Bc+Ga*Tb+O*Uc,Mc=ec*hc+fc*Zb+Ga*Ub+O*Vc,Nc=ec*ic+fc*ua+Ga*Cc+O*Wc,Xc=S*nb+Ra*Lb+da*ab+rb*Tc,Yc=S*gc+Ra*Bc+da*Tb+rb*Uc,Zc=S*hc+Ra*Zb+da*Ub+rb*Vc,$c=S*ic+Ra*ua+da*Cc+rb*Wc,ad=sb*nb+Ha*Lb+tb*ab+pa*Tc,bd=sb*gc+Ha*Bc+tb*Tb+pa*Uc,cd=sb*hc+Ha*Zb+tb*Ub+pa*Vc,dd=sb*ic+Ha*ua+tb*Cc+pa*Wc,qd=ea*nb+ub*Lb+vb*ab+
vc*Tc,rd=ea*gc+ub*Bc+vb*Tb+vc*Uc,sd=ea*hc+ub*Zb+vb*Ub+vc*Vc,td=ea*ic+ub*ua+vb*Cc+vc*Wc,Kb=Kc*Yc-Lc*Xc,Bd=Kc*Zc-Mc*Xc,Qd=Kc*$c-Nc*Xc,Rd=Lc*Zc-Mc*Yc,Vb=Lc*$c-Nc*Yc,Dc=Mc*$c-Nc*Zc,rc=ad*rd-bd*qd,ce=ad*sd-cd*qd,de=ad*td-dd*qd,ee=bd*sd-cd*rd,fe=bd*td-dd*rd,Ec=cd*td-dd*sd,$e=Yc*Ec-Zc*fe+$c*ee,af=Xc*Ec-Zc*de+$c*ce,bf=Xc*fe-Yc*de+$c*rc,ed=Xc*ee-Yc*ce+Zc*rc,Wb=Kc*$e-Lc*af+Mc*bf-Nc*ed;0!=Wb&&(Wb=1/Wb);var Qe=-ed*Wb*Nb+(Kc*ee-Lc*ce+Mc*rc)*Wb*qc+-(qd*Rd-rd*Bd+sd*Kb)*Wb*0+(ad*Rd-bd*Bd+cd*Kb)*Wb,id=g.Vb,Re=g.ic,
ge=($e*Wb*Nb+-(Lc*Ec-Mc*fe+Nc*ee)*Wb*qc+(rd*Dc-sd*Vb+td*Rd)*Wb*0+-(bd*Dc-cd*Vb+dd*Rd)*Wb)/Qe-Re.x,$b=(-af*Wb*Nb+(Kc*Ec-Mc*de+Nc*ce)*Wb*qc+-(qd*Dc-sd*Qd+td*Bd)*Wb*0+(ad*Dc-cd*Qd+dd*Bd)*Wb)/Qe-Re.y,ac=(bf*Wb*Nb+-(Kc*fe-Lc*de+Nc*rc)*Wb*qc+(qd*Vb-rd*Qd+td*Kb)*Wb*0+-(ad*Vb-bd*Qd+dd*Kb)*Wb)/Qe-Re.z,ud=Math.sqrt(ge*ge+$b*$b+ac*ac);0<ud&&(ud=1/ud);var Cd=ud;id.x=ge*Cd;id.y=$b*Cd;id.z=ac*Cd;if(1==f){var Dd=g.hc,Ed=g.Vb;Dd.x=Ed.x;Dd.y=Ed.y;Dd.z=Ed.z}})};N.prototype.jc=function(b,a){this.dd();b.Fe();this.B.Ug(b,
a)};N.prototype.update=function(){var b=this.Ob;if(0==this.ne%1){for(var a=.5*(b.$a-b.Fb)+2,c=.5*b.pb,e=.5*b.ob,f=[],g=0;2>g;)for(var h=g++,m=-4;5>m;)for(var l=m++,u=-4;5>u;){var K=u++;if(!(16<l*l+K*K)){var H=b.Ea;f.push({x:a+h*H,y:c+l*H,z:e+K*H,Xh:2*b.Ea,Yh:0,Zh:0})}}this.Eg(f)}this.M.C[Qc.N.bh.name]=v.Hb(0,-.02,0);if(this.Xd)this.Ig();else{this.mc(this.Pg);b=this.B;b.g.enable(3042);b.g.blendFuncSeparate(770,1,1,1);this.B.g.blendFunc(1,1);var C=this,r=this.la;r.B.kc(r.hb[r.za^1],function(){var B=
r.B;B.Mb();C.B.zb(0,0,0,0);C.jc(C.He,C.Oa);B.Pb()});r.za^=1;b=this.B;b.g.enable(3042);b.g.blendFuncSeparate(770,771,1,1);this.Wb(this.$e,this.la);this.mc(this.zf);b=this.B;b.g.enable(3042);b.g.blendFuncSeparate(770,1,1,1);this.B.g.blendFunc(1,1);var p=this.la;p.B.kc(p.hb[p.za^1],function(){var B=p.B;B.Mb();C.B.zb(0,0,0,0);C.jc(C.Ie,C.Oa);B.Pb()});p.za^=1;b=this.B;b.g.enable(3042);b.g.blendFuncSeparate(770,771,1,1);this.Qh();this.M.C[Qc.N.ic.name]=v.Hb(this.ic.x,this.ic.y,this.ic.z);this.M.C[Qc.N.Vb.name]=
v.Hb(this.Vb.x,this.Vb.y,this.Vb.z);this.M.C[Qc.N.hc.name]=v.Hb(this.hc.x,this.hc.y,this.hc.z);this.M.C[Qc.N.rc.name]=v.Dc(this.rc);this.Wb(this.af,this.la);this.mc(this.tf)}};N.prototype.Ig=function(){if(!(10<this.ne)){for(var b=this,a=mc.now()/1E3,c=0,e={};50>c;){++c;var f=b.B;f.g.enable(3042);f.g.blendFuncSeparate(770,1,1,1);b.B.g.blendFunc(1,1);f=b.la;e.Wd=function(){b.B.zb(0,0,0,0);b.jc(b.He,b.Oa)};e.Ud=f;f.B.kc(f.hb[f.za^1],function(g){return function(){var h=g.Ud.B;h.Mb();g.Wd();h.Pb()}}(e));
f.za^=1;f=b.B;f.g.enable(3042);f.g.blendFuncSeparate(770,771,1,1);b.la.Qb()[0].sync();e={Ud:e.Ud,Wd:e.Wd}}console.log("src/fluid/Main.hx:893:","scatter mass: average "+1E3*(mc.now()/1E3-a)/50+" ms");a=mc.now()/1E3;for(c=0;50>c;)++c,b.Wb(b.$e,b.la),b.la.Qb()[0].sync();console.log("src/fluid/Main.hx:893:","compute mass: average "+1E3*(mc.now()/1E3-a)/50+" ms");a=mc.now()/1E3;for(c=0;50>c;)++c,b.mc(b.zf),b.H.buffer.sync();console.log("src/fluid/Main.hx:893:","pre-scatter momentum: average "+1E3*(mc.now()/
1E3-a)/50+" ms");a=mc.now()/1E3;c=0;for(e={};50>c;)++c,f=b.B,f.g.enable(3042),f.g.blendFuncSeparate(770,1,1,1),b.B.g.blendFunc(1,1),f=b.la,e.Vd=function(){b.B.zb(0,0,0,0);b.jc(b.Ie,b.Oa)},e.Td=f,f.B.kc(f.hb[f.za^1],function(g){return function(){var h=g.Td.B;h.Mb();g.Vd();h.Pb()}}(e)),f.za^=1,f=b.B,f.g.enable(3042),f.g.blendFuncSeparate(770,771,1,1),b.la.Qb()[0].sync(),e={Td:e.Td,Vd:e.Vd};console.log("src/fluid/Main.hx:893:","scatter momentum: average "+1E3*(mc.now()/1E3-a)/50+" ms");a=mc.now()/1E3;
for(c=0;50>c;)++c,b.Wb(b.af,b.la),b.la.Qb()[0].sync();console.log("src/fluid/Main.hx:893:","compute velocity: average "+1E3*(mc.now()/1E3-a)/50+" ms");a=mc.now()/1E3;for(c=0;50>c;)++c,b.mc(b.tf),b.H.buffer.sync();console.log("src/fluid/Main.hx:893:","move particles: average "+1E3*(mc.now()/1E3-a)/50+" ms")}};N.prototype.fb=function(){this.B.screen(this.ub.width,this.ub.height);this.M.C[tc.N.mode.name]=v.wa(tc.Fa.DEPTH);this.M.C[yd.N.Bd.name]=v.m(this.Bd);this.M.C[yd.N.sd.name]=v.m(this.sd);var b=
this;if(this.hf)this.Tc(function(){b.B.zb(.5,.55,.6,1);b.M.C[tc.N.mode.name]=v.wa(tc.Fa.kg);b.jc(b.Nd,b.Oa)});else{this.M.C[yd.N.Ff.name]=v.Gb(this.canvas.width,this.canvas.height);this.M.C[tc.N.mode.name]=v.wa(tc.Fa.DEPTH);this.B.g.disable(3042);var a=this.Da,c=function(){b.B.zb(-1E6,-1E6,-1E6,1);b.Tc(function(){b.jc(b.Nd,b.Oa)},!1)};a.B.kc(a.hb[a.za^1],function(){var h=a.B;h.Mb();c();h.Pb()});a.za^=1;this.M.C[tc.N.mode.name]=v.wa(tc.Fa.COLOR);var e=this.B;e.g.enable(3042);e.g.blendFuncSeparate(770,
1,1,1);this.B.g.blendFunc(1,1);var f=this.Ia,g=function(){b.B.zb(0,0,0,1);b.Tc(function(){b.B.g.disable(2929);b.jc(b.Nd,b.Oa)},!1)};f.B.kc(f.hb[f.za^1],function(){var h=f.B;h.Mb();g();h.Pb()});f.za^=1;e=this.B;e.g.enable(3042);e.g.blendFuncSeparate(770,771,1,1);this.M.C[Jc.N.Ae.name]=v.wa(Jc.Fa.ag);this.Wb(this.ee,this.Da);this.M.C[Jc.N.Ae.name]=v.wa(Jc.Fa.Bg);this.Wb(this.ee,this.Da);this.M.C[Jc.N.Ae.name]=v.wa(Jc.Fa.Zf);this.Wb(this.ee,this.Da);this.Tc(function(){b.B.zb(.5,.55,.6,1);b.dd();b.B.lb(b.Ih);
b.B.nf()})}};N.prototype.Tc=function(b,a){null==a&&(a=!0);var c=this.Ob;this.B.g.enable(2929);var e=.5*c.$a,f=.5*c.pb,g=.5*c.ob;c=Math.max(Math.max(c.Fb,c.Fb),c.Fb);var h=this.B;h.gd=!0;var m=h.he;m.x=e+0*c+0*c;m.y=f+0*c+.4*c;m.z=g+1.1*c+0*c;m=h.fe;m.x=e-0*c;m.y=f-.2*c;m.z=g-0*c;e=h.ie;e.x=0;e.y=1;e.z=0;e=h.Za;f=h.he;m=h.fe;g=f.x-m.x;c=f.y-m.y;m=f.z-m.z;var l=Math.sqrt(g*g+c*c+m*m);0<l&&(l=1/l);g*=l;c*=l;m*=l;var u=h.ie;h=u.y*m-u.z*c;l=u.z*g-u.x*m;u=u.x*c-u.y*g;var K=Math.sqrt(h*h+l*l+u*u);0<K&&(K=
1/K);h*=K;l*=K;u*=K;K=c*u-m*l;var H=m*h-g*u,C=g*l-c*h;e.fa=h;e.ga=l;e.ha=u;e.na=-(h*f.x+l*f.y+u*f.z);e.ia=K;e.ja=H;e.ka=C;e.oa=-(K*f.x+H*f.y+C*f.z);e.ca=g;e.da=c;e.ea=m;e.pa=-(g*f.x+c*f.y+m*f.z);e.qa=0;e.ra=0;e.sa=0;e.ta=1;a?(a=this.B,a.Mb(),b(),a.Pb()):b();this.B.g.disable(2929)};N.log2=function(b){for(var a=0;1<b;)b>>=1,++a;return a};N.rh=function(){new N(window.document.getElementById("canvas"))};N.D=!0;Sg(Ze,Ie);Ze.D=!0;Sg(ib,Pd);ib.D=!0;Sg(Rc,ib);Rc.D=!0;Sg(hd,Pd);hd.D=!0;Sg(Oe,hd);Oe.D=!0;Sg(Od,
ib);Od.D=!0;Sg(Ne,ib);Ne.D=!0;Sg(Me,hd);Me.D=!0;Sg(Nd,ib);Nd.D=!0;Sg(Qc,ib);Qc.D=!0;Sg(Le,hd);Le.D=!0;Sg(Md,ib);Md.D=!0;Sg(tc,ib);tc.D=!0;Sg(Jc,ib);Jc.D=!0;Sg(yd,ib);yd.D=!0;Sg(Ke,ib);Ke.D=!0;Sg(hb,Error);hb.kd=function(b){return b instanceof hb?b:b instanceof Error?new hb(b.message,null,b):new Ye(b,null,b)};hb.Sa=function(b){return b instanceof hb?b.Dg:b instanceof Error?b:new Ye(b)};hb.D=!0;Sg(Ye,hb);Ye.D=!0;ae.D=!0;Xe.get=function(b,a){return b.data[a]};Ld.Ic=function(b,a){if(null==b)return"null";
if(5<=a.length)return"<...>";var c=typeof b;"function"==c&&(b.D||b.yb)&&(c="object");switch(c){case "function":return"<function>";case "object":if(b.v){var e=Sc[b.v].Ca[b.o];c=e.A;if(e.F){a+="\t";var f=[],g=0;for(e=e.F;g<e.length;){var h=e[g];g+=1;f.push(Ld.Ic(b[h],a))}return c+"("+f.join(",")+")"}return c}if(b instanceof Array){c="[";a+="\t";f=0;for(g=b.length;f<g;)e=f++,c+=(0<e?",":"")+Ld.Ic(b[e],a);return c+"]"}try{f=b.toString}catch(m){return"???"}if(null!=f&&f!=Object.toString&&"function"==typeof f&&
(c=b.toString(),"[object Object]"!=c))return c;c="{\n";a+="\t";f=null!=b.hasOwnProperty;g=null;for(g in b)f&&!b.hasOwnProperty(g)||"prototype"==g||"__class__"==g||"__super__"==g||"__interfaces__"==g||"__properties__"==g||(2!=c.length&&(c+=", \n"),c+=a+g+" : "+Ld.Ic(b[g],a));a=a.substring(1);return c+("\n"+a+"}");case "string":return b;default:return String(b)}};Ld.D=!0;Ve.D=!0;Hc.D=!0;Vg.D=!0;var Je=Sc["pot.core.FrameRate"]={yb:!0,Ca:null,Rf:{A:"Auto",o:0,v:"pot.core.FrameRate",toString:A},Yd:(k=
function(b){return{o:1,$g:b,v:"pot.core.FrameRate",toString:A}},k.A="Fixed",k.F=["fps"],k)};Je.Ca=[Je.Rf,Je.Yd];gd.prototype.start=function(){this.Ef||(this.Sc=window.performance.now()-this.Zb,this.Mc=this.Zb,this.Ef=!0,window.setTimeout(We(this,this.loop),0))};gd.prototype.Gf=function(b){this.Zb=1E3/b};gd.prototype.loop=function(){if(this.Ef){this.count++;if(this.ke){if(gd.jd)try{this.update(1)}catch(h){var b=hb.kd(h);window.alert(pd.lc(b))}else this.update(1);b=this.fb;if(gd.jd)try{b()}catch(h){b=
hb.kd(h),window.alert(pd.lc(b))}else b()}else{var a=window.performance.now();b=this.ph+4*this.Zb;var c=a+4;b=b>c?b:c;!this.lf||10>this.count?c=1:(c=Math.round((b-a)/this.Mc),c=1>c?1:c);var e=.01*this.Zb,f=this.Zb-this.Mc;e=Math.round((a-this.Sc)/(e>f?e:f));c=e<c?e:c;if(0<c){e=!1;for(f=0;f<c;){var g=f++;if(gd.jd)try{this.update(e?1:(g+1)/c)}catch(h){g=hb.kd(h),window.alert(pd.lc(g))}else this.update(e?1:(g+1)/c);g=window.performance.now();this.Mc+=.5*(g-a-this.Mc);a=g;this.Sc+=this.Zb;if(e)break;g>
b&&(e=!0)}b=this.Sc;c=4*this.Zb;c=a-(4<c?c:4);this.Sc=b>c?b:c;this.ph=a;b=this.fb;if(gd.jd)try{b()}catch(h){b=hb.kd(h),window.alert(pd.lc(b))}else b()}}window.requestAnimationFrame(We(this,this.loop))}};gd.D=!0;od.prototype.frameRate=function(b){switch(b.o){case 0:this.tc.Gf(60);this.tc.ke=!0;break;case 1:this.tc.Gf(b.$g),this.tc.ke=!1}};od.prototype.ah=function(){this.tc.lf=!1};od.prototype.Gg=function(){var b=this;this.xf=new ResizeObserver(function(){b.resize()&&b.dc.Ge()});this.xf.observe(this.canvas);
this.xf.observe(window.document.documentElement);this.dc.Ge()};od.prototype.resize=function(){var b=this.canvas.clientWidth,a=this.canvas.clientHeight,c=window.devicePixelRatio;return this.width!=b||this.height!=a||this.Pa!=c?(this.width=b,this.height=a,this.Pa=c,this.canvas.width=this.width*this.Pa+.5|0,this.canvas.height=this.height*this.Pa+.5|0,!0):!1};od.prototype.start=function(){this.tc.start()};od.prototype.update=function(b){this.dc.ne++;null!=this.dc.input&&this.dc.input.update(b);this.dc.update()};
od.prototype.fb=function(){this.dc.fb()};od.D=!0;var ha=Sc["pot.graphics.gl.Attribute"]={yb:!0,Ca:null,pc:(k=function(b){return{o:0,location:b,v:"pot.graphics.gl.Attribute",toString:A}},k.A="Position",k.F=["location"],k),Te:(k=function(b){return{o:1,location:b,v:"pot.graphics.gl.Attribute",toString:A}},k.A="Color",k.F=["location"],k),Ve:(k=function(b){return{o:2,location:b,v:"pot.graphics.gl.Attribute",toString:A}},k.A="Normal",k.F=["location"],k),$d:(k=function(b){return{o:3,location:b,v:"pot.graphics.gl.Attribute",
toString:A}},k.A="TexCoord",k.F=["location"],k),va:(k=function(b,a,c){return{o:4,buffer:b,location:a,Lc:c,v:"pot.graphics.gl.Attribute",toString:A}},k.A="Custom",k.F=["buffer","location","divisor"],k)};ha.Ca=[ha.pc,ha.Te,ha.Ve,ha.$d,ha.va];be.prototype.expand=function(){var b=this.data;this.data=new Float32Array(this.maxLength<<=1);this.data.set(b)};be.D=!0;M.prototype.ma=function(b){this.ef=!1;this.g=b};M.prototype.xa=function(){this.ef||(this.ef=!0,this.sb())};M.D=!0;Sg(Jd,M);Jd.prototype.qf=function(){this.width=
this.Ha[0].width;this.height=this.Ha[0].height;for(var b=this.Ha[0].type,a=0,c=this.Ha;a<c.length;){var e=c[a];++a;if(e.type!=b)throw hb.Sa("all textures must have the same type");if(e.width!=this.width||e.height!=this.height)throw hb.Sa("all texture sizes must be the same");}this.g.bindRenderbuffer(36161,this.depth);this.g.renderbufferStorage(36161,36012,this.width,this.height);this.g.bindRenderbuffer(36161,null);this.g.bindFramebuffer(36160,this.td);this.g.framebufferRenderbuffer(36160,36096,36161,
this.depth);b=this.Ha;for(a=0;a<b.length;)c=b[a++],this.g.framebufferTexture2D(36160,36064+(a-1),3553,c.Ya,0);this.g.bindFramebuffer(36160,null)};Jd.prototype.sb=function(){this.g.deleteRenderbuffer(this.depth);this.g.deleteFramebuffer(this.td)};Jd.D=!0;Ia.prototype.jh=function(){this.g.getExtension("OES_texture_float_linear");this.g.getExtension("OES_texture_half_float_linear");this.g.getExtension("EXT_color_buffer_float");this.g.enable(3089);this.g.disable(2929);this.g.enable(3042);this.g.frontFace(2305);
this.g.cullFace(1029);this.g.disable(2884);this.g.blendFuncSeparate(770,771,1,1);this.g.pixelStorei(37440,!0)};Ia.prototype.fh=function(){this.g.enable(2929);this.g.frontFace(2305);this.g.cullFace(1029);this.g.enable(2884);this.gd=!1;this.Df();this.nd=null};Ia.prototype.mc=function(b,a,c,e,f){if(0!=this.Xb)throw Error("cannot perform transform feedbacks inside a scene");b.bind([a]);this.$b.bind();this.$b.Jg(e);this.$b.Fg();for(b=0;b<c.length;)switch(a=c[b],++b,a.g.enableVertexAttribArray(a.location),
a.g.vertexAttribDivisor(a.location,a.Lc),e=a.buffer.buffer,e.o){case 0:e.buffer.vertexAttribPointer(a.location,a.buffer.size,a.buffer.vb,a.buffer.offset);break;case 1:e.buffer.vertexAttribPointer(a.location,a.buffer.size,a.buffer.vb,a.buffer.offset)}this.g.drawArrays(0,0,f);for(f=0;f<c.length;)b=c[f],++f,b.g.disableVertexAttribArray(b.location);this.$b.end();this.$b.Ph()};Ia.prototype.qc=function(b){return new xd(this.g,null==b?[ha.pc(),ha.Te(),ha.Ve(),ha.$d()]:b)};Ia.prototype.re=function(){this.cf=
new Gc(this.g);this.cf.compile(sc.Yc,sc.Nc);this.df=new Gc(this.g);this.df.compile(z.Yc,z.Nc);this.md=null};Ia.prototype.Mg=function(){return null!=this.md?this.md:null!=this.nd?this.df:this.cf};Ia.prototype.screen=function(b,a){this.Uc=b;this.zc=a;b=this.kb;a=this.fd;var c=this.ed,e=1/Math.tan(.5*this.ld());b.fa=e/(this.Uc/this.zc);b.ga=0;b.ha=0;b.na=0;b.ia=0;b.ja=e;b.ka=0;b.oa=0;b.ca=0;b.da=0;b.ea=-(c+a)/(c-a);b.pa=-2*a*c/(c-a);b.qa=0;b.ra=0;b.sa=-1;b.ta=0};Ia.prototype.Df=function(){if(0!=this.Xb)throw Error("cannot change viewport inside a scene");
this.Of=!1};Ia.prototype.Rh=function(){if(null==this.Nb){var b=this.canvas.width;var a=this.canvas.height}else b=this.Nb.width,a=this.Nb.height;this.Of?(this.g.viewport(this.Vh,a-this.Ne-this.Wh,this.Uh,this.Ne),this.g.scissor(this.Vh,a-this.Ne-this.Wh,this.Uh,this.Ne)):(this.g.viewport(0,0,b,a),this.g.scissor(0,0,b,a))};Ia.prototype.Jh=function(){this.th=this.sh=1;this.wh=0;this.vh=10;this.uh=0};Ia.prototype.Mb=function(){if(0!=this.Xb)throw Error("scene already begun");this.Xb=!0;var b=this.wc;
b.fa=1;b.ga=0;b.ha=0;b.na=0;b.ia=0;b.ja=1;b.ka=0;b.oa=0;b.ca=0;b.da=0;b.ea=1;b.pa=0;b.qa=0;b.ra=0;b.sa=0;b.ta=1;this.Rb=0;this.nd=null;b=this.Ua;b.ba=1;b.aa=1;b.$=1;b.Z=1;b=this.Ua;b.I=0;b.J=0;b.W=0;b=this.Ua;b.K=0;b.L=0;this.Jh();this.Rh();if(!this.gd){b=this.je;var a=.5*this.zc,c=-this.zc/(2*Math.tan(.5*this.ld()));b.x=.5*this.Uc;b.y=a;b.z=c;b=this.Za;var e=a=this.je;c=a.x-e.x;e=a.y-e.y;var f=a.z-0,g=Math.sqrt(c*c+e*e+f*f);0<g&&(g=1/g);c*=g;e*=g;f*=g;g=-1*f- -0*e;var h=-0*c- -0*f,m=-0*e- -1*c,l=
Math.sqrt(g*g+h*h+m*m);0<l&&(l=1/l);g*=l;h*=l;m*=l;l=e*m-f*h;var u=f*g-c*m,K=c*h-e*g;b.fa=g;b.ga=h;b.ha=m;b.na=-(g*a.x+h*a.y+m*a.z);b.ia=l;b.ja=u;b.ka=K;b.oa=-(l*a.x+u*a.y+K*a.z);b.ca=c;b.da=e;b.ea=f;b.pa=-(c*a.x+e*a.y+f*a.z);b.qa=0;b.ra=0;b.sa=0;b.ta=1}};Ia.prototype.Pb=function(){if(1!=this.Xb)throw Error("scene already ended");this.Xb=!1;this.g.flush()};Ia.prototype.zb=function(b,a,c,e){if(1!=this.Xb)throw Error("begin scene before clear scene");if(null!=this.Nb&&(5124==this.Nb.Ha[0].type||5125==
this.Nb.Ha[0].type))throw hb.Sa("current render target is integer texture(s); use clearInt or clearUInt");this.g.clearColor(b,a,c,e);this.g.clearDepth(1);this.g.clear(16640)};Ia.prototype.createShader=function(b,a,c){var e=new Gc(this.g);e.compile(b,a,c);return e};Ia.prototype.lb=function(b){this.md=b};Ia.prototype.Kh=function(){this.md=null};Ia.prototype.createTexture=function(b,a,c){null==c&&(c=5121);var e=new nd(this.g);e.eh(b,a,c);return e};Ia.prototype.bf=function(){var b=this.Qg(),a=b.nb,c=
b.buffer;if(1==c.o)c=c.buffer;else throw hb.Sa("float buffer expected");return{nb:a,buffer:c,Db:b.Db}};Ia.prototype.Qg=function(){for(var b=[3,3,1,3,3,3,1,1,1,3,3,3,3],a=[],c=0,e=0;e<b.length;){var f=b[e++];a.push(c);c+=f*Float32Array.BYTES_PER_ELEMENT}e=Fd.m(new Fc(this.g,34962));f=[];for(var g=0;g<b.length;)f.push({buffer:e,size:b[g++],vb:c,offset:a[g-1]});return{nb:f,buffer:e,Db:c/Float32Array.BYTES_PER_ELEMENT|0}};Ia.prototype.kc=function(b,a){var c=this.Nb;this.Cf(b);a();this.Cf(c)};Ia.prototype.Cf=
function(b){this.Nb=b;if(null==b)this.g.bindFramebuffer(36160,null),this.g.drawBuffers([1029]);else{this.g.bindFramebuffer(36160,b.td);var a=this.g,c=[],e=0;for(b=b.Ha.length;e<b;)c.push(36064+e++);a.drawBuffers(c)}this.Df()};Ia.prototype.ld=function(){var b=this.Uc/this.zc;switch(this.Ye){case 0:var a=!0;break;case 1:a=!1;break;case 2:a=1>b;break;case 3:a=1<b}return a?2*Math.atan(Math.tan(.5*this.ge)/b):this.ge};Ia.prototype.nf=function(){this.Hg();var b=this.Za,a=b.ca,c=b.da,e=b.ea,f=this.wc,g=
this.Ua;g.I=a*f.fa+c*f.ia+e*f.ca;g.J=a*f.ga+c*f.ja+e*f.da;g.W=a*f.ha+c*f.ka+e*f.ea;var h=this.Ua;h.K=0;h.L=0;var m=this.kb,l=this.Za,u=m.fa,K=m.ga,H=m.ha,C=m.na,r=m.ia,p=m.ja,B=m.ka,ka=m.oa,P=m.ca,W=m.da,bb=m.ea,y=m.pa,Cb=m.qa,la=m.ra,ia=m.sa,wb=m.ta,Ja=l.fa,Ka=l.ga,jb=l.ha,Pb=l.na,xb=l.ia,qa=l.ja,Aa=l.ka,Sa=l.oa,Ba=l.ca,Qb=l.da,cb=l.ea,ba=l.pa,db=l.qa,ca=l.ra,kb=l.sa,ra=l.ta,La=u*Ja+K*xb+H*Ba+C*db,X=u*Ka+K*qa+H*Qb+C*ca,ma=u*jb+K*Aa+H*cb+C*kb,R=u*Pb+K*Sa+H*ba+C*ra,L=r*Ja+p*xb+B*Ba+ka*db,Ca=r*Ka+p*
qa+B*Qb+ka*ca,U=r*jb+p*Aa+B*cb+ka*kb,Q=r*Pb+p*Sa+B*ba+ka*ra,Da=P*Ja+W*xb+bb*Ba+y*db,Y=P*Ka+W*qa+bb*Qb+y*ca,Eb=P*jb+W*Aa+bb*cb+y*kb,Fb=P*Pb+W*Sa+bb*ba+y*ra,wa=Cb*Ja+la*xb+ia*Ba+wb*db,Ma=Cb*Ka+la*qa+ia*Qb+wb*ca,Gb=Cb*jb+la*Aa+ia*cb+wb*kb,Hb=Cb*Pb+la*Sa+ia*ba+wb*ra,xa=La*Ca-X*L,lb=La*U-ma*L,Ta=La*Q-R*L,yb=X*U-ma*Ca,bc=X*Q-R*Ca,Na=ma*Q-R*U,Ua=Da*Ma-Y*wa,ob=Da*Gb-Eb*wa,nc=Da*Hb-Fb*wa,cc=Y*Gb-Eb*Ma,na=Y*Hb-Fb*Ma,sa=Eb*Hb-Fb*Gb,pc=Ca*sa-U*na+Q*cc,Ac=L*sa-U*nc+Q*ob,dc=L*na-Ca*nc+Q*Ua,Ea=L*cc-Ca*ob+U*Ua,I=
La*pc-X*Ac+ma*dc-R*Ea;0!=I&&(I=1/I);var oc=-Ea*I*-1+(La*cc-X*ob+ma*Ua)*I*-1+-(wa*yb-Ma*lb+Gb*xa)*I*0+(Da*yb-Y*lb+Eb*xa)*I,Nb=(dc*I*-1+-(La*na-X*nc+R*Ua)*I*-1+(wa*bc-Ma*Ta+Hb*xa)*I*0+-(Da*bc-Y*Ta+Fb*xa)*I)/oc,qc=Nb;null==Nb&&(qc=0);if(1!=this.Yb)throw Error("begin shape before vertex");var F=this.Ua,D=F.X;D.length+3>D.maxLength&&D.expand();D.data[D.length++]=(pc*I*-1+-(X*sa-ma*na+R*cc)*I*-1+(Ma*Na-Gb*bc+Hb*yb)*I*0+-(Y*Na-Eb*bc+Fb*yb)*I)/oc;D.data[D.length++]=(-Ac*I*-1+(La*sa-ma*nc+R*ob)*I*-1+-(wa*
Na-Gb*Ta+Hb*lb)*I*0+(Da*Na-Eb*Ta+Fb*lb)*I)/oc;D.data[D.length++]=qc;D.h=!0;var V=F.U,Va=F.ba,Oa=F.aa,eb=F.$,Wa=F.Z;V.length+4>V.maxLength&&V.expand();V.data[V.length++]=Va;V.data[V.length++]=Oa;V.data[V.length++]=eb;V.data[V.length++]=Wa;V.h=!0;var Pa=F.V,Ib=F.I,fb=F.J,Z=F.W;Pa.length+3>Pa.maxLength&&Pa.expand();Pa.data[Pa.length++]=Ib;Pa.data[Pa.length++]=fb;Pa.data[Pa.length++]=Z;Pa.h=!0;var pb=F.Y,Yb=F.K,Db=F.L;pb.length+2>pb.maxLength&&pb.expand();pb.data[pb.length++]=Yb;pb.data[pb.length++]=
Db;pb.h=!0;var zb=F.S,aa=F.G;zb.length+1>zb.maxLength&&zb.expand();zb.data[zb.length++]=aa;zb.h=!0;F.G++;var Fa=this.Ua;Fa.K=1;Fa.L=0;var oa=this.kb,ta=this.Za,Xa=oa.fa,Jb=oa.ga,Ya=oa.ha,Ab=oa.na,Za=oa.ia,ya=oa.ja,gb=oa.ka,Rb=oa.oa,Ob=oa.ca,Bb=oa.da,$a=oa.ea,Qa=oa.pa,za=oa.qa,Sb=oa.ra,qb=oa.sa,ec=oa.ta,fc=ta.fa,Ga=ta.ga,O=ta.ha,S=ta.na,Ra=ta.ia,da=ta.ja,rb=ta.ka,sb=ta.oa,Ha=ta.ca,tb=ta.da,pa=ta.ea,ea=ta.pa,ub=ta.qa,vb=ta.ra,vc=ta.sa,mb=ta.ta,nb=Xa*fc+Jb*Ra+Ya*Ha+Ab*ub,gc=Xa*Ga+Jb*da+Ya*tb+Ab*vb,hc=
Xa*O+Jb*rb+Ya*pa+Ab*vc,ic=Xa*S+Jb*sb+Ya*ea+Ab*mb,Lb=Za*fc+ya*Ra+gb*Ha+Rb*ub,Bc=Za*Ga+ya*da+gb*tb+Rb*vb,Zb=Za*O+ya*rb+gb*pa+Rb*vc,ua=Za*S+ya*sb+gb*ea+Rb*mb,ab=Ob*fc+Bb*Ra+$a*Ha+Qa*ub,Tb=Ob*Ga+Bb*da+$a*tb+Qa*vb,Ub=Ob*O+Bb*rb+$a*pa+Qa*vc,Cc=Ob*S+Bb*sb+$a*ea+Qa*mb,Tc=za*fc+Sb*Ra+qb*Ha+ec*ub,Uc=za*Ga+Sb*da+qb*tb+ec*vb,Vc=za*O+Sb*rb+qb*pa+ec*vc,Wc=za*S+Sb*sb+qb*ea+ec*mb,Kc=nb*Bc-gc*Lb,Lc=nb*Zb-hc*Lb,Mc=nb*ua-ic*Lb,Nc=gc*Zb-hc*Bc,Xc=gc*ua-ic*Bc,Yc=hc*ua-ic*Zb,Zc=ab*Uc-Tb*Tc,$c=ab*Vc-Ub*Tc,ad=ab*Wc-Cc*Tc,
bd=Tb*Vc-Ub*Uc,cd=Tb*Wc-Cc*Uc,dd=Ub*Wc-Cc*Vc,qd=Bc*dd-Zb*cd+ua*bd,rd=Lb*dd-Zb*ad+ua*$c,sd=Lb*cd-Bc*ad+ua*Zc,td=Lb*bd-Bc*$c+Zb*Zc,Kb=nb*qd-gc*rd+hc*sd-ic*td;0!=Kb&&(Kb=1/Kb);var Bd=-td*Kb+(nb*bd-gc*$c+hc*Zc)*Kb*-1+-(Tc*Nc-Uc*Lc+Vc*Kc)*Kb*0+(ab*Nc-Tb*Lc+Ub*Kc)*Kb,Qd=(sd*Kb+-(nb*cd-gc*ad+ic*Zc)*Kb*-1+(Tc*Xc-Uc*Mc+Wc*Kc)*Kb*0+-(ab*Xc-Tb*Mc+Cc*Kc)*Kb)/Bd,Rd=Qd;null==Qd&&(Rd=0);if(1!=this.Yb)throw Error("begin shape before vertex");var Vb=this.Ua,Dc=Vb.X;Dc.length+3>Dc.maxLength&&Dc.expand();Dc.data[Dc.length++]=
(qd*Kb+-(gc*dd-hc*cd+ic*bd)*Kb*-1+(Uc*Yc-Vc*Xc+Wc*Nc)*Kb*0+-(Tb*Yc-Ub*Xc+Cc*Nc)*Kb)/Bd;Dc.data[Dc.length++]=(-rd*Kb+(nb*dd-hc*ad+ic*$c)*Kb*-1+-(Tc*Yc-Vc*Mc+Wc*Lc)*Kb*0+(ab*Yc-Ub*Mc+Cc*Lc)*Kb)/Bd;Dc.data[Dc.length++]=Rd;Dc.h=!0;var rc=Vb.U,ce=Vb.ba,de=Vb.aa,ee=Vb.$,fe=Vb.Z;rc.length+4>rc.maxLength&&rc.expand();rc.data[rc.length++]=ce;rc.data[rc.length++]=de;rc.data[rc.length++]=ee;rc.data[rc.length++]=fe;rc.h=!0;var Ec=Vb.V,$e=Vb.I,af=Vb.J,bf=Vb.W;Ec.length+3>Ec.maxLength&&Ec.expand();Ec.data[Ec.length++]=
$e;Ec.data[Ec.length++]=af;Ec.data[Ec.length++]=bf;Ec.h=!0;var ed=Vb.Y,Wb=Vb.K,Qe=Vb.L;ed.length+2>ed.maxLength&&ed.expand();ed.data[ed.length++]=Wb;ed.data[ed.length++]=Qe;ed.h=!0;var id=Vb.S,Re=Vb.G;id.length+1>id.maxLength&&id.expand();id.data[id.length++]=Re;id.h=!0;Vb.G++;var ge=this.Ua;ge.K=0;ge.L=1;var $b=this.kb,ac=this.Za,ud=$b.fa,Cd=$b.ga,Dd=$b.ha,Ed=$b.na,cf=$b.ia,df=$b.ja,ef=$b.ka,ff=$b.oa,gf=$b.ca,hf=$b.da,jf=$b.ea,kf=$b.pa,lf=$b.qa,mf=$b.ra,nf=$b.sa,of=$b.ta,pf=ac.fa,qf=ac.ga,rf=ac.ha,
sf=ac.na,tf=ac.ia,uf=ac.ja,vf=ac.ka,wf=ac.oa,xf=ac.ca,yf=ac.da,zf=ac.ea,Af=ac.pa,Bf=ac.qa,Cf=ac.ra,Df=ac.sa,Ef=ac.ta,Sd=ud*pf+Cd*tf+Dd*xf+Ed*Bf,Td=ud*qf+Cd*uf+Dd*yf+Ed*Cf,Ud=ud*rf+Cd*vf+Dd*zf+Ed*Df,Vd=ud*sf+Cd*wf+Dd*Af+Ed*Ef,he=cf*pf+df*tf+ef*xf+ff*Bf,ie=cf*qf+df*uf+ef*yf+ff*Cf,je=cf*rf+df*vf+ef*zf+ff*Df,ke=cf*sf+df*wf+ef*Af+ff*Ef,le=gf*pf+hf*tf+jf*xf+kf*Bf,me=gf*qf+hf*uf+jf*yf+kf*Cf,ne=gf*rf+hf*vf+jf*zf+kf*Df,oe=gf*sf+hf*wf+jf*Af+kf*Ef,pe=lf*pf+mf*tf+nf*xf+of*Bf,qe=lf*qf+mf*uf+nf*yf+of*Cf,re=lf*
rf+mf*vf+nf*zf+of*Df,se=lf*sf+mf*wf+nf*Af+of*Ef,Ff=Sd*ie-Td*he,Gf=Sd*je-Ud*he,Hf=Sd*ke-Vd*he,If=Td*je-Ud*ie,Jf=Td*ke-Vd*ie,Kf=Ud*ke-Vd*je,Lf=le*qe-me*pe,Mf=le*re-ne*pe,Nf=le*se-oe*pe,Of=me*re-ne*qe,Pf=me*se-oe*qe,Qf=ne*se-oe*re,Wg=ie*Qf-je*Pf+ke*Of,Xg=he*Qf-je*Nf+ke*Mf,Yg=he*Pf-ie*Nf+ke*Lf,Zg=he*Of-ie*Mf+je*Lf,jc=Sd*Wg-Td*Xg+Ud*Yg-Vd*Zg;0!=jc&&(jc=1/jc);var Lg=-Zg*jc*-1+(Sd*Of-Td*Mf+Ud*Lf)*jc+-(pe*If-qe*Gf+re*Ff)*jc*0+(le*If-me*Gf+ne*Ff)*jc,$g=(Yg*jc*-1+-(Sd*Pf-Td*Nf+Vd*Lf)*jc+(pe*Jf-qe*Hf+se*Ff)*
jc*0+-(le*Jf-me*Hf+oe*Ff)*jc)/Lg,ah=$g;null==$g&&(ah=0);if(1!=this.Yb)throw Error("begin shape before vertex");var wc=this.Ua,jd=wc.X;jd.length+3>jd.maxLength&&jd.expand();jd.data[jd.length++]=(Wg*jc*-1+-(Td*Qf-Ud*Pf+Vd*Of)*jc+(qe*Kf-re*Jf+se*If)*jc*0+-(me*Kf-ne*Jf+oe*If)*jc)/Lg;jd.data[jd.length++]=(-Xg*jc*-1+(Sd*Qf-Ud*Nf+Vd*Mf)*jc+-(pe*Kf-re*Hf+se*Gf)*jc*0+(le*Kf-ne*Hf+oe*Gf)*jc)/Lg;jd.data[jd.length++]=ah;jd.h=!0;var Oc=wc.U,lh=wc.ba,mh=wc.aa,nh=wc.$,oh=wc.Z;Oc.length+4>Oc.maxLength&&Oc.expand();
Oc.data[Oc.length++]=lh;Oc.data[Oc.length++]=mh;Oc.data[Oc.length++]=nh;Oc.data[Oc.length++]=oh;Oc.h=!0;var kd=wc.V,ph=wc.I,qh=wc.J,rh=wc.W;kd.length+3>kd.maxLength&&kd.expand();kd.data[kd.length++]=ph;kd.data[kd.length++]=qh;kd.data[kd.length++]=rh;kd.h=!0;var Gd=wc.Y,sh=wc.K,th=wc.L;Gd.length+2>Gd.maxLength&&Gd.expand();Gd.data[Gd.length++]=sh;Gd.data[Gd.length++]=th;Gd.h=!0;var te=wc.S,uh=wc.G;te.length+1>te.maxLength&&te.expand();te.data[te.length++]=uh;te.h=!0;wc.G++;var bh=this.Ua;bh.K=1;bh.L=
1;var xc=this.kb,yc=this.Za,Rf=xc.fa,Sf=xc.ga,Tf=xc.ha,Uf=xc.na,Vf=xc.ia,Wf=xc.ja,Xf=xc.ka,Yf=xc.oa,Zf=xc.ca,$f=xc.da,ag=xc.ea,bg=xc.pa,cg=xc.qa,dg=xc.ra,eg=xc.sa,fg=xc.ta,gg=yc.fa,hg=yc.ga,ig=yc.ha,jg=yc.na,kg=yc.ia,lg=yc.ja,mg=yc.ka,ng=yc.oa,og=yc.ca,pg=yc.da,qg=yc.ea,rg=yc.pa,sg=yc.qa,tg=yc.ra,ug=yc.sa,vg=yc.ta,Wd=Rf*gg+Sf*kg+Tf*og+Uf*sg,Xd=Rf*hg+Sf*lg+Tf*pg+Uf*tg,Yd=Rf*ig+Sf*mg+Tf*qg+Uf*ug,Zd=Rf*jg+Sf*ng+Tf*rg+Uf*vg,ue=Vf*gg+Wf*kg+Xf*og+Yf*sg,ve=Vf*hg+Wf*lg+Xf*pg+Yf*tg,we=Vf*ig+Wf*mg+Xf*qg+Yf*
ug,xe=Vf*jg+Wf*ng+Xf*rg+Yf*vg,ye=Zf*gg+$f*kg+ag*og+bg*sg,ze=Zf*hg+$f*lg+ag*pg+bg*tg,Ae=Zf*ig+$f*mg+ag*qg+bg*ug,Be=Zf*jg+$f*ng+ag*rg+bg*vg,Ce=cg*gg+dg*kg+eg*og+fg*sg,De=cg*hg+dg*lg+eg*pg+fg*tg,Ee=cg*ig+dg*mg+eg*qg+fg*ug,Fe=cg*jg+dg*ng+eg*rg+fg*vg,wg=Wd*ve-Xd*ue,xg=Wd*we-Yd*ue,yg=Wd*xe-Zd*ue,zg=Xd*we-Yd*ve,Ag=Xd*xe-Zd*ve,Bg=Yd*xe-Zd*we,Cg=ye*De-ze*Ce,Dg=ye*Ee-Ae*Ce,Eg=ye*Fe-Be*Ce,Fg=ze*Ee-Ae*De,Gg=ze*Fe-Be*De,Hg=Ae*Fe-Be*Ee,ch=ve*Hg-we*Gg+xe*Fg,dh=ue*Hg-we*Eg+xe*Dg,eh=ue*Gg-ve*Eg+xe*Cg,fh=ue*Fg-ve*
Dg+we*Cg,kc=Wd*ch-Xd*dh+Yd*eh-Zd*fh;0!=kc&&(kc=1/kc);var Mg=-fh*kc+(Wd*Fg-Xd*Dg+Yd*Cg)*kc+-(Ce*zg-De*xg+Ee*wg)*kc*0+(ye*zg-ze*xg+Ae*wg)*kc,gh=(eh*kc+-(Wd*Gg-Xd*Eg+Zd*Cg)*kc+(Ce*Ag-De*yg+Fe*wg)*kc*0+-(ye*Ag-ze*yg+Be*wg)*kc)/Mg,hh=gh;null==gh&&(hh=0);if(1!=this.Yb)throw Error("begin shape before vertex");var zc=this.Ua,ld=zc.X;ld.length+3>ld.maxLength&&ld.expand();ld.data[ld.length++]=(ch*kc+-(Xd*Hg-Yd*Gg+Zd*Fg)*kc+(De*Bg-Ee*Ag+Fe*zg)*kc*0+-(ze*Bg-Ae*Ag+Be*zg)*kc)/Mg;ld.data[ld.length++]=(-dh*kc+(Wd*
Hg-Yd*Eg+Zd*Dg)*kc+-(Ce*Bg-Ee*yg+Fe*xg)*kc*0+(ye*Bg-Ae*yg+Be*xg)*kc)/Mg;ld.data[ld.length++]=hh;ld.h=!0;var Pc=zc.U,vh=zc.ba,wh=zc.aa,xh=zc.$,yh=zc.Z;Pc.length+4>Pc.maxLength&&Pc.expand();Pc.data[Pc.length++]=vh;Pc.data[Pc.length++]=wh;Pc.data[Pc.length++]=xh;Pc.data[Pc.length++]=yh;Pc.h=!0;var md=zc.V,zh=zc.I,Ah=zc.J,Bh=zc.W;md.length+3>md.maxLength&&md.expand();md.data[md.length++]=zh;md.data[md.length++]=Ah;md.data[md.length++]=Bh;md.h=!0;var Hd=zc.Y,Ch=zc.K,Dh=zc.L;Hd.length+2>Hd.maxLength&&Hd.expand();
Hd.data[Hd.length++]=Ch;Hd.data[Hd.length++]=Dh;Hd.h=!0;var Ge=zc.S,Eh=zc.G;Ge.length+1>Ge.maxLength&&Ge.expand();Ge.data[Ge.length++]=Eh;Ge.h=!0;zc.G++;this.Xg()};Ia.prototype.Nh=function(){this.Sd.length=0;this.Sd.push(new Hc(0,1,0));for(var b=1;15>b;)for(var a=b++/16*Math.PI,c=0;32>c;){var e=c++/32*Math.PI*2;this.Sd.push(new Hc(Math.sin(a)*Math.cos(e),Math.cos(a),-Math.sin(a)*Math.sin(e)))}this.Sd.push(new Hc(0,-1,0));for(b=this.Xc.length=0;32>b;)a=b++,this.Xc.push([0,a+1,(a+1)%32+1]),this.Xc.push([449,
449-(a+1),449-((a+1)%32+1)]);for(b=1;14>b;)for(a=1+32*(b++-1),c=a+32,e=0;32>e;){var f=e++,g=a+f,h=c+(f+1)%32;this.Xc.push([g,c+f,h]);this.Xc.push([g,h,a+(f+1)%32])}};Ia.prototype.Hg=function(){if(1!=this.Xb)throw Error("begin scene before begin shape");if(0!=this.Yb)throw Error("shape already begun");this.Yb=!0;this.Ua.clear();this.Jd.mode=5};Ia.prototype.Xg=function(){if(1!=this.Yb)throw Error("shape already ended");this.Yb=!1;this.Ua.upload();this.Jd.Aa.lb=this.Mg();this.Tg(this.Jd)};Ia.prototype.Af=
function(){var b=this.od,a=this.Za,c=this.wc,e=a.fa,f=a.ga,g=a.ha,h=a.na,m=a.ia,l=a.ja,u=a.ka,K=a.oa,H=a.ca,C=a.da,r=a.ea,p=a.pa,B=a.qa,ka=a.ra,P=a.sa,W=a.ta,bb=c.fa,y=c.ga,Cb=c.ha,la=c.na,ia=c.ia,wb=c.ja,Ja=c.ka,Ka=c.oa,jb=c.ca,Pb=c.da,xb=c.ea,qa=c.pa,Aa=c.qa,Sa=c.ra,Ba=c.sa,Qb=c.ta,cb=e*bb+f*ia+g*jb+h*Aa,ba=e*y+f*wb+g*Pb+h*Sa,db=e*Cb+f*Ja+g*xb+h*Ba,ca=e*la+f*Ka+g*qa+h*Qb,kb=m*bb+l*ia+u*jb+K*Aa,ra=m*y+l*wb+u*Pb+K*Sa,La=m*Cb+l*Ja+u*xb+K*Ba,X=m*la+l*Ka+u*qa+K*Qb,ma=H*bb+C*ia+r*jb+p*Aa,R=H*y+C*wb+r*
Pb+p*Sa,L=H*Cb+C*Ja+r*xb+p*Ba,Ca=H*la+C*Ka+r*qa+p*Qb,U=B*bb+ka*ia+P*jb+W*Aa,Q=B*y+ka*wb+P*Pb+W*Sa,Da=B*Cb+ka*Ja+P*xb+W*Ba,Y=B*la+ka*Ka+P*qa+W*Qb,Eb=cb*ra-ba*kb,Fb=cb*La-db*kb,wa=cb*X-ca*kb,Ma=ba*La-db*ra,Gb=ba*X-ca*ra,Hb=db*X-ca*La,xa=ma*Q-R*U,lb=ma*Da-L*U,Ta=ma*Y-Ca*U,yb=R*Da-L*Q,bc=R*Y-Ca*Q,Na=L*Y-Ca*Da,Ua=ra*Na-La*bc+X*yb,ob=kb*Na-La*Ta+X*lb,nc=kb*bc-ra*Ta+X*xa,cc=kb*yb-ra*lb+La*xa,na=cb*Ua-ba*ob+db*nc-ca*cc;0!=na&&(na=1/na);var sa=Ua*na,pc=-(ba*Na-db*bc+ca*yb)*na,Ac=(Q*Hb-Da*Gb+Y*Ma)*na,dc=-ob*
na,Ea=(cb*Na-db*Ta+ca*lb)*na,I=-(U*Hb-Da*wa+Y*Fb)*na,oc=nc*na,Nb=-(cb*bc-ba*Ta+ca*xa)*na,qc=(U*Gb-Q*wa+Y*Eb)*na,F=sc.N,D=this.wc;b.C[F.ya.model.name]=v.j(4,4,[D.fa,D.ia,D.ca,D.qa,D.ga,D.ja,D.da,D.ra,D.ha,D.ka,D.ea,D.sa,D.na,D.oa,D.pa,D.ta]);var V=this.Za;b.C[F.ya.view.name]=v.j(4,4,[V.fa,V.ia,V.ca,V.qa,V.ga,V.ja,V.da,V.ra,V.ha,V.ka,V.ea,V.sa,V.na,V.oa,V.pa,V.ta]);var Va=this.kb;b.C[F.ya.Ra.name]=v.j(4,4,[Va.fa,Va.ia,Va.ca,Va.qa,Va.ga,Va.ja,Va.da,Va.ra,Va.ha,Va.ka,Va.ea,Va.sa,Va.na,Va.oa,Va.pa,Va.ta]);
var Oa=this.kb,eb=Oa.fa,Wa=Oa.ga,Pa=Oa.ha,Ib=Oa.na,fb=Oa.ia,Z=Oa.ja,pb=Oa.ka,Yb=Oa.oa,Db=Oa.ca,zb=Oa.da,aa=Oa.ea,Fa=Oa.pa,oa=Oa.qa,ta=Oa.ra,Xa=Oa.sa,Jb=Oa.ta,Ya=eb*Z-Wa*fb,Ab=eb*pb-Pa*fb,Za=eb*Yb-Ib*fb,ya=Wa*pb-Pa*Z,gb=Wa*Yb-Ib*Z,Rb=Pa*Yb-Ib*pb,Ob=Db*ta-zb*oa,Bb=Db*Xa-aa*oa,$a=Db*Jb-Fa*oa,Qa=zb*Xa-aa*ta,za=zb*Jb-Fa*ta,Sb=aa*Jb-Fa*Xa,qb=Z*Sb-pb*za+Yb*Qa,ec=fb*Sb-pb*$a+Yb*Bb,fc=fb*za-Z*$a+Yb*Ob,Ga=fb*Qa-Z*Bb+pb*Ob,O=eb*qb-Wa*ec+Pa*fc-Ib*Ga;0!=O&&(O=1/O);b.C[F.ya.Ma.name]=v.j(4,4,[qb*O,-ec*O,fc*O,-Ga*
O,-(Wa*Sb-Pa*za+Ib*Qa)*O,(eb*Sb-Pa*$a+Ib*Bb)*O,-(eb*za-Wa*$a+Ib*Ob)*O,(eb*Qa-Wa*Bb+Pa*Ob)*O,(ta*Rb-Xa*gb+Jb*ya)*O,-(oa*Rb-Xa*Za+Jb*Ab)*O,(oa*gb-ta*Za+Jb*Ya)*O,-(oa*ya-ta*Ab+Xa*Ya)*O,-(zb*Rb-aa*gb+Fa*ya)*O,(Db*Rb-aa*Za+Fa*Ab)*O,-(Db*gb-zb*Za+Fa*Ya)*O,(Db*ya-zb*Ab+aa*Ya)*O]);b.C[F.ya.Na.name]=v.j(4,4,[cb,kb,ma,U,ba,ra,R,Q,db,La,L,Da,ca,X,Ca,Y]);var S=this.kb,Ra=S.fa,da=S.ga,rb=S.ha,sb=S.na,Ha=S.ia,tb=S.ja,pa=S.ka,ea=S.oa,ub=S.ca,vb=S.da,vc=S.ea,mb=S.pa,nb=S.qa,gc=S.ra,hc=S.sa,ic=S.ta;b.C[F.ya.transform.name]=
v.j(4,4,[Ra*cb+da*kb+rb*ma+sb*U,Ha*cb+tb*kb+pa*ma+ea*U,ub*cb+vb*kb+vc*ma+mb*U,nb*cb+gc*kb+hc*ma+ic*U,Ra*ba+da*ra+rb*R+sb*Q,Ha*ba+tb*ra+pa*R+ea*Q,ub*ba+vb*ra+vc*R+mb*Q,nb*ba+gc*ra+hc*R+ic*Q,Ra*db+da*La+rb*L+sb*Da,Ha*db+tb*La+pa*L+ea*Da,ub*db+vb*La+vc*L+mb*Da,nb*db+gc*La+hc*L+ic*Da,Ra*ca+da*X+rb*Ca+sb*Y,Ha*ca+tb*X+pa*Ca+ea*Y,ub*ca+vb*X+vc*Ca+mb*Y,nb*ca+gc*X+hc*Ca+ic*Y]);b.C[F.ya.La.name]=v.j(4,4,[sa,dc,oc,-cc*na,pc,Ea,Nb,(cb*yb-ba*lb+db*xa)*na,Ac,I,qc,-(U*Ma-Q*Fb+Da*Eb)*na,-(R*Hb-L*Gb+Ca*Ma)*na,(ma*
Hb-L*wa+Ca*Fb)*na,-(ma*Gb-R*wa+Ca*Eb)*na,(ma*Ma-R*Fb+L*Eb)*na]);b.C[F.ya.ua.name]=v.j(3,3,[sa,pc,Ac,dc,Ea,I,oc,Nb,qc]);b.C[F.Aa.Ya.name]=v.s(this.nd);b.C[F.Aa.cd.name]=v.m(this.sh);b.C[F.Aa.qd.name]=v.m(this.th);b.C[F.Aa.Pd.name]=v.m(this.wh);b.C[F.Aa.Od.name]=v.m(this.vh);b.C[F.Aa.rd.name]=v.m(this.uh);b.C[F.Rb.name]=v.wa(this.Rb);for(var Lb=0,Bc=this.Rb;Lb<Bc;){var Zb=Lb++,ua=this.Za,ab=this.Qc[Zb].Sb;b.C[Xe.get(F.vc,Zb).position.name]=v.Xe(ua.fa*ab.x+ua.ga*ab.y+ua.ha*ab.z+ua.na*ab.w,ua.ia*ab.x+
ua.ja*ab.y+ua.ka*ab.z+ua.oa*ab.w,ua.ca*ab.x+ua.da*ab.y+ua.ea*ab.z+ua.pa*ab.w,ua.qa*ab.x+ua.ra*ab.y+ua.sa*ab.z+ua.ta*ab.w);var Tb=this.Za,Ub=this.Qc[Zb].zh;b.C[Xe.get(F.vc,Zb).ua.name]=v.Hb(Tb.fa*Ub.x+Tb.ga*Ub.y+Tb.ha*Ub.z,Tb.ia*Ub.x+Tb.ja*Ub.y+Tb.ka*Ub.z,Tb.ca*Ub.x+Tb.da*Ub.y+Tb.ea*Ub.z);var Cc=this.Qc[Zb].Ng;b.C[Xe.get(F.vc,Zb).color.name]=v.Hb(Cc.x,Cc.y,Cc.z)}};Ia.prototype.Tg=function(b){this.Af();b.fb(this.od)};Ia.prototype.Ug=function(b,a){this.Af();b.le(this.od,a)};Ia.D=!0;Ug.D=!0;Kg.prototype.expand=
function(){var b=this.data;this.data=new Int32Array(this.maxLength<<=1);this.data.set(b)};Kg.D=!0;Tg.D=!0;Sg(xd,M);xd.prototype.ma=function(b,a){this.Aa=new Tg;this.mode=4;this.Rg=[];M.prototype.ma.call(this,b);var c=sc.attributes;this.position=new Xb({buffer:Fd.m(new Fc(b,34962)),size:3,vb:0,offset:0},c.Kb.location);this.color=new Xb({buffer:Fd.m(new Fc(b,34962)),size:4,vb:0,offset:0},c.Ib.location);this.ua=new Xb({buffer:Fd.m(new Fc(b,34962)),size:3,vb:0,offset:0},c.Jb.location);this.Qd=new Xb({buffer:Fd.m(new Fc(b,
34962)),size:2,vb:0,offset:0},c.Lb.location);this.index=new Te(b);c=this.position.buffer.buffer;switch(c.o){case 0:throw hb.Sa("float buffer expected");case 1:var e=c.buffer}c=this.color.buffer.buffer;switch(c.o){case 0:throw hb.Sa("float buffer expected");case 1:var f=c.buffer}c=this.ua.buffer.buffer;switch(c.o){case 0:throw hb.Sa("float buffer expected");case 1:var g=c.buffer}c=this.Qd.buffer.buffer;switch(c.o){case 0:throw hb.Sa("float buffer expected");case 1:var h=c.buffer}this.Bc=new Ue(e,f,
g,h,this.index.buffer);e=Array(a.length);f=0;for(g=a.length;f<g;){h=f++;c=a[h];var m=void 0;switch(c.o){case 0:c=c.location;null!=c&&(this.position.location=c);m=this.position;break;case 1:c=c.location;null!=c&&(this.color.location=c);m=this.color;break;case 2:c=c.location;null!=c&&(this.ua.location=c);m=this.ua;break;case 3:c=c.location;null!=c&&(this.Qd.location=c);m=this.Qd;break;case 4:m=c.Lc,c=new Xb(c.buffer,c.location,null==m?0:m),this.Rg.push(c),m=c}e[h]=m}this.bb=new T(b,e,this.index)};xd.prototype.Fe=
function(){this.bb.Fe()};xd.prototype.fb=function(b){this.Aa.lb.bind([b,this.Aa.Mf]);this.bb.mode=this.mode;this.bb.fb()};xd.prototype.le=function(b,a){this.Aa.lb.bind([b,this.Aa.Mf]);this.bb.mode=this.mode;this.bb.le(a)};xd.prototype.sb=function(){this.position.xa();this.color.xa();this.ua.xa();this.Qd.xa();this.bb.xa()};xd.D=!0;Ue.prototype.clear=function(){var b=this.X;b.length=0;b.h=!0;b=this.U;b.length=0;b.h=!0;b=this.V;b.length=0;b.h=!0;b=this.Y;b.length=0;b.h=!0;b=this.S;b.length=0;b.h=!0;
this.G=0};Ue.prototype.upload=function(){var b=this.X;b.h&&(b.h=!1,b.buffer.upload(new Float32Array(b.data.buffer,0,b.length),b.usage));b=this.U;b.h&&(b.h=!1,b.buffer.upload(new Float32Array(b.data.buffer,0,b.length),b.usage));b=this.V;b.h&&(b.h=!1,b.buffer.upload(new Float32Array(b.data.buffer,0,b.length),b.usage));b=this.Y;b.h&&(b.h=!1,b.buffer.upload(new Float32Array(b.data.buffer,0,b.length),b.usage));b=this.S;b.h&&(b.h=!1,b.buffer.upload(new Int32Array(b.data.buffer,0,b.length),b.usage))};Ue.D=
!0;Kd.prototype.Qb=function(){return this.Ha[this.za]};Kd.prototype.xa=function(){for(var b=0,a=this.Ah;b<a;){var c=b++;this.Ha[0][c].xa();this.Ha[1][c].xa()}this.hb[0].xa();this.hb[1].xa()};Kd.D=!0;Sg(Gc,M);Gc.prototype.ma=function(b){this.Ke=new ae;this.Rd=new ae;this.Bb=0;M.prototype.ma.call(this,b);this.Qa=new wd(b)};Gc.prototype.dh=function(b){return null!=this.getUniformLocation(b)};Gc.prototype.compile=function(b,a,c){this.Rd.C=Object.create(null);this.Ke.C=Object.create(null);var e=!1;this.Qa.compile(b,
a,c,function(f){f=f+"\nvertex shader source:\n"+b;window.alert(pd.lc(f));q.console.log(f);e=!0},function(f){f=f+"\nfragment shader source:\n"+a;window.alert(pd.lc(f));q.console.log(f);e=!0},function(f){e||window.alert(pd.lc(f));q.console.log(f)})};Gc.prototype.bind=function(b){if(!this.Qa.Ze)throw Error("shader is not compiled");this.Qa.use();this.Lg(b)};Gc.prototype.Lg=function(b){for(var a=this.Bb=0;a<b.length;)for(var c=b[a++].C,e=Object.keys(c),f=e.length,g=0;g<f;){var h=e[g++],m=c[h];this.dh(h)&&
this.Kg(h,this.getUniformLocation(h),m)}this.g.activeTexture(33984)};Gc.prototype.Kg=function(b,a,c){var e=this.Ke.C[b],f=-1,g=-1,h=-1;switch(c.o){case 0:f=0;h=g=1;break;case 1:f=0;g=2;h=1;break;case 2:f=0;g=3;h=1;break;case 3:f=0;g=4;h=1;break;case 4:h=g=f=1;break;case 5:f=1;g=2;h=1;break;case 6:f=1;g=3;h=1;break;case 7:f=1;g=4;h=1;break;case 8:f=2;h=g=1;break;case 9:g=f=2;h=1;break;case 10:f=2;g=3;h=1;break;case 11:f=2;g=4;h=1;break;case 12:h=g=f=1;break;case 13:f=1;g=2;h=1;break;case 14:f=1;g=
3;h=1;break;case 15:f=1;g=4;h=1;break;case 16:f=0;g=c.rows;h=c.cols;break;case 17:h=g=f=1;break;case 18:f=0;g=1;h=c.T.length;break;case 19:var m=c.T;f=0;g=m[0].length;h=m.length;break;case 20:g=f=1;h=c.T.length;break;case 21:var l=c.T;f=1;g=l[0].length;h=l.length;break;case 22:f=2;g=1;h=c.T.length;break;case 23:var u=c.T;f=2;g=u[0].length;h=u.length;break;case 24:g=f=1;h=c.T.length;break;case 25:var K=c.T;f=1;g=K[0].length;h=K.length;break;case 26:var H=c.cols,C=c.rows;f=0;g=C;h=H*c.T.length;if(2>
H||2>C||4<H||4<C)throw hb.Sa("invalid matrix size: "+H+", "+C);break;case 27:g=f=1,h=c.Lf.length}var r=null,p=null,B=null;if(null==e)var ka=!1;else switch(e.o){case 0:var P=e.T;r=P;ka=0==f&&g==e.ab&&g*h==P.length;break;case 1:var W=e.T;p=W;ka=1==f&&g==e.ab&&g*h==W.length;break;case 2:var bb=e.T;B=bb;ka=2==f&&g==e.ab&&g*h==bb.length}if(!ka)switch(f){case 0:r=new Float32Array(g*h);e=$d.Zc(g,r);break;case 1:p=new Int32Array(g*h);e=$d.$c(g,p);break;default:B=new Uint32Array(g*h),e=$d.ad(g,B)}var y=ka;
switch(c.o){case 0:var Cb=c.x;y=y&&r[0]==Cb;r[0]=Cb;break;case 1:var la=c.x,ia=c.y;y=y&&r[0]==la&&r[1]==ia;r[0]=la;r[1]=ia;break;case 2:var wb=c.x,Ja=c.y,Ka=c.z;y=y&&r[0]==wb&&r[1]==Ja&&r[2]==Ka;r[0]=wb;r[1]=Ja;r[2]=Ka;break;case 3:var jb=c.x,Pb=c.y,xb=c.z,qa=c.w;y=y&&r[0]==jb&&r[1]==Pb&&r[2]==xb&&r[3]==qa;r[0]=jb;r[1]=Pb;r[2]=xb;r[3]=qa;break;case 4:var Aa=c.x;y=y&&p[0]==Aa;p[0]=Aa;break;case 5:var Sa=c.x,Ba=c.y;y=y&&p[0]==Sa&&p[1]==Ba;p[0]=Sa;p[1]=Ba;break;case 6:var Qb=c.x,cb=c.y,ba=c.z;y=y&&p[0]==
Qb&&p[1]==cb&&p[2]==ba;p[0]=Qb;p[1]=cb;p[2]=ba;break;case 7:var db=c.x,ca=c.y,kb=c.z,ra=c.w;y=y&&p[0]==db&&p[1]==ca&&p[2]==kb&&p[3]==ra;p[0]=db;p[1]=ca;p[2]=kb;p[3]=ra;break;case 8:var La=c.x;y=y&&B[0]==La;B[0]=La;break;case 9:var X=c.x,ma=c.y;y=y&&B[0]==X&&B[1]==ma;B[0]=X;B[1]=ma;break;case 10:var R=c.x,L=c.y,Ca=c.z;y=y&&B[0]==R&&B[1]==L&&B[2]==Ca;B[0]=R;B[1]=L;B[2]=Ca;break;case 11:var U=c.x,Q=c.y,Da=c.z,Y=c.w;y=y&&B[0]==U&&B[1]==Q&&B[2]==Da&&B[3]==Y;B[0]=U;B[1]=Q;B[2]=Da;B[3]=Y;break;case 12:var Eb=
c.x;y=y&&p[0]==(Eb?1:0);p[0]=Eb?1:0;break;case 13:var Fb=c.x,wa=c.y;y=y&&p[0]==(Fb?1:0)&&p[1]==(wa?1:0);p[0]=Fb?1:0;p[1]=wa?1:0;break;case 14:var Ma=c.x,Gb=c.y,Hb=c.z;y=y&&p[0]==(Ma?1:0)&&p[1]==(Gb?1:0)&&p[2]==(Hb?1:0);p[0]=Ma?1:0;p[1]=Gb?1:0;p[2]=Hb?1:0;break;case 15:var xa=c.x,lb=c.y,Ta=c.z,yb=c.w;y=y&&p[0]==(xa?1:0)&&p[1]==(lb?1:0)&&p[2]==(Ta?1:0)&&p[3]==(yb?1:0);p[0]=xa?1:0;p[1]=lb?1:0;p[2]=Ta?1:0;p[3]=yb?1:0;break;case 16:for(var bc=c.T,Na=0;Na<bc.length;){var Ua=bc[Na],ob=Na++;y=y&&r[ob]==Ua;
r[ob]=Ua}break;case 17:var nc=c.t;y=y&&p[0]==this.Bb;p[0]=this.Bb;this.g.activeTexture(33984+this.Bb);this.g.bindTexture(3553,null==nc?null:nc.Ya);this.Bb++;break;case 18:for(var cc=c.T,na=0;na<cc.length;){var sa=cc[na],pc=na++;y=y&&r[pc]==sa;r[pc]=sa}break;case 19:for(var Ac=c.T,dc=0,Ea=0;Ea<Ac.length;){var I=Ac[Ea];++Ea;for(var oc=0;oc<I.length;){var Nb=I[oc];++oc;y=y&&r[dc]==Nb;r[dc]=Nb;++dc}}break;case 20:for(var qc=c.T,F=0;F<qc.length;){var D=qc[F],V=F++;y=y&&p[V]==D;p[V]=D}break;case 21:for(var Va=
c.T,Oa=0,eb=0;eb<Va.length;){var Wa=Va[eb];++eb;for(var Pa=0;Pa<Wa.length;){var Ib=Wa[Pa];++Pa;y=y&&p[Oa]==Ib;p[Oa]=Ib;++Oa}}break;case 22:for(var fb=c.T,Z=0;Z<fb.length;){var pb=fb[Z],Yb=Z++;y=y&&B[Yb]==pb;B[Yb]=pb}break;case 23:for(var Db=c.T,zb=0,aa=0;aa<Db.length;){var Fa=Db[aa];++aa;for(var oa=0;oa<Fa.length;){var ta=Fa[oa];++oa;y=y&&B[zb]==ta;B[zb]=ta;++zb}}break;case 24:for(var Xa=c.T,Jb=0;Jb<Xa.length;){var Ya=Xa[Jb],Ab=Jb++;y=y&&p[Ab]==(Ya?1:0);p[Ab]=Ya?1:0}break;case 25:for(var Za=c.T,ya=
0,gb=0;gb<Za.length;){var Rb=Za[gb];++gb;for(var Ob=0;Ob<Rb.length;){var Bb=Rb[Ob];++Ob;y=y&&p[ya]==(Bb?1:0);p[ya]=Bb?1:0;++ya}}break;case 26:for(var $a=c.T,Qa=0,za=0;za<$a.length;){var Sb=$a[za];++za;for(var qb=0;qb<Sb.length;){var ec=Sb[qb];++qb;y=y&&r[Qa]==ec;r[Qa]=ec;++Qa}}break;case 27:for(var fc=c.Lf,Ga=0;Ga<fc.length;){var O=fc[Ga++],S=Ga-1;y=y&&p[S]==this.Bb;p[S]=this.Bb;this.g.activeTexture(33984+this.Bb);this.g.bindTexture(3553,O.Ya);this.Bb++}}if(!y)switch(this.Ke.C[b]=e,c.o){case 16:var Ra=
c.rows;switch(c.cols){case 2:switch(Ra){case 2:this.g.uniformMatrix2fv(a,!1,r);break;case 3:this.g.uniformMatrix2x3fv(a,!1,r);break;case 4:this.g.uniformMatrix2x4fv(a,!1,r);break;default:this.g.uniformMatrix4fv(a,!1,r)}break;case 3:switch(Ra){case 2:this.g.uniformMatrix3x2fv(a,!1,r);break;case 3:this.g.uniformMatrix3fv(a,!1,r);break;case 4:this.g.uniformMatrix3x4fv(a,!1,r);break;default:this.g.uniformMatrix4fv(a,!1,r)}break;case 4:switch(Ra){case 2:this.g.uniformMatrix4x2fv(a,!1,r);break;case 3:this.g.uniformMatrix4x3fv(a,
!1,r);break;default:this.g.uniformMatrix4fv(a,!1,r)}break;default:this.g.uniformMatrix4fv(a,!1,r)}break;case 26:var da=c.rows;switch(c.cols){case 2:switch(da){case 2:this.g.uniformMatrix2fv(a,!1,r);break;case 3:this.g.uniformMatrix2x3fv(a,!1,r);break;case 4:this.g.uniformMatrix2x4fv(a,!1,r);break;default:this.g.uniformMatrix4fv(a,!1,r)}break;case 3:switch(da){case 2:this.g.uniformMatrix3x2fv(a,!1,r);break;case 3:this.g.uniformMatrix3fv(a,!1,r);break;case 4:this.g.uniformMatrix3x4fv(a,!1,r);break;
default:this.g.uniformMatrix4fv(a,!1,r)}break;case 4:switch(da){case 2:this.g.uniformMatrix4x2fv(a,!1,r);break;case 3:this.g.uniformMatrix4x3fv(a,!1,r);break;default:this.g.uniformMatrix4fv(a,!1,r)}break;default:this.g.uniformMatrix4fv(a,!1,r)}break;default:switch(f){case 0:switch(g){case 1:this.g.uniform1fv(a,r);break;case 2:this.g.uniform2fv(a,r);break;case 3:this.g.uniform3fv(a,r);break;case 4:this.g.uniform4fv(a,r);break;default:this.g.uniform4uiv(a,B)}break;case 1:switch(g){case 1:this.g.uniform1iv(a,
p);break;case 2:this.g.uniform2iv(a,p);break;case 3:this.g.uniform3iv(a,p);break;case 4:this.g.uniform4iv(a,p);break;default:this.g.uniform4uiv(a,B)}break;case 2:switch(g){case 1:this.g.uniform1uiv(a,B);break;case 2:this.g.uniform2uiv(a,B);break;case 3:this.g.uniform3uiv(a,B);break;default:this.g.uniform4uiv(a,B)}break;default:this.g.uniform4uiv(a,B)}}};Gc.prototype.getUniformLocation=function(b){if(Object.prototype.hasOwnProperty.call(this.Rd.C,b))return this.Rd.C[b];var a=this.Qa.getUniformLocation(b);
return this.Rd.C[b]=a};Gc.prototype.sb=function(){this.Qa.xa()};Gc.D=!0;var $d=Sc["pot.graphics.gl._Shader.InternalUniformValue"]={yb:!0,Ca:null,Zc:(k=function(b,a){return{o:0,ab:b,T:a,v:"pot.graphics.gl._Shader.InternalUniformValue",toString:A}},k.A="Floats",k.F=["dim","vs"],k),$c:(k=function(b,a){return{o:1,ab:b,T:a,v:"pot.graphics.gl._Shader.InternalUniformValue",toString:A}},k.A="Ints",k.F=["dim","vs"],k),ad:(k=function(b,a){return{o:2,ab:b,T:a,v:"pot.graphics.gl._Shader.InternalUniformValue",
toString:A}},k.A="UInts",k.F=["dim","vs"],k)};$d.Ca=[$d.Zc,$d.$c,$d.ad];Sg(nd,M);nd.prototype.oh=function(){switch(this.type){case 5121:return 32856;case 5124:return 36226;case 5125:return 36208;case 5126:return 34836;case 5131:return 34842}};nd.prototype.kf=function(){switch(this.type){case 5124:case 5125:return 36249;case 5121:case 5126:case 5131:return 6408}};nd.prototype.eh=function(b,a,c){this.width=b;this.height=a;this.type=c;this.g.bindTexture(3553,this.Ya);this.g.texImage2D(3553,0,this.oh(),
b,a,0,this.kf(),c,null);this.g.bindTexture(3553,null);switch(c){case 5124:case 5125:this.Vc=9728}this.Vc=b=this.Vc;this.g.bindTexture(3553,this.Ya);switch(b){case 9728:this.g.texParameteri(3553,10240,9728);this.g.texParameteri(3553,10241,9728);break;case 9729:this.g.texParameteri(3553,10240,9729),this.g.texParameteri(3553,10241,9729)}this.g.bindTexture(3553,null);b=this.Jf;a=this.Kf;this.Jf=b;this.Kf=a;this.g.bindTexture(3553,this.Ya);this.g.texParameteri(3553,10242,b);this.g.texParameteri(3553,10243,
a);this.g.bindTexture(3553,null);this.ih()};nd.prototype.sync=function(){this.g.bindFramebuffer(36160,this.me.td);var b=this.g,a=this.kf();switch(this.type){case 5121:var c=new Uint8Array(4);break;case 5124:c=new Int32Array(4);break;case 5125:c=new Uint32Array(4);break;case 5126:c=new Float32Array(4);break;case 5131:c=new Uint16Array(4)}b.readPixels(0,0,1,1,a,this.type,c);this.g.bindFramebuffer(36160,null)};nd.prototype.ih=function(){this.me.qf()};nd.prototype.sb=function(){this.g.deleteTexture(this.Ya);
this.me.xa()};nd.D=!0;var Fd=Sc["pot.graphics.gl.TypedBuffer"]={yb:!0,Ca:null,wa:(k=function(b){return{o:0,buffer:b,v:"pot.graphics.gl.TypedBuffer",toString:A}},k.A="Int",k.F=["buffer"],k),m:(k=function(b){return{o:1,buffer:b,v:"pot.graphics.gl.TypedBuffer",toString:A}},k.A="Float",k.F=["buffer"],k)};Fd.Ca=[Fd.wa,Fd.m];var v=Sc["pot.graphics.gl.UniformValue"]={yb:!0,Ca:null,m:(k=function(b){return{o:0,x:b,v:"pot.graphics.gl.UniformValue",toString:A}},k.A="Float",k.F=["x"],k),be:(k=function(b,a){return{o:1,
x:b,y:a,v:"pot.graphics.gl.UniformValue",toString:A}},k.A="Vec2",k.F=["x","y"],k),Hb:(k=function(b,a,c){return{o:2,x:b,y:a,z:c,v:"pot.graphics.gl.UniformValue",toString:A}},k.A="Vec3",k.F=["x","y","z"],k),Xe:(k=function(b,a,c,e){return{o:3,x:b,y:a,z:c,w:e,v:"pot.graphics.gl.UniformValue",toString:A}},k.A="Vec4",k.F=["x","y","z","w"],k),wa:(k=function(b){return{o:4,x:b,v:"pot.graphics.gl.UniformValue",toString:A}},k.A="Int",k.F=["x"],k),Gb:(k=function(b,a){return{o:5,x:b,y:a,v:"pot.graphics.gl.UniformValue",
toString:A}},k.A="IVec2",k.F=["x","y"],k),Ec:(k=function(b,a,c){return{o:6,x:b,y:a,z:c,v:"pot.graphics.gl.UniformValue",toString:A}},k.A="IVec3",k.F=["x","y","z"],k),fg:(k=function(b,a,c,e){return{o:7,x:b,y:a,z:c,w:e,v:"pot.graphics.gl.UniformValue",toString:A}},k.A="IVec4",k.F=["x","y","z","w"],k),Hc:(k=function(b){return{o:8,x:b,v:"pot.graphics.gl.UniformValue",toString:A}},k.A="UInt",k.F=["x"],k),xg:(k=function(b,a){return{o:9,x:b,y:a,v:"pot.graphics.gl.UniformValue",toString:A}},k.A="UVec2",k.F=
["x","y"],k),yg:(k=function(b,a,c){return{o:10,x:b,y:a,z:c,v:"pot.graphics.gl.UniformValue",toString:A}},k.A="UVec3",k.F=["x","y","z"],k),zg:(k=function(b,a,c,e){return{o:11,x:b,y:a,z:c,w:e,v:"pot.graphics.gl.UniformValue",toString:A}},k.A="UVec4",k.F=["x","y","z","w"],k),Dc:(k=function(b){return{o:12,x:b,v:"pot.graphics.gl.UniformValue",toString:A}},k.A="Bool",k.F=["x"],k),Uf:(k=function(b,a){return{o:13,x:b,y:a,v:"pot.graphics.gl.UniformValue",toString:A}},k.A="BVec2",k.F=["x","y"],k),Vf:(k=function(b,
a,c){return{o:14,x:b,y:a,z:c,v:"pot.graphics.gl.UniformValue",toString:A}},k.A="BVec3",k.F=["x","y","z"],k),Wf:(k=function(b,a,c,e){return{o:15,x:b,y:a,z:c,w:e,v:"pot.graphics.gl.UniformValue",toString:A}},k.A="BVec4",k.F=["x","y","z","w"],k),j:(k=function(b,a,c){return{o:16,cols:b,rows:a,T:c,v:"pot.graphics.gl.UniformValue",toString:A}},k.A="Mat",k.F=["cols","rows","vs"],k),s:(k=function(b){return{o:17,t:b,v:"pot.graphics.gl.UniformValue",toString:A}},k.A="Sampler",k.F=["t"],k),Zc:(k=function(b){return{o:18,
T:b,v:"pot.graphics.gl.UniformValue",toString:A}},k.A="Floats",k.F=["vs"],k),Cg:(k=function(b){return{o:19,T:b,v:"pot.graphics.gl.UniformValue",toString:A}},k.A="Vecs",k.F=["vs"],k),$c:(k=function(b){return{o:20,T:b,v:"pot.graphics.gl.UniformValue",toString:A}},k.A="Ints",k.F=["vs"],k),gg:(k=function(b){return{o:21,T:b,v:"pot.graphics.gl.UniformValue",toString:A}},k.A="IVecs",k.F=["vs"],k),ad:(k=function(b){return{o:22,T:b,v:"pot.graphics.gl.UniformValue",toString:A}},k.A="UInts",k.F=["vs"],k),Ag:(k=
function(b){return{o:23,T:b,v:"pot.graphics.gl.UniformValue",toString:A}},k.A="UVecs",k.F=["vs"],k),Yf:(k=function(b){return{o:24,T:b,v:"pot.graphics.gl.UniformValue",toString:A}},k.A="Bools",k.F=["vs"],k),Xf:(k=function(b){return{o:25,T:b,v:"pot.graphics.gl.UniformValue",toString:A}},k.A="BVecs",k.F=["vs"],k),ig:(k=function(b,a,c){return{o:26,cols:b,rows:a,T:c,v:"pot.graphics.gl.UniformValue",toString:A}},k.A="Mats",k.F=["cols","rows","vs"],k),We:(k=function(b){return{o:27,Lf:b,v:"pot.graphics.gl.UniformValue",
toString:A}},k.A="Samplers",k.F=["ts"],k)};v.Ca=[v.m,v.be,v.Hb,v.Xe,v.wa,v.Gb,v.Ec,v.fg,v.Hc,v.xg,v.yg,v.zg,v.Dc,v.Uf,v.Vf,v.Wf,v.j,v.s,v.Zc,v.Cg,v.$c,v.gg,v.ad,v.Ag,v.Yf,v.Xf,v.ig,v.We];Xb.prototype.xa=function(){var b=this.buffer.buffer;switch(b.o){case 0:b.buffer.xa();break;case 1:b.buffer.xa()}};Xb.D=!0;Sg(Fc,M);Fc.prototype.ma=function(b,a){this.length=this.hd=0;M.prototype.ma.call(this,b);this.kind=a;this.buffer=b.createBuffer()};Fc.prototype.upload=function(b,a){this.length=b.length;this.g.bindBuffer(this.kind,
this.buffer);this.g.bufferData(this.kind,b,a);this.g.bindBuffer(this.kind,null);this.hd=this.length};Fc.prototype.If=function(b,a){if(b+a.length>this.hd)throw hb.Sa("assertion error");this.g.bindBuffer(this.kind,this.buffer);this.g.bufferSubData(this.kind,b*Float32Array.BYTES_PER_ELEMENT,a,0);this.g.bindBuffer(this.kind,null);var c=this.length;b+=a.length;this.length=c>b?c:b};Fc.prototype.sync=function(){this.g.bindBuffer(this.kind,this.buffer);this.g.getBufferSubData(this.kind,0,new Float32Array(1));
this.g.bindBuffer(this.kind,null)};Fc.prototype.vertexAttribPointer=function(b,a,c,e){if(34962!=this.kind)throw hb.Sa("assertion error");this.g.bindBuffer(this.kind,this.buffer);this.g.vertexAttribPointer(b,a,5126,!1,c,e);this.g.bindBuffer(this.kind,null)};Fc.prototype.sb=function(){this.g.deleteBuffer(this.buffer)};Fc.D=!0;Sg(Te,M);Te.prototype.sb=function(){this.buffer.xa()};Te.D=!0;Sg(Id,M);Id.prototype.ma=function(b,a){this.length=this.hd=0;M.prototype.ma.call(this,b);this.kind=a;this.buffer=
b.createBuffer()};Id.prototype.upload=function(b,a){this.length=b.length;this.g.bindBuffer(this.kind,this.buffer);this.g.bufferData(this.kind,b,a);this.g.bindBuffer(this.kind,null);this.hd=this.length};Id.prototype.vertexAttribPointer=function(b,a,c,e){if(34962!=this.kind)throw hb.Sa("assertion error");this.g.bindBuffer(this.kind,this.buffer);this.g.vertexAttribIPointer(b,a,5124,c,e);this.g.bindBuffer(this.kind,null)};Id.prototype.sb=function(){this.g.deleteBuffer(this.buffer)};Id.D=!0;Sg(wd,M);wd.prototype.ma=
function(b){this.Ze=!1;M.prototype.ma.call(this,b);this.Qa=b.createProgram();this.Ac=b.createShader(35633);this.sc=b.createShader(35632)};wd.prototype.compile=function(b,a,c,e,f,g){this.g.shaderSource(this.Ac,b);this.g.compileShader(this.Ac);this.g.getShaderParameter(this.Ac,35713)||e(this.g.getShaderInfoLog(this.Ac));this.g.shaderSource(this.sc,a);this.g.compileShader(this.sc);this.g.getShaderParameter(this.sc,35713)||f(this.g.getShaderInfoLog(this.sc));this.g.attachShader(this.Qa,this.Ac);this.g.attachShader(this.Qa,
this.sc);null!=c&&this.g.transformFeedbackVaryings(this.Qa,c.Sh,c.kind);this.g.linkProgram(this.Qa);this.g.getProgramParameter(this.Qa,35714)?this.Ze=!0:g(this.g.getProgramInfoLog(this.Qa))};wd.prototype.use=function(){this.g.useProgram(this.Qa)};wd.prototype.getUniformLocation=function(b){return this.g.getUniformLocation(this.Qa,b)};wd.prototype.sb=function(){this.g.deleteProgram(this.Qa);this.g.deleteShader(this.Ac);this.g.deleteShader(this.sc)};wd.D=!0;Sg(lc,M);lc.prototype.ma=function(b){this.Jc=
[];M.prototype.ma.call(this,b);this.$b=b.createTransformFeedback()};lc.prototype.bind=function(){this.g.bindTransformFeedback(36386,this.$b)};lc.prototype.Jg=function(b){for(var a=0;a<b.length;){var c=b[a++];this.bindBuffer(a-1,c)}};lc.prototype.bindBuffer=function(b,a){null==a?(mc.remove(this.Jc,b),this.g.bindBufferBase(35982,b,null)):(this.Jc.includes(b)||this.Jc.push(b),this.g.bindBufferBase(35982,b,a.buffer))};lc.prototype.Fg=function(){this.g.enable(35977);this.g.beginTransformFeedback(0)};lc.prototype.end=
function(){this.g.disable(35977);this.g.endTransformFeedback()};lc.prototype.Ph=function(){for(var b=0,a=this.Jc;b<a.length;)this.g.bindBufferBase(35982,a[b++],null);this.Jc.length=0;this.g.bindTransformFeedback(36386,null)};lc.prototype.sb=function(){this.g.deleteTransformFeedback(this.$b)};lc.D=!0;Sg(T,M);T.prototype.ma=function(b,a,c){this.mode=4;M.prototype.ma.call(this,b);this.attributes=a.slice();this.qe=c;this.bb=b.createVertexArray();b.bindVertexArray(this.bb);for(var e=0;e<a.length;){var f=
a[e];++e;f.g.enableVertexAttribArray(f.location);f.g.vertexAttribDivisor(f.location,f.Lc);var g=f.buffer.buffer;switch(g.o){case 0:g.buffer.vertexAttribPointer(f.location,f.buffer.size,f.buffer.vb,f.buffer.offset);break;case 1:g.buffer.vertexAttribPointer(f.location,f.buffer.size,f.buffer.vb,f.buffer.offset)}}c.g.bindBuffer(34963,c.buffer.buffer);b.bindVertexArray(null)};T.prototype.Fe=function(){this.g.bindVertexArray(this.bb);for(var b=0,a=this.attributes;b<a.length;){var c=a[b];++b;c.g.enableVertexAttribArray(c.location);
c.g.vertexAttribDivisor(c.location,c.Lc);var e=c.buffer.buffer;switch(e.o){case 0:e.buffer.vertexAttribPointer(c.location,c.buffer.size,c.buffer.vb,c.buffer.offset);break;case 1:e.buffer.vertexAttribPointer(c.location,c.buffer.size,c.buffer.vb,c.buffer.offset)}}this.g.bindVertexArray(null)};T.prototype.fb=function(){this.g.bindVertexArray(this.bb);this.g.drawElements(this.mode,this.qe.buffer.length,5125,0);this.g.bindVertexArray(null)};T.prototype.le=function(b){this.g.bindVertexArray(this.bb);this.g.drawElementsInstanced(this.mode,
this.qe.buffer.length,5125,0,b);this.g.bindVertexArray(null)};T.prototype.sb=function(){this.g.deleteVertexArray(this.bb);for(var b=0,a=this.attributes;b<a.length;)a[b++].xa();this.qe.xa()};T.D=!0;Sg(G,Ie);G.D=!0;Sg(z,sc);z.D=!0;E.mf=function(b){return-1==E.Qf.indexOf(b)?null:b};Mb.prototype.de=function(b,a,c,e){function f(l){l.cancelable&&l.preventDefault();l=l.changedTouches;for(var u=0,K=l.length;u<K;){var H=l[u++],C=g.oe(H.identifier);if(null!=C){var r=H.clientX-a.getBoundingClientRect().left,
p=void 0;switch(h.eb){case 0:p=b.width/c.Pa/b.clientWidth;break;case 1:p=b.width/b.clientWidth}r*=p;H=H.clientY-a.getBoundingClientRect().top;p=void 0;switch(h.eb){case 0:p=b.height/c.Pa/b.clientHeight;break;case 1:p=b.height/b.clientHeight}C.I=r;C.J=H*p;C.Ld=!1}}}this.Rc.de(b,a,this,c,e);var g=this.touches,h=this;a.addEventListener("touchstart",function(l){l.cancelable&&l.preventDefault();l=l.changedTouches;for(var u=0,K=l.length;u<K;){var H=l[u++],C=g.oe(H.identifier,!0),r=H.clientX-a.getBoundingClientRect().left,
p=void 0;switch(h.eb){case 0:p=b.width/c.Pa/b.clientWidth;break;case 1:p=b.width/b.clientWidth}r*=p;H=H.clientY-a.getBoundingClientRect().top;p=void 0;switch(h.eb){case 0:p=b.height/c.Pa/b.clientHeight;break;case 1:p=b.height/b.clientHeight}C.I=r;C.J=H*p;C.Ld=!0;C.Md=!0}},{passive:!1});a.addEventListener("touchmove",function(l){l.cancelable&&l.preventDefault();l=l.changedTouches;for(var u=0,K=l.length;u<K;){var H=l[u++],C=g.oe(H.identifier);if(null!=C){var r=H.clientX-a.getBoundingClientRect().left,
p=void 0;switch(h.eb){case 0:p=b.width/c.Pa/b.clientWidth;break;case 1:p=b.width/b.clientWidth}r*=p;H=H.clientY-a.getBoundingClientRect().top;p=void 0;switch(h.eb){case 0:p=b.height/c.Pa/b.clientHeight;break;case 1:p=b.height/b.clientHeight}C.I=r;C.J=H*p}}},{passive:!1});a.addEventListener("touchend",f);a.addEventListener("touchcancel",f);if(null!=this.keyboard){var m=this.keyboard;e=window.document.documentElement;e.addEventListener("keydown",function(l){var u=E.mf(l.code);null!=u&&(!E.Ue.includes(u)&&
l.cancelable&&l.preventDefault(),Object.prototype.hasOwnProperty.call(m.keys.C,u)||(m.keys.C[u]=new fa),m.se.add(l.key))});e.addEventListener("keyup",function(l){var u=E.mf(l.code);null!=u&&(!E.Ue.includes(u)&&l.cancelable&&l.preventDefault(),Object.prototype.hasOwnProperty.call(m.keys.C,u)||(m.keys.C[u]=new fa),m.keys.C[u].release(),m.wf.add(l.key))});window.addEventListener("blur",function(){for(var l=m.keys.C,u=Object.keys(l),K=u.length,H=0;H<K;)l[u[H++]].release()})}};Mb.prototype.update=function(b){this.Rc.update(b);
for(var a=this.touches,c=0;c<a.touches.length;){var e=a.touches[c];e.update(b);e.Ee||e.Wc||e.Ld?++c:mc.remove(a.touches,e)}if(null!=this.keyboard){b=this.keyboard;a=b.keys.C;c=Object.keys(a);e=c.length;for(var f=0;f<e;)a[c[f++]].update();b.gf.clear();b.Le.clear();a=b.se.values();for(c=a.next();!c.done;)e=c.value,c=a.next(),b.gf.add(e);a=b.Le.values();for(c=a.next();!c.done;)e=c.value,c=a.next(),b.Le.add(e);b.se.clear();b.wf.clear()}0<this.touches.touches.length&&(this.Rc.uc=!1)};Mb.D=!0;var Pe=Sc["pot.input.InputTarget"]=
{yb:!0,Ca:null,Se:{A:"Canvas",o:0,v:"pot.input.InputTarget",toString:A},Document:{A:"Document",o:1,v:"pot.input.InputTarget",toString:A},jg:{A:"None",o:2,v:"pot.input.InputTarget",toString:A}};Pe.Ca=[Pe.Se,Pe.Document,Pe.jg];fa.prototype.release=function(){};fa.prototype.update=function(){};fa.D=!0;ja.D=!0;J.prototype.de=function(b,a,c,e,f){var g=this;a.addEventListener("mouseenter",function(){return g.xc=!0});a.addEventListener("mouseleave",function(){return g.xc=!1});a.addEventListener("mousedown",
function(h){g.uc=!0;g.xc=!0;h.cancelable&&h.preventDefault();switch(h.button){case 0:g.te=!0;g.ue=!0;break;case 1:g.uf=!0;g.vf=!0;break;case 2:g.ve=!0,g.we=!0}var m=h.clientX-b.getBoundingClientRect().left;switch(c.eb){case 0:var l=b.width/e.Pa/b.clientWidth;break;case 1:l=b.width/b.clientWidth}g.I=m*l;h=h.clientY-b.getBoundingClientRect().top;switch(c.eb){case 0:var u=b.height/e.Pa/b.clientHeight;break;case 1:u=b.height/b.clientHeight}return g.J=h*u});a.addEventListener("mouseup",function(h){g.uc=
!0;g.xc=!0;h.cancelable&&h.preventDefault();switch(h.button){case 0:g.te=!1;break;case 1:g.uf=!1;break;case 2:g.ve=!1}var m=h.clientX-b.getBoundingClientRect().left;switch(c.eb){case 0:var l=b.width/e.Pa/b.clientWidth;break;case 1:l=b.width/b.clientWidth}g.I=m*l;h=h.clientY-b.getBoundingClientRect().top;switch(c.eb){case 0:var u=b.height/e.Pa/b.clientHeight;break;case 1:u=b.height/b.clientHeight}return g.J=h*u});a.addEventListener("mousemove",function(h){g.uc=!0;g.xc=!0;var m=h.clientX-b.getBoundingClientRect().left;
switch(c.eb){case 0:var l=b.width/e.Pa/b.clientWidth;break;case 1:l=b.width/b.clientWidth}g.I=m*l;h=h.clientY-b.getBoundingClientRect().top;switch(c.eb){case 0:var u=b.height/e.Pa/b.clientHeight;break;case 1:u=b.height/b.clientHeight}return g.J=h*u});f&&a.addEventListener("wheel",function(h){switch(h.deltaMode){case 0:var m=1;break;case 1:m=24;break;case 2:m=720;break;default:throw hb.Sa("invalid wheel delta mode");}g.xe+=h.deltaX*m;g.ye+=h.deltaY*m;h.preventDefault()},{passive:!1});a.addEventListener("contextmenu",
function(h){g.uc=!0;g.xc=!0;h.preventDefault()});a.addEventListener("pointerdown",function(h){a.setPointerCapture(h.pointerId)});a.addEventListener("pointerup",function(h){a.releasePointerCapture(h.pointerId)})};J.prototype.update=function(b){this.x=this.Tb+b*(this.I-this.Tb);this.y=this.Ub+b*(this.J-this.Ub);this.yf=this.left;this.left=this.te||this.ue;this.right=this.ve||this.we;this.we=this.vf=this.ue=!1;this.ff=(this.left?1:0)-(this.yf?1:0);this.ye=this.xe=0;1==b&&(this.Tb=this.x,this.Ub=this.y)};
J.D=!0;x.prototype.update=function(b){this.Md&&(this.Tb=this.I,this.Ub=this.J);this.x=this.Tb+b*(this.I-this.Tb);this.y=this.Ub+b*(this.J-this.Ub);this.Ee=this.Wc;this.Wc=this.Ld||this.Md;this.Md=!1;this.jf=(this.Wc?1:0)-(this.Ee?1:0);1==b&&(this.Tb=this.x,this.Ub=this.y)};x.D=!0;w.prototype.oe=function(b,a){null==a&&(a=!1);for(var c=0,e=this.touches;c<e.length;){var f=e[c];++c;if(f.Hh==b)return f}return a?this.yh(b):null};w.prototype.yh=function(b){for(var a=0;;){for(var c=a,e=0,f=this.touches;e<
f.length;)f[e++].id==a&&++a;if(c==a)break}b=new x(a,b);this.touches.push(b);return b};w.D=!0;q.Re|=0;"undefined"!=typeof performance&&"function"==typeof performance.now&&(mc.now=performance.now.bind(performance));String.D=!0;Array.D=!0;sc.N=function(){for(var b={transform:{name:"matrix.transform",type:d.j(4,4)},model:{name:"matrix.model",type:d.j(4,4)},view:{name:"matrix.view",type:d.j(4,4)},Ra:{name:"matrix.projection",type:d.j(4,4)},Ma:{name:"matrix.invProjection",type:d.j(4,4)},Na:{name:"matrix.modelView",
type:d.j(4,4)},La:{name:"matrix.invModelView",type:d.j(4,4)},ua:{name:"matrix.normal",type:d.j(3,3)}},a={cd:{name:"material.ambient",type:d.m},qd:{name:"material.diffuse",type:d.m},Pd:{name:"material.specular",type:d.m},Od:{name:"material.shininess",type:d.m},rd:{name:"material.emission",type:d.m},Ya:{name:"material.texture",type:d.s(t.u)}},c={name:"numLights",type:d.wa},e=[],f=0;16>f;){var g="lights["+f++ +"]";e.push({position:{name:g+".position",type:d.i(4)},color:{name:g+".color",type:d.i(3)},
ua:{name:g+".normal",type:d.i(3)}})}return{ya:b,Aa:a,Rb:c,vc:new uc(e,"lights",d.Gc)}}(this);sc.attributes={Kb:{name:"aPosition",type:n.i(4),location:0},Ib:{name:"aColor",type:n.i(4),location:1},Jb:{name:"aNormal",type:n.i(3),location:2},Lb:{name:"aTexCoord",type:n.i(2),location:3}};sc.Yc="#version 300 es\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tmat4 transform;\n\tmat4 model;\n\tmat4 view;\n\tmat4 projection;\n\tmat4 invProjection;\n\tmat4 modelView;\n\tmat4 invModelView;\n\tmat3 normal;\n};\nstruct Struct1 {\n\tfloat ambient;\n\tfloat diffuse;\n\tfloat specular;\n\tfloat shininess;\n\tfloat emission;\n\tsampler2D texture;\n};\nstruct Struct2 {\n\tvec4 position;\n\tvec3 color;\n\tvec3 normal;\n};\n\nlayout(location = 0) in vec4 aPosition;\nlayout(location = 1) in vec4 aColor;\nlayout(location = 2) in vec3 aNormal;\nlayout(location = 3) in vec2 aTexCoord;\nuniform Struct0 matrix;\nuniform Struct1 material;\nuniform int numLights;\nuniform Struct2 lights[16];\nout vec4 vColor;\nout vec3 vPosition;\nout vec3 vNormal;\nout vec2 vTexCoord;\n\nvoid main() {\n\tgl_Position = matrix.transform * aPosition;\n\tgl_PointSize = 1.0;\n\tvColor = aColor;\n\tvPosition = (matrix.modelView * aPosition).xyz;\n\tvNormal = matrix.normal * aNormal;\n\tvTexCoord = aTexCoord;\n}";
sc.Nc="#version 300 es\nprecision highp int;\nprecision highp float;\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tmat4 transform;\n\tmat4 model;\n\tmat4 view;\n\tmat4 projection;\n\tmat4 invProjection;\n\tmat4 modelView;\n\tmat4 invModelView;\n\tmat3 normal;\n};\nstruct Struct1 {\n\tfloat ambient;\n\tfloat diffuse;\n\tfloat specular;\n\tfloat shininess;\n\tfloat emission;\n\tsampler2D texture;\n};\nstruct Struct2 {\n\tvec4 position;\n\tvec3 color;\n\tvec3 normal;\n};\n\nuniform Struct0 matrix;\nuniform Struct1 material;\nuniform int numLights;\nuniform Struct2 lights[16];\nin vec4 vColor;\nin vec3 vPosition;\nin vec3 vNormal;\nin vec2 vTexCoord;\nlayout(location = 0) out vec4 oColor;\n\nvec4 computeBaseColor() {\n\treturn vColor;\n}\n\nvec3 safeNormalize(vec3 v) {\n\treturn dot(v, v) > 0.0 ? normalize(v) : vec3(0);\n}\n\nvec3 ambientLight(vec3 lightColor, vec3 color) {\n\treturn lightColor * color * material.ambient;\n}\n\nvec3 directionalLight(vec3 lightColor, vec3 lightDirection, vec3 eye, vec3 normal, vec3 color) {\n\tfloat ldot = max(-dot(lightDirection, normal), 0.0);\n\tvec3 res = lightColor * color * ldot * material.diffuse;\n\tif (dot(normal, eye) < 0.0) {\n\t\tvec3 reflEye = eye - 2.0 * normal * dot(eye, normal);\n\t\tfloat rdot = max(-dot(reflEye, lightDirection), 0.0);\n\t\tres += lightColor * pow(rdot, material.shininess) * material.specular;\n\t}\n\treturn res;\n}\n\nvoid main() {\n\tvec4 baseColor = computeBaseColor();\n\tif (baseColor.w == 0.0) {\n\t\tdiscard;\n\t}\n\tif (numLights == 0) {\n\t\toColor = baseColor;\n\t\treturn;\n\t}\n\tvec3 eye = safeNormalize(vPosition);\n\tvec3 n = safeNormalize(vNormal);\n\tif (!gl_FrontFacing) {\n\t\tn = -n;\n\t}\n\tvec3 color = baseColor.xyz;\n\tvec3 total = color * material.emission;\n\tfor (int i = 0; i < numLights; i++) {\n\t\tStruct2 light = lights[i];\n\t\tvec4 lp = light.position;\n\t\tvec3 lc = light.color;\n\t\tvec3 ln = light.normal;\n\t\tbool amb = lp.w == 0.0 && dot(ln, ln) == 0.0;\n\t\tif (amb) {\n\t\t\ttotal += ambientLight(lc, color);\n\t\t}\n\t\telse {\n\t\t\tbool dir = lp.w == 0.0;\n\t\t\tif (!dir) {\n\t\t\t\tln = safeNormalize(vPosition - lp.xyz);\n\t\t\t}\n\t\t\tfloat ldot = max(-dot(ln, n), 0.0);\n\t\t\ttotal += directionalLight(lc, ln, eye, n, color);\n\t\t}\n\t}\n\toColor = vec4(total, baseColor.w);\n}";
Ad.N=function(){for(var b={transform:{name:"matrix.transform",type:d.j(4,4)},model:{name:"matrix.model",type:d.j(4,4)},view:{name:"matrix.view",type:d.j(4,4)},Ra:{name:"matrix.projection",type:d.j(4,4)},Ma:{name:"matrix.invProjection",type:d.j(4,4)},Na:{name:"matrix.modelView",type:d.j(4,4)},La:{name:"matrix.invModelView",type:d.j(4,4)},ua:{name:"matrix.normal",type:d.j(3,3)}},a={cd:{name:"material.ambient",type:d.m},qd:{name:"material.diffuse",type:d.m},Pd:{name:"material.specular",type:d.m},Od:{name:"material.shininess",
type:d.m},rd:{name:"material.emission",type:d.m},Ya:{name:"material.texture",type:d.s(t.u)}},c={name:"numLights",type:d.wa},e=[],f=0;16>f;){var g="lights["+f++ +"]";e.push({position:{name:g+".position",type:d.i(4)},color:{name:g+".color",type:d.i(3)},ua:{name:g+".normal",type:d.i(3)}})}return{ya:b,Aa:a,Rb:c,vc:new uc(e,"lights",d.Gc)}}(this);Ad.attributes={Kb:{name:"aPosition",type:n.i(4),location:0},Ib:{name:"aColor",type:n.i(4),location:1},Jb:{name:"aNormal",type:n.i(3),location:2},Lb:{name:"aTexCoord",
type:n.i(2),location:3}};Ad.Yc="#version 300 es\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tmat4 transform;\n\tmat4 model;\n\tmat4 view;\n\tmat4 projection;\n\tmat4 invProjection;\n\tmat4 modelView;\n\tmat4 invModelView;\n\tmat3 normal;\n};\nstruct Struct1 {\n\tfloat ambient;\n\tfloat diffuse;\n\tfloat specular;\n\tfloat shininess;\n\tfloat emission;\n\tsampler2D texture;\n};\nstruct Struct2 {\n\tvec4 position;\n\tvec3 color;\n\tvec3 normal;\n};\n\nlayout(location = 0) in vec4 aPosition;\nlayout(location = 1) in vec4 aColor;\nlayout(location = 2) in vec3 aNormal;\nlayout(location = 3) in vec2 aTexCoord;\nuniform Struct0 matrix;\nuniform Struct1 material;\nuniform int numLights;\nuniform Struct2 lights[16];\nout vec4 vColor;\nout vec3 vPosition;\nout vec3 vNormal;\nout vec2 vTexCoord;\n\nvoid main() {\n\tgl_Position = matrix.transform * aPosition;\n\tgl_PointSize = 1.0;\n\tvColor = aColor;\n\tvPosition = (matrix.modelView * aPosition).xyz;\n\tvNormal = matrix.normal * aNormal;\n\tvTexCoord = aTexCoord;\n}";
Ad.Nc="#version 300 es\nprecision highp int;\nprecision highp float;\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tmat4 transform;\n\tmat4 model;\n\tmat4 view;\n\tmat4 projection;\n\tmat4 invProjection;\n\tmat4 modelView;\n\tmat4 invModelView;\n\tmat3 normal;\n};\nstruct Struct1 {\n\tfloat ambient;\n\tfloat diffuse;\n\tfloat specular;\n\tfloat shininess;\n\tfloat emission;\n\tsampler2D texture;\n};\nstruct Struct2 {\n\tvec4 position;\n\tvec3 color;\n\tvec3 normal;\n};\n\nuniform Struct0 matrix;\nuniform Struct1 material;\nuniform int numLights;\nuniform Struct2 lights[16];\nin vec4 vColor;\nin vec3 vPosition;\nin vec3 vNormal;\nin vec2 vTexCoord;\nlayout(location = 0) out vec4 oColor;\n\nvec4 computeBaseColor() {\n\treturn vec4(texture(material.texture, vTexCoord).xyz * 5.0 + 0.5, 1);\n}\n\nvec3 safeNormalize(vec3 v) {\n\treturn dot(v, v) > 0.0 ? normalize(v) : vec3(0);\n}\n\nvec3 ambientLight(vec3 lightColor, vec3 color) {\n\treturn lightColor * color * material.ambient;\n}\n\nvec3 directionalLight(vec3 lightColor, vec3 lightDirection, vec3 eye, vec3 normal, vec3 color) {\n\tfloat ldot = max(-dot(lightDirection, normal), 0.0);\n\tvec3 res = lightColor * color * ldot * material.diffuse;\n\tif (dot(normal, eye) < 0.0) {\n\t\tvec3 reflEye = eye - 2.0 * normal * dot(eye, normal);\n\t\tfloat rdot = max(-dot(reflEye, lightDirection), 0.0);\n\t\tres += lightColor * pow(rdot, material.shininess) * material.specular;\n\t}\n\treturn res;\n}\n\nvoid main() {\n\tvec4 baseColor = computeBaseColor();\n\tif (baseColor.w == 0.0) {\n\t\tdiscard;\n\t}\n\tif (numLights == 0) {\n\t\toColor = baseColor;\n\t\treturn;\n\t}\n\tvec3 eye = safeNormalize(vPosition);\n\tvec3 n = safeNormalize(vNormal);\n\tif (!gl_FrontFacing) {\n\t\tn = -n;\n\t}\n\tvec3 color = baseColor.xyz;\n\tvec3 total = color * material.emission;\n\tfor (int i = 0; i < numLights; i++) {\n\t\tStruct2 light = lights[i];\n\t\tvec4 lp = light.position;\n\t\tvec3 lc = light.color;\n\t\tvec3 ln = light.normal;\n\t\tbool amb = lp.w == 0.0 && dot(ln, ln) == 0.0;\n\t\tif (amb) {\n\t\t\ttotal += ambientLight(lc, color);\n\t\t}\n\t\telse {\n\t\t\tbool dir = lp.w == 0.0;\n\t\t\tif (!dir) {\n\t\t\t\tln = safeNormalize(vPosition - lp.xyz);\n\t\t\t}\n\t\t\tfloat ldot = max(-dot(ln, n), 0.0);\n\t\t\ttotal += directionalLight(lc, ln, eye, n, color);\n\t\t}\n\t}\n\toColor = vec4(total, baseColor.w);\n}";
Ad.source={Ta:"#version 300 es\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tmat4 transform;\n\tmat4 model;\n\tmat4 view;\n\tmat4 projection;\n\tmat4 invProjection;\n\tmat4 modelView;\n\tmat4 invModelView;\n\tmat3 normal;\n};\nstruct Struct1 {\n\tfloat ambient;\n\tfloat diffuse;\n\tfloat specular;\n\tfloat shininess;\n\tfloat emission;\n\tsampler2D texture;\n};\nstruct Struct2 {\n\tvec4 position;\n\tvec3 color;\n\tvec3 normal;\n};\n\nlayout(location = 0) in vec4 aPosition;\nlayout(location = 1) in vec4 aColor;\nlayout(location = 2) in vec3 aNormal;\nlayout(location = 3) in vec2 aTexCoord;\nuniform Struct0 matrix;\nuniform Struct1 material;\nuniform int numLights;\nuniform Struct2 lights[16];\nout vec4 vColor;\nout vec3 vPosition;\nout vec3 vNormal;\nout vec2 vTexCoord;\n\nvoid main() {\n\tgl_Position = matrix.transform * aPosition;\n\tgl_PointSize = 1.0;\n\tvColor = aColor;\n\tvPosition = (matrix.modelView * aPosition).xyz;\n\tvNormal = matrix.normal * aNormal;\n\tvTexCoord = aTexCoord;\n}",
Ka:"#version 300 es\nprecision highp int;\nprecision highp float;\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tmat4 transform;\n\tmat4 model;\n\tmat4 view;\n\tmat4 projection;\n\tmat4 invProjection;\n\tmat4 modelView;\n\tmat4 invModelView;\n\tmat3 normal;\n};\nstruct Struct1 {\n\tfloat ambient;\n\tfloat diffuse;\n\tfloat specular;\n\tfloat shininess;\n\tfloat emission;\n\tsampler2D texture;\n};\nstruct Struct2 {\n\tvec4 position;\n\tvec3 color;\n\tvec3 normal;\n};\n\nuniform Struct0 matrix;\nuniform Struct1 material;\nuniform int numLights;\nuniform Struct2 lights[16];\nin vec4 vColor;\nin vec3 vPosition;\nin vec3 vNormal;\nin vec2 vTexCoord;\nlayout(location = 0) out vec4 oColor;\n\nvec4 computeBaseColor() {\n\treturn vec4(texture(material.texture, vTexCoord).xyz * 5.0 + 0.5, 1);\n}\n\nvec3 safeNormalize(vec3 v) {\n\treturn dot(v, v) > 0.0 ? normalize(v) : vec3(0);\n}\n\nvec3 ambientLight(vec3 lightColor, vec3 color) {\n\treturn lightColor * color * material.ambient;\n}\n\nvec3 directionalLight(vec3 lightColor, vec3 lightDirection, vec3 eye, vec3 normal, vec3 color) {\n\tfloat ldot = max(-dot(lightDirection, normal), 0.0);\n\tvec3 res = lightColor * color * ldot * material.diffuse;\n\tif (dot(normal, eye) < 0.0) {\n\t\tvec3 reflEye = eye - 2.0 * normal * dot(eye, normal);\n\t\tfloat rdot = max(-dot(reflEye, lightDirection), 0.0);\n\t\tres += lightColor * pow(rdot, material.shininess) * material.specular;\n\t}\n\treturn res;\n}\n\nvoid main() {\n\tvec4 baseColor = computeBaseColor();\n\tif (baseColor.w == 0.0) {\n\t\tdiscard;\n\t}\n\tif (numLights == 0) {\n\t\toColor = baseColor;\n\t\treturn;\n\t}\n\tvec3 eye = safeNormalize(vPosition);\n\tvec3 n = safeNormalize(vNormal);\n\tif (!gl_FrontFacing) {\n\t\tn = -n;\n\t}\n\tvec3 color = baseColor.xyz;\n\tvec3 total = color * material.emission;\n\tfor (int i = 0; i < numLights; i++) {\n\t\tStruct2 light = lights[i];\n\t\tvec4 lp = light.position;\n\t\tvec3 lc = light.color;\n\t\tvec3 ln = light.normal;\n\t\tbool amb = lp.w == 0.0 && dot(ln, ln) == 0.0;\n\t\tif (amb) {\n\t\t\ttotal += ambientLight(lc, color);\n\t\t}\n\t\telse {\n\t\t\tbool dir = lp.w == 0.0;\n\t\t\tif (!dir) {\n\t\t\t\tln = safeNormalize(vPosition - lp.xyz);\n\t\t\t}\n\t\t\tfloat ldot = max(-dot(ln, n), 0.0);\n\t\t\ttotal += directionalLight(lc, ln, eye, n, color);\n\t\t}\n\t}\n\toColor = vec4(total, baseColor.w);\n}"};
zd.N=function(){for(var b={transform:{name:"matrix.transform",type:d.j(4,4)},model:{name:"matrix.model",type:d.j(4,4)},view:{name:"matrix.view",type:d.j(4,4)},Ra:{name:"matrix.projection",type:d.j(4,4)},Ma:{name:"matrix.invProjection",type:d.j(4,4)},Na:{name:"matrix.modelView",type:d.j(4,4)},La:{name:"matrix.invModelView",type:d.j(4,4)},ua:{name:"matrix.normal",type:d.j(3,3)}},a={cd:{name:"material.ambient",type:d.m},qd:{name:"material.diffuse",type:d.m},Pd:{name:"material.specular",type:d.m},Od:{name:"material.shininess",
type:d.m},rd:{name:"material.emission",type:d.m},Ya:{name:"material.texture",type:d.s(t.u)}},c={name:"numLights",type:d.wa},e=[],f=0;16>f;){var g="lights["+f++ +"]";e.push({position:{name:g+".position",type:d.i(4)},color:{name:g+".color",type:d.i(3)},ua:{name:g+".normal",type:d.i(3)}})}return{ya:b,Aa:a,Rb:c,vc:new uc(e,"lights",d.Gc)}}(this);zd.attributes={Kb:{name:"aPosition",type:n.i(4),location:0},Ib:{name:"aColor",type:n.i(4),location:1},Jb:{name:"aNormal",type:n.i(3),location:2},Lb:{name:"aTexCoord",
type:n.i(2),location:3}};zd.Yc="#version 300 es\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tmat4 transform;\n\tmat4 model;\n\tmat4 view;\n\tmat4 projection;\n\tmat4 invProjection;\n\tmat4 modelView;\n\tmat4 invModelView;\n\tmat3 normal;\n};\nstruct Struct1 {\n\tfloat ambient;\n\tfloat diffuse;\n\tfloat specular;\n\tfloat shininess;\n\tfloat emission;\n\tsampler2D texture;\n};\nstruct Struct2 {\n\tvec4 position;\n\tvec3 color;\n\tvec3 normal;\n};\n\nlayout(location = 0) in vec4 aPosition;\nlayout(location = 1) in vec4 aColor;\nlayout(location = 2) in vec3 aNormal;\nlayout(location = 3) in vec2 aTexCoord;\nuniform Struct0 matrix;\nuniform Struct1 material;\nuniform int numLights;\nuniform Struct2 lights[16];\nout vec4 vColor;\nout vec3 vPosition;\nout vec3 vNormal;\nout vec2 vTexCoord;\n\nvoid main() {\n\tgl_Position = matrix.transform * aPosition;\n\tgl_PointSize = 1.0;\n\tvColor = aColor;\n\tvPosition = (matrix.modelView * aPosition).xyz;\n\tvNormal = matrix.normal * aNormal;\n\tvTexCoord = aTexCoord;\n}";
zd.Nc="#version 300 es\nprecision highp int;\nprecision highp float;\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tmat4 transform;\n\tmat4 model;\n\tmat4 view;\n\tmat4 projection;\n\tmat4 invProjection;\n\tmat4 modelView;\n\tmat4 invModelView;\n\tmat3 normal;\n};\nstruct Struct1 {\n\tfloat ambient;\n\tfloat diffuse;\n\tfloat specular;\n\tfloat shininess;\n\tfloat emission;\n\tsampler2D texture;\n};\nstruct Struct2 {\n\tvec4 position;\n\tvec3 color;\n\tvec3 normal;\n};\n\nuniform Struct0 matrix;\nuniform Struct1 material;\nuniform int numLights;\nuniform Struct2 lights[16];\nin vec4 vColor;\nin vec3 vPosition;\nin vec3 vNormal;\nin vec2 vTexCoord;\nlayout(location = 0) out vec4 oColor;\n\nvec4 computeBaseColor() {\n\treturn vec4(texture(material.texture, vTexCoord).www * 5.0 + 0.5, 1);\n}\n\nvec3 safeNormalize(vec3 v) {\n\treturn dot(v, v) > 0.0 ? normalize(v) : vec3(0);\n}\n\nvec3 ambientLight(vec3 lightColor, vec3 color) {\n\treturn lightColor * color * material.ambient;\n}\n\nvec3 directionalLight(vec3 lightColor, vec3 lightDirection, vec3 eye, vec3 normal, vec3 color) {\n\tfloat ldot = max(-dot(lightDirection, normal), 0.0);\n\tvec3 res = lightColor * color * ldot * material.diffuse;\n\tif (dot(normal, eye) < 0.0) {\n\t\tvec3 reflEye = eye - 2.0 * normal * dot(eye, normal);\n\t\tfloat rdot = max(-dot(reflEye, lightDirection), 0.0);\n\t\tres += lightColor * pow(rdot, material.shininess) * material.specular;\n\t}\n\treturn res;\n}\n\nvoid main() {\n\tvec4 baseColor = computeBaseColor();\n\tif (baseColor.w == 0.0) {\n\t\tdiscard;\n\t}\n\tif (numLights == 0) {\n\t\toColor = baseColor;\n\t\treturn;\n\t}\n\tvec3 eye = safeNormalize(vPosition);\n\tvec3 n = safeNormalize(vNormal);\n\tif (!gl_FrontFacing) {\n\t\tn = -n;\n\t}\n\tvec3 color = baseColor.xyz;\n\tvec3 total = color * material.emission;\n\tfor (int i = 0; i < numLights; i++) {\n\t\tStruct2 light = lights[i];\n\t\tvec4 lp = light.position;\n\t\tvec3 lc = light.color;\n\t\tvec3 ln = light.normal;\n\t\tbool amb = lp.w == 0.0 && dot(ln, ln) == 0.0;\n\t\tif (amb) {\n\t\t\ttotal += ambientLight(lc, color);\n\t\t}\n\t\telse {\n\t\t\tbool dir = lp.w == 0.0;\n\t\t\tif (!dir) {\n\t\t\t\tln = safeNormalize(vPosition - lp.xyz);\n\t\t\t}\n\t\t\tfloat ldot = max(-dot(ln, n), 0.0);\n\t\t\ttotal += directionalLight(lc, ln, eye, n, color);\n\t\t}\n\t}\n\toColor = vec4(total, baseColor.w);\n}";
zd.source={Ta:"#version 300 es\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tmat4 transform;\n\tmat4 model;\n\tmat4 view;\n\tmat4 projection;\n\tmat4 invProjection;\n\tmat4 modelView;\n\tmat4 invModelView;\n\tmat3 normal;\n};\nstruct Struct1 {\n\tfloat ambient;\n\tfloat diffuse;\n\tfloat specular;\n\tfloat shininess;\n\tfloat emission;\n\tsampler2D texture;\n};\nstruct Struct2 {\n\tvec4 position;\n\tvec3 color;\n\tvec3 normal;\n};\n\nlayout(location = 0) in vec4 aPosition;\nlayout(location = 1) in vec4 aColor;\nlayout(location = 2) in vec3 aNormal;\nlayout(location = 3) in vec2 aTexCoord;\nuniform Struct0 matrix;\nuniform Struct1 material;\nuniform int numLights;\nuniform Struct2 lights[16];\nout vec4 vColor;\nout vec3 vPosition;\nout vec3 vNormal;\nout vec2 vTexCoord;\n\nvoid main() {\n\tgl_Position = matrix.transform * aPosition;\n\tgl_PointSize = 1.0;\n\tvColor = aColor;\n\tvPosition = (matrix.modelView * aPosition).xyz;\n\tvNormal = matrix.normal * aNormal;\n\tvTexCoord = aTexCoord;\n}",
Ka:"#version 300 es\nprecision highp int;\nprecision highp float;\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tmat4 transform;\n\tmat4 model;\n\tmat4 view;\n\tmat4 projection;\n\tmat4 invProjection;\n\tmat4 modelView;\n\tmat4 invModelView;\n\tmat3 normal;\n};\nstruct Struct1 {\n\tfloat ambient;\n\tfloat diffuse;\n\tfloat specular;\n\tfloat shininess;\n\tfloat emission;\n\tsampler2D texture;\n};\nstruct Struct2 {\n\tvec4 position;\n\tvec3 color;\n\tvec3 normal;\n};\n\nuniform Struct0 matrix;\nuniform Struct1 material;\nuniform int numLights;\nuniform Struct2 lights[16];\nin vec4 vColor;\nin vec3 vPosition;\nin vec3 vNormal;\nin vec2 vTexCoord;\nlayout(location = 0) out vec4 oColor;\n\nvec4 computeBaseColor() {\n\treturn vec4(texture(material.texture, vTexCoord).www * 5.0 + 0.5, 1);\n}\n\nvec3 safeNormalize(vec3 v) {\n\treturn dot(v, v) > 0.0 ? normalize(v) : vec3(0);\n}\n\nvec3 ambientLight(vec3 lightColor, vec3 color) {\n\treturn lightColor * color * material.ambient;\n}\n\nvec3 directionalLight(vec3 lightColor, vec3 lightDirection, vec3 eye, vec3 normal, vec3 color) {\n\tfloat ldot = max(-dot(lightDirection, normal), 0.0);\n\tvec3 res = lightColor * color * ldot * material.diffuse;\n\tif (dot(normal, eye) < 0.0) {\n\t\tvec3 reflEye = eye - 2.0 * normal * dot(eye, normal);\n\t\tfloat rdot = max(-dot(reflEye, lightDirection), 0.0);\n\t\tres += lightColor * pow(rdot, material.shininess) * material.specular;\n\t}\n\treturn res;\n}\n\nvoid main() {\n\tvec4 baseColor = computeBaseColor();\n\tif (baseColor.w == 0.0) {\n\t\tdiscard;\n\t}\n\tif (numLights == 0) {\n\t\toColor = baseColor;\n\t\treturn;\n\t}\n\tvec3 eye = safeNormalize(vPosition);\n\tvec3 n = safeNormalize(vNormal);\n\tif (!gl_FrontFacing) {\n\t\tn = -n;\n\t}\n\tvec3 color = baseColor.xyz;\n\tvec3 total = color * material.emission;\n\tfor (int i = 0; i < numLights; i++) {\n\t\tStruct2 light = lights[i];\n\t\tvec4 lp = light.position;\n\t\tvec3 lc = light.color;\n\t\tvec3 ln = light.normal;\n\t\tbool amb = lp.w == 0.0 && dot(ln, ln) == 0.0;\n\t\tif (amb) {\n\t\t\ttotal += ambientLight(lc, color);\n\t\t}\n\t\telse {\n\t\t\tbool dir = lp.w == 0.0;\n\t\t\tif (!dir) {\n\t\t\t\tln = safeNormalize(vPosition - lp.xyz);\n\t\t\t}\n\t\t\tfloat ldot = max(-dot(ln, n), 0.0);\n\t\t\ttotal += directionalLight(lc, ln, eye, n, color);\n\t\t}\n\t}\n\toColor = vec4(total, baseColor.w);\n}"};
Ic.Ba=!1;N.qh={bc:18,nc:18,ac:18,cc:128,oc:128,Ea:.5,Fc:1,Zd:1.5,xb:256,Eb:128,$a:32,pb:32,ob:32,Fb:18,Cc:3};N.xh={bc:24,nc:24,ac:24,cc:128,oc:256,Ea:.5,Fc:1,Zd:1.5,xb:256,Eb:128,$a:32,pb:32,ob:32,Fb:24,Cc:2};N.pf={bc:32,nc:32,ac:32,cc:128,oc:256,Ea:.5,Fc:1,Zd:1.5,xb:256,Eb:128,$a:32,pb:32,ob:32,Fb:32,Cc:2};N.Oh={bc:48,nc:48,ac:48,cc:256,oc:512,Ea:.5,Fc:1,Zd:1.5,xb:512,Eb:512,$a:64,pb:64,ob:64,Fb:48,Cc:2};Ze.Fa={PI:3.141592653589793,sg:3,ai:3};ib.N=function(){var b=[];b.push({name:"ctex.tex[0]",type:d.s(t.u)});
b.push({name:"ctex.tex[1]",type:d.s(t.u)});b.push({name:"ctex.tex[2]",type:d.s(t.u)});return{gb:{name:"dt",type:d.m},ya:{transform:{name:"matrix.transform",type:d.j(4,4)},model:{name:"matrix.model",type:d.j(4,4)},view:{name:"matrix.view",type:d.j(4,4)},Ra:{name:"matrix.projection",type:d.j(4,4)},Ma:{name:"matrix.invProjection",type:d.j(4,4)},Na:{name:"matrix.modelView",type:d.j(4,4)},La:{name:"matrix.invModelView",type:d.j(4,4)},ua:{name:"matrix.normal",type:d.j(3,3)}},la:{mb:new uc(b,"ctex.tex",
d.s(t.u)),Ga:{name:"ctex.sdfTex",type:d.s(t.u)}},Da:{name:"depthTex",type:d.s(t.u)},Ia:{name:"colorTex",type:d.s(t.u)},cb:{ib:{name:"pdata.initialVolume",type:d.m},jb:{name:"pdata.particleSize",type:d.m}},Va:{R:{name:"r2d.res",type:d.l(2)},O:{name:"r2d.invRes",type:d.i(2)},P:{name:"r2d.mask",type:d.l(2)},shift:{name:"r2d.shift",type:d.l(2)}},Xa:{R:{name:"r3d.res",type:d.l(3)},O:{name:"r3d.invRes",type:d.i(3)},P:{name:"r3d.mask",type:d.l(3)},shift:{name:"r3d.shift",type:d.l(3)}},Wa:{R:{name:"r2dm.res",
type:d.l(2)},O:{name:"r2dm.invRes",type:d.i(2)},P:{name:"r2dm.mask",type:d.l(2)},shift:{name:"r2dm.shift",type:d.l(2)}},rb:{name:"colorVec",type:d.i(3)},qb:{name:"boxCenter",type:d.i(3)}}}(this);Rc.Fa={Sf:0,lg:1,$f:2};Rc.N=function(){var b=[];b.push({name:"ctex.tex[0]",type:d.s(t.u)});b.push({name:"ctex.tex[1]",type:d.s(t.u)});b.push({name:"ctex.tex[2]",type:d.s(t.u)});return{gb:{name:"dt",type:d.m},ya:{transform:{name:"matrix.transform",type:d.j(4,4)},model:{name:"matrix.model",type:d.j(4,4)},view:{name:"matrix.view",
type:d.j(4,4)},Ra:{name:"matrix.projection",type:d.j(4,4)},Ma:{name:"matrix.invProjection",type:d.j(4,4)},Na:{name:"matrix.modelView",type:d.j(4,4)},La:{name:"matrix.invModelView",type:d.j(4,4)},ua:{name:"matrix.normal",type:d.j(3,3)}},la:{mb:new uc(b,"ctex.tex",d.s(t.u)),Ga:{name:"ctex.sdfTex",type:d.s(t.u)}},Da:{name:"depthTex",type:d.s(t.u)},Ia:{name:"colorTex",type:d.s(t.u)},cb:{ib:{name:"pdata.initialVolume",type:d.m},jb:{name:"pdata.particleSize",type:d.m}},Va:{R:{name:"r2d.res",type:d.l(2)},
O:{name:"r2d.invRes",type:d.i(2)},P:{name:"r2d.mask",type:d.l(2)},shift:{name:"r2d.shift",type:d.l(2)}},Xa:{R:{name:"r3d.res",type:d.l(3)},O:{name:"r3d.invRes",type:d.i(3)},P:{name:"r3d.mask",type:d.l(3)},shift:{name:"r3d.shift",type:d.l(3)}},Wa:{R:{name:"r2dm.res",type:d.l(2)},O:{name:"r2dm.invRes",type:d.i(2)},P:{name:"r2dm.mask",type:d.l(2)},shift:{name:"r2dm.shift",type:d.l(2)}},rb:{name:"colorVec",type:d.i(3)},qb:{name:"boxCenter",type:d.i(3)},mode:{name:"mode",type:d.wa},size:{name:"size",type:d.m}}}(this);
Rc.source={Ta:"#version 300 es\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tmat4 transform;\n\tmat4 model;\n\tmat4 view;\n\tmat4 projection;\n\tmat4 invProjection;\n\tmat4 modelView;\n\tmat4 invModelView;\n\tmat3 normal;\n};\nstruct Struct1 {\n\tsampler2D tex[3];\n\tsampler2D sdfTex;\n};\nstruct Struct2 {\n\tfloat initialVolume;\n\tfloat particleSize;\n};\nstruct Struct3 {\n\tivec2 res;\n\tvec2 invRes;\n\tivec2 mask;\n\tivec2 shift;\n};\nstruct Struct4 {\n\tivec3 res;\n\tvec3 invRes;\n\tivec3 mask;\n\tivec3 shift;\n};\n\nlayout(location = 0) in vec4 aPosition;\nlayout(location = 1) in vec4 aColor;\nlayout(location = 2) in vec4 aNormal;\nlayout(location = 3) in vec2 aTexCoord;\nuniform float dt;\nuniform Struct0 matrix;\nuniform Struct1 ctex;\nuniform sampler2D depthTex;\nuniform sampler2D colorTex;\nuniform Struct2 pdata;\nuniform Struct3 r2d;\nuniform Struct4 r3d;\nuniform Struct3 r2dm;\nout vec2 vTexCoord;\nuniform vec3 colorVec;\nuniform vec3 boxCenter;\nuniform int mode;\nuniform float size;\n\nvoid main() {\n\tgl_Position = matrix.transform * aPosition;\n\tvTexCoord = aTexCoord;\n}",
Ka:"#version 300 es\nprecision highp int;\nprecision highp float;\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tmat4 transform;\n\tmat4 model;\n\tmat4 view;\n\tmat4 projection;\n\tmat4 invProjection;\n\tmat4 modelView;\n\tmat4 invModelView;\n\tmat3 normal;\n};\nstruct Struct1 {\n\tsampler2D tex[3];\n\tsampler2D sdfTex;\n};\nstruct Struct2 {\n\tfloat initialVolume;\n\tfloat particleSize;\n};\nstruct Struct3 {\n\tivec2 res;\n\tvec2 invRes;\n\tivec2 mask;\n\tivec2 shift;\n};\nstruct Struct4 {\n\tivec3 res;\n\tvec3 invRes;\n\tivec3 mask;\n\tivec3 shift;\n};\n\nuniform float dt;\nuniform Struct0 matrix;\nuniform Struct1 ctex;\nuniform sampler2D depthTex;\nuniform sampler2D colorTex;\nuniform Struct2 pdata;\nuniform Struct3 r2d;\nuniform Struct4 r3d;\nuniform Struct3 r2dm;\nin vec2 vTexCoord;\nuniform vec3 colorVec;\nuniform vec3 boxCenter;\nuniform int mode;\nuniform float size;\nlayout(location = 0) out vec4 oColor;\n\nivec2 toIndex2D(Struct3 r2d, vec2 coord) {\n\treturn ivec2(vec2(r2d.res) * fract(coord)) & r2d.mask;\n}\n\nint toIndex(Struct3 r2d, ivec2 i2d) {\n\tivec2 index = (i2d & r2d.mask) << r2d.shift;\n\treturn index.x | index.y;\n}\n\nint toIndex(Struct3 r2d, vec2 coord) {\n\treturn toIndex(r2d, toIndex2D(r2d, coord));\n}\n\nivec3 toIndex3D(Struct4 r3d, int index) {\n\treturn ivec3(index) >> r3d.shift & r3d.mask;\n}\n\nivec3 toIndex3D(Struct3 r2d, Struct4 r3d, vec2 coord) {\n\treturn toIndex3D(r3d, toIndex(r2d, coord));\n}\n\nfloat box(vec3 halfExtents, vec3 p) {\n\tvec3 q = abs(p) - halfExtents;\n\treturn length(max(q, 0.0)) + min(0.0, max(q.x, max(q.y, q.z)));\n}\n\nfloat distTank(vec3 min, vec3 max, float radius, vec3 p) {\n\tmin += radius;\n\tmax -= radius;\n\tvec3 mid = (min + max) * 0.5;\n\tvec3 hext = (max - min) * 0.5;\n\treturn -box(hext, p - mid) + radius;\n}\n\nfloat sdfBox(Struct4 r3d, float size, vec3 p) {\n\tvec3 WALL_THICKNESS = 1.0 + (vec3(r3d.res) - size) * 0.5;\n\tvec3 aabbMin = vec3(WALL_THICKNESS);\n\tvec3 aabbMax = vec3(r3d.res) - vec3(WALL_THICKNESS);\n\treturn distTank(aabbMin, aabbMax, 1.0, p);\n}\n\nfloat hg_anon_0(vec3 p) {\n\treturn sdfBox(r3d, size, p);\n}\n\nvec3 normal(int hg_dummyArg_0, vec3 p) {\n\tvec3 n = vec3(hg_anon_0(p + vec3(0.01, 0, 0)) - hg_anon_0(p - vec3(0.01, 0, 0)), hg_anon_0(p + vec3(0, 0.01, 0)) - hg_anon_0(p - vec3(0, 0.01, 0)), hg_anon_0(p + vec3(0, 0, 0.01)) - hg_anon_0(p - vec3(0, 0, 0.01)));\n\tfloat len2 = dot(n, n);\n\treturn len2 > 0.0 ? n * inversesqrt(len2) : vec3(0);\n}\n\nvec4 computeColor(int hg_dummyArg_0, vec3 p) {\n\treturn vec4(normal(0, p), sdfBox(r3d, size, p));\n}\n\nfloat sdfSphere(Struct4 r3d, float size, vec3 p) {\n\treturn size * 0.5 - 1.0 - length(p - 0.5 * vec3(r3d.res));\n}\n\nfloat hg_anon_1(vec3 p) {\n\treturn sdfSphere(r3d, size, p);\n}\n\nvec3 hg_normal_(int hg_dummyArg_0, vec3 p) {\n\tvec3 n = vec3(hg_anon_1(p + vec3(0.01, 0, 0)) - hg_anon_1(p - vec3(0.01, 0, 0)), hg_anon_1(p + vec3(0, 0.01, 0)) - hg_anon_1(p - vec3(0, 0.01, 0)), hg_anon_1(p + vec3(0, 0, 0.01)) - hg_anon_1(p - vec3(0, 0, 0.01)));\n\tfloat len2 = dot(n, n);\n\treturn len2 > 0.0 ? n * inversesqrt(len2) : vec3(0);\n}\n\nvec4 hg_computeColor_(int hg_dummyArg_0, vec3 p) {\n\treturn vec4(hg_normal_(0, p), sdfSphere(r3d, size, p));\n}\n\nfloat cylinder(vec3 a, vec3 b, float r, vec3 p) {\n\tvec3 ba = b - a;\n\tvec3 pa = p - a;\n\tfloat baba = dot(ba, ba);\n\tfloat paba = dot(pa, ba);\n\tfloat x = length(pa * baba - ba * paba) - r * baba;\n\tfloat y = abs(paba - baba * 0.5) - baba * 0.5;\n\tfloat x2 = x * x;\n\tfloat y2 = y * y * baba;\n\tfloat d = max(x, y) < 0.0 ? -min(x2, y2) : (x > 0.0 ? x2 : 0.0) + (y > 0.0 ? y2 : 0.0);\n\treturn sign(d) * sqrt(abs(d)) / baba;\n}\n\nfloat sdfCylinder(Struct4 r3d, float size, vec3 p) {\n\tvec3 center = vec3(r3d.res) * 0.5;\n\tvec3 y = vec3(0, size * 0.5 - 1.0, 0);\n\treturn -cylinder(center + y, center - y, size * 0.5 - 1.0, p);\n}\n\nfloat hg_anon_2(vec3 p) {\n\treturn sdfCylinder(r3d, size, p);\n}\n\nvec3 hg_normal_0(int hg_dummyArg_0, vec3 p) {\n\tvec3 n = vec3(hg_anon_2(p + vec3(0.01, 0, 0)) - hg_anon_2(p - vec3(0.01, 0, 0)), hg_anon_2(p + vec3(0, 0.01, 0)) - hg_anon_2(p - vec3(0, 0.01, 0)), hg_anon_2(p + vec3(0, 0, 0.01)) - hg_anon_2(p - vec3(0, 0, 0.01)));\n\tfloat len2 = dot(n, n);\n\treturn len2 > 0.0 ? n * inversesqrt(len2) : vec3(0);\n}\n\nvec4 hg_computeColor_0(int hg_dummyArg_0, vec3 p) {\n\treturn vec4(hg_normal_0(0, p), sdfCylinder(r3d, size, p));\n}\n\nvoid main() {\n\tivec3 i3d = toIndex3D(r2d, r3d, vTexCoord);\n\tvec3 pos = vec3(i3d) + 0.5;\n\tswitch (mode) {\n\tcase 0:\n\t\t{\n\t\t\toColor = computeColor(0, pos);\n\t\t}\n\t\tbreak;\n\tcase 1:\n\t\t{\n\t\t\toColor = hg_computeColor_(0, pos);\n\t\t}\n\t\tbreak;\n\tcase 2:\n\t\t{\n\t\t\toColor = hg_computeColor_0(0, pos);\n\t\t}\n\t\tbreak;\n\t}\n}"};
hd.attributes={Cd:{name:"ipos",type:n.i(3),location:0},Ed:{name:"ivel",type:n.i(3),location:1},Ad:{name:"imass",type:n.m,location:2},wd:{name:"igvel0",type:n.i(3),location:3},xd:{name:"igvel1",type:n.i(3),location:4},yd:{name:"igvel2",type:n.i(3),location:5},zd:{name:"ijacobian",type:n.m,location:6},vd:{name:"idensity",type:n.m,location:7},ud:{name:"iaeration",type:n.m,location:8},Fd:{name:"iweightsX",type:n.i(3),location:9},Gd:{name:"iweightsY",type:n.i(3),location:10},Hd:{name:"iweightsZ",type:n.i(3),
location:11},Dd:{name:"irand",type:n.i(3),location:12}};Oe.attributes={Cd:{name:"ipos",type:n.i(3),location:0},Ed:{name:"ivel",type:n.i(3),location:1},Ad:{name:"imass",type:n.m,location:2},wd:{name:"igvel0",type:n.i(3),location:3},xd:{name:"igvel1",type:n.i(3),location:4},yd:{name:"igvel2",type:n.i(3),location:5},zd:{name:"ijacobian",type:n.m,location:6},vd:{name:"idensity",type:n.m,location:7},ud:{name:"iaeration",type:n.m,location:8},Fd:{name:"iweightsX",type:n.i(3),location:9},Gd:{name:"iweightsY",
type:n.i(3),location:10},Hd:{name:"iweightsZ",type:n.i(3),location:11},Dd:{name:"irand",type:n.i(3),location:12}};Oe.source={Ta:"#version 300 es\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tsampler2D tex[3];\n\tsampler2D sdfTex;\n};\nstruct Struct1 {\n\tfloat initialVolume;\n\tfloat particleSize;\n};\nstruct Struct2 {\n\tivec2 res;\n\tvec2 invRes;\n\tivec2 mask;\n\tivec2 shift;\n};\nstruct Struct3 {\n\tivec3 res;\n\tvec3 invRes;\n\tivec3 mask;\n\tivec3 shift;\n};\n\nuniform float dt;\nuniform Struct0 ctex;\nuniform Struct1 pdata;\nuniform Struct2 r2d;\nuniform Struct3 r3d;\nlayout(location = 0) in vec3 ipos;\nlayout(location = 1) in vec3 ivel;\nlayout(location = 2) in float imass;\nlayout(location = 3) in vec3 igvel0;\nlayout(location = 4) in vec3 igvel1;\nlayout(location = 5) in vec3 igvel2;\nlayout(location = 6) in float ijacobian;\nlayout(location = 7) in float idensity;\nlayout(location = 8) in float iaeration;\nlayout(location = 9) in vec3 iweightsX;\nlayout(location = 10) in vec3 iweightsY;\nlayout(location = 11) in vec3 iweightsZ;\nlayout(location = 12) in vec3 irand;\nout vec3 pos;\nout vec3 vel;\nout float mass;\nout vec3 gvel0;\nout vec3 gvel1;\nout vec3 gvel2;\nout float jacobian;\nout float density;\nout float aeration;\nout vec3 weightsX;\nout vec3 weightsY;\nout vec3 weightsZ;\nout vec3 rand;\n\nvoid copyAll() {\n\tpos = ipos;\n\tvel = ivel;\n\tmass = imass;\n\tgvel0 = igvel0;\n\tgvel1 = igvel1;\n\tgvel2 = igvel2;\n\tjacobian = ijacobian;\n\tdensity = idensity;\n\taeration = iaeration;\n\tweightsX = iweightsX;\n\tweightsY = iweightsY;\n\tweightsZ = iweightsZ;\n\trand = irand;\n}\n\nvec3 weights(float x) {\n\treturn vec3(0.5 * (x - 0.5) * (x - 0.5), 0.75 - x * x, 0.5 * (x + 0.5) * (x + 0.5));\n}\n\nvoid main() {\n\tcopyAll();\n\tvec3 fpos = fract(pos) - 0.5;\n\tweightsX = weights(fpos.x);\n\tweightsY = weights(fpos.y);\n\tweightsZ = weights(fpos.z);\n}",
Ka:"#version 300 es\nprecision highp int;\nprecision highp float;\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tsampler2D tex[3];\n\tsampler2D sdfTex;\n};\nstruct Struct1 {\n\tfloat initialVolume;\n\tfloat particleSize;\n};\nstruct Struct2 {\n\tivec2 res;\n\tvec2 invRes;\n\tivec2 mask;\n\tivec2 shift;\n};\nstruct Struct3 {\n\tivec3 res;\n\tvec3 invRes;\n\tivec3 mask;\n\tivec3 shift;\n};\n\nuniform float dt;\nuniform Struct0 ctex;\nuniform Struct1 pdata;\nuniform Struct2 r2d;\nuniform Struct3 r3d;\nin vec3 pos;\nin vec3 vel;\nin float mass;\nin vec3 gvel0;\nin vec3 gvel1;\nin vec3 gvel2;\nin float jacobian;\nin float density;\nin float aeration;\nin vec3 weightsX;\nin vec3 weightsY;\nin vec3 weightsZ;\nin vec3 rand;\n\nvoid main() {\n}"};
Od.N=function(){var b=[];b.push({name:"ctex.tex[0]",type:d.s(t.u)});b.push({name:"ctex.tex[1]",type:d.s(t.u)});b.push({name:"ctex.tex[2]",type:d.s(t.u)});return{gb:{name:"dt",type:d.m},ya:{transform:{name:"matrix.transform",type:d.j(4,4)},model:{name:"matrix.model",type:d.j(4,4)},view:{name:"matrix.view",type:d.j(4,4)},Ra:{name:"matrix.projection",type:d.j(4,4)},Ma:{name:"matrix.invProjection",type:d.j(4,4)},Na:{name:"matrix.modelView",type:d.j(4,4)},La:{name:"matrix.invModelView",type:d.j(4,4)},
ua:{name:"matrix.normal",type:d.j(3,3)}},la:{mb:new uc(b,"ctex.tex",d.s(t.u)),Ga:{name:"ctex.sdfTex",type:d.s(t.u)}},Da:{name:"depthTex",type:d.s(t.u)},Ia:{name:"colorTex",type:d.s(t.u)},cb:{ib:{name:"pdata.initialVolume",type:d.m},jb:{name:"pdata.particleSize",type:d.m}},Va:{R:{name:"r2d.res",type:d.l(2)},O:{name:"r2d.invRes",type:d.i(2)},P:{name:"r2d.mask",type:d.l(2)},shift:{name:"r2d.shift",type:d.l(2)}},Xa:{R:{name:"r3d.res",type:d.l(3)},O:{name:"r3d.invRes",type:d.i(3)},P:{name:"r3d.mask",type:d.l(3)},
shift:{name:"r3d.shift",type:d.l(3)}},Wa:{R:{name:"r2dm.res",type:d.l(2)},O:{name:"r2dm.invRes",type:d.i(2)},P:{name:"r2dm.mask",type:d.l(2)},shift:{name:"r2dm.shift",type:d.l(2)}},rb:{name:"colorVec",type:d.i(3)},qb:{name:"boxCenter",type:d.i(3)}}}(this);Od.attributes={Kb:{name:"aPosition",type:n.i(4),location:0},Ib:{name:"aColor",type:n.i(4),location:1},Jb:{name:"aNormal",type:n.i(4),location:2},Lb:{name:"aTexCoord",type:n.i(2),location:3},fc:{name:"ppos",type:n.i(3),location:4},De:{name:"pmass",
type:n.m,location:5},Oe:{name:"weightsX",type:n.i(3),location:6},Pe:{name:"weightsY",type:n.i(3),location:7},Qe:{name:"weightsZ",type:n.i(3),location:8}};Od.source={Ta:"#version 300 es\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tivec2 res;\n\tvec2 invRes;\n\tivec2 mask;\n\tivec2 shift;\n};\nstruct Struct1 {\n\tivec3 res;\n\tvec3 invRes;\n\tivec3 mask;\n\tivec3 shift;\n};\nstruct Struct2 {\n\tmat4 transform;\n\tmat4 model;\n\tmat4 view;\n\tmat4 projection;\n\tmat4 invProjection;\n\tmat4 modelView;\n\tmat4 invModelView;\n\tmat3 normal;\n};\nstruct Struct3 {\n\tsampler2D tex[3];\n\tsampler2D sdfTex;\n};\nstruct Struct4 {\n\tfloat initialVolume;\n\tfloat particleSize;\n};\n\nlayout(location = 0) in vec4 aPosition;\nlayout(location = 1) in vec4 aColor;\nlayout(location = 2) in vec4 aNormal;\nlayout(location = 3) in vec2 aTexCoord;\nuniform float dt;\nuniform Struct2 matrix;\nuniform Struct3 ctex;\nuniform sampler2D depthTex;\nuniform sampler2D colorTex;\nuniform Struct4 pdata;\nuniform Struct0 r2d;\nuniform Struct1 r3d;\nuniform Struct0 r2dm;\nout vec2 vTexCoord;\nuniform vec3 colorVec;\nuniform vec3 boxCenter;\nlayout(location = 4) in vec3 ppos;\nlayout(location = 5) in float pmass;\nlayout(location = 6) in vec3 weightsX;\nlayout(location = 7) in vec3 weightsY;\nlayout(location = 8) in vec3 weightsZ;\nout vec4 vColors[3];\n\nint toIndex(Struct1 r3d, ivec3 i3d) {\n\tivec3 index = (i3d & r3d.mask) << r3d.shift;\n\treturn index.x | index.y | index.z;\n}\n\nivec2 toIndex2D(Struct0 r2d, int index) {\n\treturn ivec2(index) >> r2d.shift & r2d.mask;\n}\n\nivec2 toIndex2D(Struct0 r2d, Struct1 r3d, ivec3 i3d) {\n\treturn toIndex2D(r2d, toIndex(r3d, i3d));\n}\n\nvoid main() {\n\tivec3 ipos = ivec3(aPosition);\n\tfloat base = pmass * weightsX[ipos.x + 1] * 100.0;\n\tvColors[0] = vec4(base * weightsY * weightsZ[0], 0);\n\tvColors[1] = vec4(base * weightsY * weightsZ[1], 0);\n\tvColors[2] = vec4(base * weightsY * weightsZ[2], 0);\n\tivec3 ci3d = ivec3(floor(ppos)) + ipos;\n\tivec2 ci2d = toIndex2D(r2d, r3d, ci3d);\n\tgl_Position = vec4((vec2(ci2d) + 0.5) * r2d.invRes * 2.0 - 1.0, 0, 1);\n\tgl_PointSize = 1.0;\n}",
Ka:"#version 300 es\nprecision highp int;\nprecision highp float;\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tivec2 res;\n\tvec2 invRes;\n\tivec2 mask;\n\tivec2 shift;\n};\nstruct Struct1 {\n\tivec3 res;\n\tvec3 invRes;\n\tivec3 mask;\n\tivec3 shift;\n};\nstruct Struct2 {\n\tmat4 transform;\n\tmat4 model;\n\tmat4 view;\n\tmat4 projection;\n\tmat4 invProjection;\n\tmat4 modelView;\n\tmat4 invModelView;\n\tmat3 normal;\n};\nstruct Struct3 {\n\tsampler2D tex[3];\n\tsampler2D sdfTex;\n};\nstruct Struct4 {\n\tfloat initialVolume;\n\tfloat particleSize;\n};\n\nuniform float dt;\nuniform Struct2 matrix;\nuniform Struct3 ctex;\nuniform sampler2D depthTex;\nuniform sampler2D colorTex;\nuniform Struct4 pdata;\nuniform Struct0 r2d;\nuniform Struct1 r3d;\nuniform Struct0 r2dm;\nin vec2 vTexCoord;\nuniform vec3 colorVec;\nuniform vec3 boxCenter;\nin vec4 vColors[3];\nlayout(location = 0) out vec4 oColors[3];\n\nvoid main() {\n\toColors = vColors;\n}"};
Ne.N=function(){var b=[];b.push({name:"ctex.tex[0]",type:d.s(t.u)});b.push({name:"ctex.tex[1]",type:d.s(t.u)});b.push({name:"ctex.tex[2]",type:d.s(t.u)});return{gb:{name:"dt",type:d.m},ya:{transform:{name:"matrix.transform",type:d.j(4,4)},model:{name:"matrix.model",type:d.j(4,4)},view:{name:"matrix.view",type:d.j(4,4)},Ra:{name:"matrix.projection",type:d.j(4,4)},Ma:{name:"matrix.invProjection",type:d.j(4,4)},Na:{name:"matrix.modelView",type:d.j(4,4)},La:{name:"matrix.invModelView",type:d.j(4,4)},
ua:{name:"matrix.normal",type:d.j(3,3)}},la:{mb:new uc(b,"ctex.tex",d.s(t.u)),Ga:{name:"ctex.sdfTex",type:d.s(t.u)}},Da:{name:"depthTex",type:d.s(t.u)},Ia:{name:"colorTex",type:d.s(t.u)},cb:{ib:{name:"pdata.initialVolume",type:d.m},jb:{name:"pdata.particleSize",type:d.m}},Va:{R:{name:"r2d.res",type:d.l(2)},O:{name:"r2d.invRes",type:d.i(2)},P:{name:"r2d.mask",type:d.l(2)},shift:{name:"r2d.shift",type:d.l(2)}},Xa:{R:{name:"r3d.res",type:d.l(3)},O:{name:"r3d.invRes",type:d.i(3)},P:{name:"r3d.mask",type:d.l(3)},
shift:{name:"r3d.shift",type:d.l(3)}},Wa:{R:{name:"r2dm.res",type:d.l(2)},O:{name:"r2dm.invRes",type:d.i(2)},P:{name:"r2dm.mask",type:d.l(2)},shift:{name:"r2dm.shift",type:d.l(2)}},rb:{name:"colorVec",type:d.i(3)},qb:{name:"boxCenter",type:d.i(3)}}}(this);Ne.source={Ta:"#version 300 es\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tmat4 transform;\n\tmat4 model;\n\tmat4 view;\n\tmat4 projection;\n\tmat4 invProjection;\n\tmat4 modelView;\n\tmat4 invModelView;\n\tmat3 normal;\n};\nstruct Struct1 {\n\tsampler2D tex[3];\n\tsampler2D sdfTex;\n};\nstruct Struct2 {\n\tfloat initialVolume;\n\tfloat particleSize;\n};\nstruct Struct3 {\n\tivec2 res;\n\tvec2 invRes;\n\tivec2 mask;\n\tivec2 shift;\n};\nstruct Struct4 {\n\tivec3 res;\n\tvec3 invRes;\n\tivec3 mask;\n\tivec3 shift;\n};\nstruct Struct5 {\n\tvec3 momentum;\n\tfloat mass;\n\tvec3 vel;\n};\n\nlayout(location = 0) in vec4 aPosition;\nlayout(location = 1) in vec4 aColor;\nlayout(location = 2) in vec4 aNormal;\nlayout(location = 3) in vec2 aTexCoord;\nuniform float dt;\nuniform Struct0 matrix;\nuniform Struct1 ctex;\nuniform sampler2D depthTex;\nuniform sampler2D colorTex;\nuniform Struct2 pdata;\nuniform Struct3 r2d;\nuniform Struct4 r3d;\nuniform Struct3 r2dm;\nout vec2 vTexCoord;\nuniform vec3 colorVec;\nuniform vec3 boxCenter;\nStruct5 c;\nivec3 i3d;\n\nvoid main() {\n\tgl_Position = matrix.transform * aPosition;\n\tvTexCoord = aTexCoord;\n}",
Ka:"#version 300 es\nprecision highp int;\nprecision highp float;\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tmat4 transform;\n\tmat4 model;\n\tmat4 view;\n\tmat4 projection;\n\tmat4 invProjection;\n\tmat4 modelView;\n\tmat4 invModelView;\n\tmat3 normal;\n};\nstruct Struct1 {\n\tsampler2D tex[3];\n\tsampler2D sdfTex;\n};\nstruct Struct2 {\n\tfloat initialVolume;\n\tfloat particleSize;\n};\nstruct Struct3 {\n\tivec2 res;\n\tvec2 invRes;\n\tivec2 mask;\n\tivec2 shift;\n};\nstruct Struct4 {\n\tivec3 res;\n\tvec3 invRes;\n\tivec3 mask;\n\tivec3 shift;\n};\nstruct Struct5 {\n\tvec3 momentum;\n\tfloat mass;\n\tvec3 vel;\n};\n\nuniform float dt;\nuniform Struct0 matrix;\nuniform Struct1 ctex;\nuniform sampler2D depthTex;\nuniform sampler2D colorTex;\nuniform Struct2 pdata;\nuniform Struct3 r2d;\nuniform Struct4 r3d;\nuniform Struct3 r2dm;\nin vec2 vTexCoord;\nuniform vec3 colorVec;\nuniform vec3 boxCenter;\nlayout(location = 0) out vec4 outColors[3];\nStruct5 c;\nivec3 i3d;\n\nivec2 toIndex2D(Struct3 r2d, vec2 coord) {\n\treturn ivec2(vec2(r2d.res) * fract(coord)) & r2d.mask;\n}\n\nint toIndex(Struct3 r2d, ivec2 i2d) {\n\tivec2 index = (i2d & r2d.mask) << r2d.shift;\n\treturn index.x | index.y;\n}\n\nint toIndex(Struct3 r2d, vec2 coord) {\n\treturn toIndex(r2d, toIndex2D(r2d, coord));\n}\n\nivec3 toIndex3D(Struct4 r3d, int index) {\n\treturn ivec3(index) >> r3d.shift & r3d.mask;\n}\n\nivec3 toIndex3D(Struct3 r2d, Struct4 r3d, vec2 coord) {\n\treturn toIndex3D(r3d, toIndex(r2d, coord));\n}\n\nint hg_toIndex_(Struct4 r3d, ivec3 i3d) {\n\tivec3 index = (i3d & r3d.mask) << r3d.shift;\n\treturn index.x | index.y | index.z;\n}\n\nivec2 hg_toIndex2D_(Struct3 r2d, int index) {\n\treturn ivec2(index) >> r2d.shift & r2d.mask;\n}\n\nivec2 hg_toIndex2D_(Struct3 r2d, Struct4 r3d, ivec3 i3d) {\n\treturn hg_toIndex2D_(r2d, hg_toIndex_(r3d, i3d));\n}\n\nvec4 fetch(Struct3 r2d, Struct4 r3d, sampler2D tex, ivec3 i3d) {\n\treturn texelFetch(tex, hg_toIndex2D_(r2d, r3d, i3d), 0);\n}\n\nvec4[3] writeCellData(Struct5 c) {\n\treturn vec4[](vec4(c.momentum.xyz, c.mass), vec4(c.vel, c.mass), vec4(0));\n}\n\nvoid main() {\n\ti3d = toIndex3D(r2d, r3d, vTexCoord);\n\tfloat mass = 0.0;\n\tmass += fetch(r2d, r3d, ctex.tex[0], i3d + ivec3(0, 1, 1))[0];\n\tmass += fetch(r2d, r3d, ctex.tex[0], i3d + ivec3(0, 0, 1))[1];\n\tmass += fetch(r2d, r3d, ctex.tex[0], i3d + ivec3(0, -1, 1))[2];\n\tmass += fetch(r2d, r3d, ctex.tex[1], i3d + ivec3(0, 1, 0))[0];\n\tmass += fetch(r2d, r3d, ctex.tex[1], i3d + ivec3(0))[1];\n\tmass += fetch(r2d, r3d, ctex.tex[1], i3d + ivec3(0, -1, 0))[2];\n\tmass += fetch(r2d, r3d, ctex.tex[2], i3d + ivec3(0, 1, -1))[0];\n\tmass += fetch(r2d, r3d, ctex.tex[2], i3d + ivec3(0, 0, -1))[1];\n\tmass += fetch(r2d, r3d, ctex.tex[2], i3d + ivec3(0, -1, -1))[2];\n\tmass *= 0.01;\n\tc = Struct5(vec3(0), mass, vec3(0));\n\toutColors = writeCellData(c);\n}"};
Me.attributes={Cd:{name:"ipos",type:n.i(3),location:0},Ed:{name:"ivel",type:n.i(3),location:1},Ad:{name:"imass",type:n.m,location:2},wd:{name:"igvel0",type:n.i(3),location:3},xd:{name:"igvel1",type:n.i(3),location:4},yd:{name:"igvel2",type:n.i(3),location:5},zd:{name:"ijacobian",type:n.m,location:6},vd:{name:"idensity",type:n.m,location:7},ud:{name:"iaeration",type:n.m,location:8},Fd:{name:"iweightsX",type:n.i(3),location:9},Gd:{name:"iweightsY",type:n.i(3),location:10},Hd:{name:"iweightsZ",type:n.i(3),
location:11},Dd:{name:"irand",type:n.i(3),location:12}};Me.source={Ta:"#version 300 es\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tivec3 res;\n\tvec3 invRes;\n\tivec3 mask;\n\tivec3 shift;\n};\nstruct Struct1 {\n\tivec2 res;\n\tvec2 invRes;\n\tivec2 mask;\n\tivec2 shift;\n};\nstruct Struct2 {\n\tsampler2D tex[3];\n\tsampler2D sdfTex;\n};\nstruct Struct3 {\n\tfloat initialVolume;\n\tfloat particleSize;\n};\n\nuniform float dt;\nuniform Struct2 ctex;\nuniform Struct3 pdata;\nuniform Struct1 r2d;\nuniform Struct0 r3d;\nlayout(location = 0) in vec3 ipos;\nlayout(location = 1) in vec3 ivel;\nlayout(location = 2) in float imass;\nlayout(location = 3) in vec3 igvel0;\nlayout(location = 4) in vec3 igvel1;\nlayout(location = 5) in vec3 igvel2;\nlayout(location = 6) in float ijacobian;\nlayout(location = 7) in float idensity;\nlayout(location = 8) in float iaeration;\nlayout(location = 9) in vec3 iweightsX;\nlayout(location = 10) in vec3 iweightsY;\nlayout(location = 11) in vec3 iweightsZ;\nlayout(location = 12) in vec3 irand;\nout vec3 pos;\nout vec3 vel;\nout float mass;\nout vec3 gvel0;\nout vec3 gvel1;\nout vec3 gvel2;\nout float jacobian;\nout float density;\nout float aeration;\nout vec3 weightsX;\nout vec3 weightsY;\nout vec3 weightsZ;\nout vec3 rand;\n\nvoid copyAll() {\n\tpos = ipos;\n\tvel = ivel;\n\tmass = imass;\n\tgvel0 = igvel0;\n\tgvel1 = igvel1;\n\tgvel2 = igvel2;\n\tjacobian = ijacobian;\n\tdensity = idensity;\n\taeration = iaeration;\n\tweightsX = iweightsX;\n\tweightsY = iweightsY;\n\tweightsZ = iweightsZ;\n\trand = irand;\n}\n\nivec3 toIndex3D(Struct0 r3d, vec3 coord) {\n\treturn ivec3(vec3(r3d.res) * fract(coord)) & r3d.mask;\n}\n\nint toIndex(Struct0 r3d, ivec3 i3d) {\n\tivec3 index = (i3d & r3d.mask) << r3d.shift;\n\treturn index.x | index.y | index.z;\n}\n\nivec2 toIndex2D(Struct1 r2d, int index) {\n\treturn ivec2(index) >> r2d.shift & r2d.mask;\n}\n\nivec2 toIndex2D(Struct1 r2d, Struct0 r3d, ivec3 i3d) {\n\treturn toIndex2D(r2d, toIndex(r3d, i3d));\n}\n\nvec4 fetch(Struct1 r2d, Struct0 r3d, sampler2D tex, ivec3 i3d) {\n\treturn texelFetch(tex, toIndex2D(r2d, r3d, i3d), 0);\n}\n\nvec4 fetchLinear(Struct1 r2d, Struct0 r3d, sampler2D tex, vec3 coord) {\n\tvec3 f3d = coord * vec3(r3d.res) - 0.5;\n\tvec3 fr = fract(f3d);\n\tivec3 i1 = ivec3(floor(f3d)) & r3d.mask;\n\tivec3 i2 = (i1 + 1) & r3d.mask;\n\tvec4 txyz = fetch(r2d, r3d, tex, ivec3(i1.x, i1.y, i1.z));\n\tvec4 txyZ = fetch(r2d, r3d, tex, ivec3(i1.x, i1.y, i2.z));\n\tvec4 txYz = fetch(r2d, r3d, tex, ivec3(i1.x, i2.y, i1.z));\n\tvec4 txYZ = fetch(r2d, r3d, tex, ivec3(i1.x, i2.y, i2.z));\n\tvec4 tXyz = fetch(r2d, r3d, tex, ivec3(i2.x, i1.y, i1.z));\n\tvec4 tXyZ = fetch(r2d, r3d, tex, ivec3(i2.x, i1.y, i2.z));\n\tvec4 tXYz = fetch(r2d, r3d, tex, ivec3(i2.x, i2.y, i1.z));\n\tvec4 tXYZ = fetch(r2d, r3d, tex, ivec3(i2.x, i2.y, i2.z));\n\tvec4 txy = mix(txyz, txyZ, fr.z);\n\tvec4 txY = mix(txYz, txYZ, fr.z);\n\tvec4 tXy = mix(tXyz, tXyZ, fr.z);\n\tvec4 tXY = mix(tXYz, tXYZ, fr.z);\n\tvec4 tx = mix(txy, txY, fr.y);\n\tvec4 tX = mix(tXy, tXY, fr.y);\n\treturn mix(tx, tX, fr.x);\n}\n\nvoid main() {\n\tcopyAll();\n\tvec3 coord = ipos * r3d.invRes;\n\tivec3 i3d = toIndex3D(r3d, coord);\n\tfloat mass = 0.0;\n\tmat3 weightXY = outerProduct(iweightsX, iweightsY);\n\tmass += fetch(r2d, r3d, ctex.tex[0], i3d + ivec3(-1)).w * weightXY[0][0] * iweightsZ[0];\n\tmass += fetch(r2d, r3d, ctex.tex[0], i3d + ivec3(-1, -1, 0)).w * weightXY[0][0] * iweightsZ[1];\n\tmass += fetch(r2d, r3d, ctex.tex[0], i3d + ivec3(-1, -1, 1)).w * weightXY[0][0] * iweightsZ[2];\n\tmass += fetch(r2d, r3d, ctex.tex[0], i3d + ivec3(-1, 0, -1)).w * weightXY[0][1] * iweightsZ[0];\n\tmass += fetch(r2d, r3d, ctex.tex[0], i3d + ivec3(-1, 0, 0)).w * weightXY[0][1] * iweightsZ[1];\n\tmass += fetch(r2d, r3d, ctex.tex[0], i3d + ivec3(-1, 0, 1)).w * weightXY[0][1] * iweightsZ[2];\n\tmass += fetch(r2d, r3d, ctex.tex[0], i3d + ivec3(-1, 1, -1)).w * weightXY[0][2] * iweightsZ[0];\n\tmass += fetch(r2d, r3d, ctex.tex[0], i3d + ivec3(-1, 1, 0)).w * weightXY[0][2] * iweightsZ[1];\n\tmass += fetch(r2d, r3d, ctex.tex[0], i3d + ivec3(-1, 1, 1)).w * weightXY[0][2] * iweightsZ[2];\n\tmass += fetch(r2d, r3d, ctex.tex[0], i3d + ivec3(0, -1, -1)).w * weightXY[1][0] * iweightsZ[0];\n\tmass += fetch(r2d, r3d, ctex.tex[0], i3d + ivec3(0, -1, 0)).w * weightXY[1][0] * iweightsZ[1];\n\tmass += fetch(r2d, r3d, ctex.tex[0], i3d + ivec3(0, -1, 1)).w * weightXY[1][0] * iweightsZ[2];\n\tmass += fetch(r2d, r3d, ctex.tex[0], i3d + ivec3(0, 0, -1)).w * weightXY[1][1] * iweightsZ[0];\n\tmass += fetch(r2d, r3d, ctex.tex[0], i3d + ivec3(0)).w * weightXY[1][1] * iweightsZ[1];\n\tmass += fetch(r2d, r3d, ctex.tex[0], i3d + ivec3(0, 0, 1)).w * weightXY[1][1] * iweightsZ[2];\n\tmass += fetch(r2d, r3d, ctex.tex[0], i3d + ivec3(0, 1, -1)).w * weightXY[1][2] * iweightsZ[0];\n\tmass += fetch(r2d, r3d, ctex.tex[0], i3d + ivec3(0, 1, 0)).w * weightXY[1][2] * iweightsZ[1];\n\tmass += fetch(r2d, r3d, ctex.tex[0], i3d + ivec3(0, 1, 1)).w * weightXY[1][2] * iweightsZ[2];\n\tmass += fetch(r2d, r3d, ctex.tex[0], i3d + ivec3(1, -1, -1)).w * weightXY[2][0] * iweightsZ[0];\n\tmass += fetch(r2d, r3d, ctex.tex[0], i3d + ivec3(1, -1, 0)).w * weightXY[2][0] * iweightsZ[1];\n\tmass += fetch(r2d, r3d, ctex.tex[0], i3d + ivec3(1, -1, 1)).w * weightXY[2][0] * iweightsZ[2];\n\tmass += fetch(r2d, r3d, ctex.tex[0], i3d + ivec3(1, 0, -1)).w * weightXY[2][1] * iweightsZ[0];\n\tmass += fetch(r2d, r3d, ctex.tex[0], i3d + ivec3(1, 0, 0)).w * weightXY[2][1] * iweightsZ[1];\n\tmass += fetch(r2d, r3d, ctex.tex[0], i3d + ivec3(1, 0, 1)).w * weightXY[2][1] * iweightsZ[2];\n\tmass += fetch(r2d, r3d, ctex.tex[0], i3d + ivec3(1, 1, -1)).w * weightXY[2][2] * iweightsZ[0];\n\tmass += fetch(r2d, r3d, ctex.tex[0], i3d + ivec3(1, 1, 0)).w * weightXY[2][2] * iweightsZ[1];\n\tmass += fetch(r2d, r3d, ctex.tex[0], i3d + ivec3(1)).w * weightXY[2][2] * iweightsZ[2];\n\tdensity = mass;\n\tvec4 sdf = fetchLinear(r2d, r3d, ctex.sdfTex, coord);\n\tvec3 normal = normalize(sdf.xyz);\n\tfloat dist = sdf.w;\n\tif (dist < 0.0) {\n\t\tfloat escapeVel = -dist * 1.0;\n\t\tfloat currentVel = dot(vel, normal);\n\t\tfloat targetVel = max(currentVel, escapeVel);\n\t\tvel += normal * (targetVel - currentVel);\n\t}\n\tfloat volume = pdata.initialVolume / density;\n\tfloat pressure = 5.0 * max(0.0, density - 1.0) * volume;\n\tif (dist < 1.5) {\n\t\tfloat volume = pdata.initialVolume * jacobian;\n\t\tfloat pressure2 = 1.5 * max(0.0, 1.0 / jacobian - 1.0) * volume;\n\t\tpressure = max(pressure2, pressure);\n\t}\n\tmat3 gmomentum = mat3(igvel0, igvel1, igvel2) * imass - dt * 4.0 * pressure * mat3x3(-1);\n\tgvel0 = gmomentum[0];\n\tgvel1 = gmomentum[1];\n\tgvel2 = gmomentum[2];\n}",
Ka:"#version 300 es\nprecision highp int;\nprecision highp float;\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tivec3 res;\n\tvec3 invRes;\n\tivec3 mask;\n\tivec3 shift;\n};\nstruct Struct1 {\n\tivec2 res;\n\tvec2 invRes;\n\tivec2 mask;\n\tivec2 shift;\n};\nstruct Struct2 {\n\tsampler2D tex[3];\n\tsampler2D sdfTex;\n};\nstruct Struct3 {\n\tfloat initialVolume;\n\tfloat particleSize;\n};\n\nuniform float dt;\nuniform Struct2 ctex;\nuniform Struct3 pdata;\nuniform Struct1 r2d;\nuniform Struct0 r3d;\nin vec3 pos;\nin vec3 vel;\nin float mass;\nin vec3 gvel0;\nin vec3 gvel1;\nin vec3 gvel2;\nin float jacobian;\nin float density;\nin float aeration;\nin vec3 weightsX;\nin vec3 weightsY;\nin vec3 weightsZ;\nin vec3 rand;\n\nvoid main() {\n}"};
Nd.N=function(){var b=[];b.push({name:"ctex.tex[0]",type:d.s(t.u)});b.push({name:"ctex.tex[1]",type:d.s(t.u)});b.push({name:"ctex.tex[2]",type:d.s(t.u)});return{gb:{name:"dt",type:d.m},ya:{transform:{name:"matrix.transform",type:d.j(4,4)},model:{name:"matrix.model",type:d.j(4,4)},view:{name:"matrix.view",type:d.j(4,4)},Ra:{name:"matrix.projection",type:d.j(4,4)},Ma:{name:"matrix.invProjection",type:d.j(4,4)},Na:{name:"matrix.modelView",type:d.j(4,4)},La:{name:"matrix.invModelView",type:d.j(4,4)},
ua:{name:"matrix.normal",type:d.j(3,3)}},la:{mb:new uc(b,"ctex.tex",d.s(t.u)),Ga:{name:"ctex.sdfTex",type:d.s(t.u)}},Da:{name:"depthTex",type:d.s(t.u)},Ia:{name:"colorTex",type:d.s(t.u)},cb:{ib:{name:"pdata.initialVolume",type:d.m},jb:{name:"pdata.particleSize",type:d.m}},Va:{R:{name:"r2d.res",type:d.l(2)},O:{name:"r2d.invRes",type:d.i(2)},P:{name:"r2d.mask",type:d.l(2)},shift:{name:"r2d.shift",type:d.l(2)}},Xa:{R:{name:"r3d.res",type:d.l(3)},O:{name:"r3d.invRes",type:d.i(3)},P:{name:"r3d.mask",type:d.l(3)},
shift:{name:"r3d.shift",type:d.l(3)}},Wa:{R:{name:"r2dm.res",type:d.l(2)},O:{name:"r2dm.invRes",type:d.i(2)},P:{name:"r2dm.mask",type:d.l(2)},shift:{name:"r2dm.shift",type:d.l(2)}},rb:{name:"colorVec",type:d.i(3)},qb:{name:"boxCenter",type:d.i(3)}}}(this);Nd.attributes={Kb:{name:"aPosition",type:n.i(4),location:0},Ib:{name:"aColor",type:n.i(4),location:1},Jb:{name:"aNormal",type:n.i(4),location:2},Lb:{name:"aTexCoord",type:n.i(2),location:3},fc:{name:"ppos",type:n.i(3),location:4},Gh:{name:"pvel",
type:n.i(3),location:5},De:{name:"pmass",type:n.m,location:6},Dh:{name:"pgvel0",type:n.i(3),location:7},Eh:{name:"pgvel1",type:n.i(3),location:8},Fh:{name:"pgvel2",type:n.i(3),location:9},Oe:{name:"weightsX",type:n.i(3),location:10},Pe:{name:"weightsY",type:n.i(3),location:11},Qe:{name:"weightsZ",type:n.i(3),location:12}};Nd.source={Ta:"#version 300 es\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tivec2 res;\n\tvec2 invRes;\n\tivec2 mask;\n\tivec2 shift;\n};\nstruct Struct1 {\n\tivec3 res;\n\tvec3 invRes;\n\tivec3 mask;\n\tivec3 shift;\n};\nstruct Struct2 {\n\tmat4 transform;\n\tmat4 model;\n\tmat4 view;\n\tmat4 projection;\n\tmat4 invProjection;\n\tmat4 modelView;\n\tmat4 invModelView;\n\tmat3 normal;\n};\nstruct Struct3 {\n\tsampler2D tex[3];\n\tsampler2D sdfTex;\n};\nstruct Struct4 {\n\tfloat initialVolume;\n\tfloat particleSize;\n};\n\nlayout(location = 0) in vec4 aPosition;\nlayout(location = 1) in vec4 aColor;\nlayout(location = 2) in vec4 aNormal;\nlayout(location = 3) in vec2 aTexCoord;\nuniform float dt;\nuniform Struct2 matrix;\nuniform Struct3 ctex;\nuniform sampler2D depthTex;\nuniform sampler2D colorTex;\nuniform Struct4 pdata;\nuniform Struct0 r2d;\nuniform Struct1 r3d;\nuniform Struct0 r2dm;\nout vec2 vTexCoord;\nuniform vec3 colorVec;\nuniform vec3 boxCenter;\nlayout(location = 4) in vec3 ppos;\nlayout(location = 5) in vec3 pvel;\nlayout(location = 6) in float pmass;\nlayout(location = 7) in vec3 pgvel0;\nlayout(location = 8) in vec3 pgvel1;\nlayout(location = 9) in vec3 pgvel2;\nlayout(location = 10) in vec3 weightsX;\nlayout(location = 11) in vec3 weightsY;\nlayout(location = 12) in vec3 weightsZ;\nout vec4 vColors[3];\n\nint toIndex(Struct1 r3d, ivec3 i3d) {\n\tivec3 index = (i3d & r3d.mask) << r3d.shift;\n\treturn index.x | index.y | index.z;\n}\n\nivec2 toIndex2D(Struct0 r2d, int index) {\n\treturn ivec2(index) >> r2d.shift & r2d.mask;\n}\n\nivec2 toIndex2D(Struct0 r2d, Struct1 r3d, ivec3 i3d) {\n\treturn toIndex2D(r2d, toIndex(r3d, i3d));\n}\n\nvoid main() {\n\tivec3 ipos = ivec3(aPosition);\n\tfloat weight = weightsX[ipos.x + 1] * weightsY[ipos.y + 1];\n\tivec3 ci3d = ivec3(floor(ppos)) + ipos;\n\tvec3 cpos = vec3(ci3d) + 0.5;\n\tvec3 pdiff = cpos - ppos;\n\tvec3 momentum = pvel * pmass + mat3(pgvel0, pgvel1, pgvel2) * pdiff;\n\tvec4 base = vec4(momentum, pmass) * weight;\n\tvec4 zdiff = vec4(pgvel2 * weight, 0);\n\tvColors[0] = (base - zdiff) * weightsZ[0] * 100.0;\n\tvColors[1] = base * weightsZ[1] * 100.0;\n\tvColors[2] = (base + zdiff) * weightsZ[2] * 100.0;\n\tivec2 ci2d = toIndex2D(r2d, r3d, ci3d);\n\tgl_Position = vec4((vec2(ci2d) + 0.5) * r2d.invRes * 2.0 - 1.0, 0, 1);\n\tgl_PointSize = 1.0;\n}",
Ka:"#version 300 es\nprecision highp int;\nprecision highp float;\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tivec2 res;\n\tvec2 invRes;\n\tivec2 mask;\n\tivec2 shift;\n};\nstruct Struct1 {\n\tivec3 res;\n\tvec3 invRes;\n\tivec3 mask;\n\tivec3 shift;\n};\nstruct Struct2 {\n\tmat4 transform;\n\tmat4 model;\n\tmat4 view;\n\tmat4 projection;\n\tmat4 invProjection;\n\tmat4 modelView;\n\tmat4 invModelView;\n\tmat3 normal;\n};\nstruct Struct3 {\n\tsampler2D tex[3];\n\tsampler2D sdfTex;\n};\nstruct Struct4 {\n\tfloat initialVolume;\n\tfloat particleSize;\n};\n\nuniform float dt;\nuniform Struct2 matrix;\nuniform Struct3 ctex;\nuniform sampler2D depthTex;\nuniform sampler2D colorTex;\nuniform Struct4 pdata;\nuniform Struct0 r2d;\nuniform Struct1 r3d;\nuniform Struct0 r2dm;\nin vec2 vTexCoord;\nuniform vec3 colorVec;\nuniform vec3 boxCenter;\nin vec4 vColors[3];\nlayout(location = 0) out vec4 oColors[3];\n\nvoid main() {\n\toColors = vColors;\n}"};
Qc.N=function(){var b=[];b.push({name:"ctex.tex[0]",type:d.s(t.u)});b.push({name:"ctex.tex[1]",type:d.s(t.u)});b.push({name:"ctex.tex[2]",type:d.s(t.u)});return{gb:{name:"dt",type:d.m},ya:{transform:{name:"matrix.transform",type:d.j(4,4)},model:{name:"matrix.model",type:d.j(4,4)},view:{name:"matrix.view",type:d.j(4,4)},Ra:{name:"matrix.projection",type:d.j(4,4)},Ma:{name:"matrix.invProjection",type:d.j(4,4)},Na:{name:"matrix.modelView",type:d.j(4,4)},La:{name:"matrix.invModelView",type:d.j(4,4)},
ua:{name:"matrix.normal",type:d.j(3,3)}},la:{mb:new uc(b,"ctex.tex",d.s(t.u)),Ga:{name:"ctex.sdfTex",type:d.s(t.u)}},Da:{name:"depthTex",type:d.s(t.u)},Ia:{name:"colorTex",type:d.s(t.u)},cb:{ib:{name:"pdata.initialVolume",type:d.m},jb:{name:"pdata.particleSize",type:d.m}},Va:{R:{name:"r2d.res",type:d.l(2)},O:{name:"r2d.invRes",type:d.i(2)},P:{name:"r2d.mask",type:d.l(2)},shift:{name:"r2d.shift",type:d.l(2)}},Xa:{R:{name:"r3d.res",type:d.l(3)},O:{name:"r3d.invRes",type:d.i(3)},P:{name:"r3d.mask",type:d.l(3)},
shift:{name:"r3d.shift",type:d.l(3)}},Wa:{R:{name:"r2dm.res",type:d.l(2)},O:{name:"r2dm.invRes",type:d.i(2)},P:{name:"r2dm.mask",type:d.l(2)},shift:{name:"r2dm.shift",type:d.l(2)}},rb:{name:"colorVec",type:d.i(3)},qb:{name:"boxCenter",type:d.i(3)},bh:{name:"gravity",type:d.i(3)},ic:{name:"rayPos",type:d.i(3)},Vb:{name:"rayDir",type:d.i(3)},hc:{name:"prayDir",type:d.i(3)},rc:{name:"dragging",type:d.Dc},$h:{name:"wallThickness",type:d.l(3)}}}(this);Qc.source={Ta:"#version 300 es\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tmat4 transform;\n\tmat4 model;\n\tmat4 view;\n\tmat4 projection;\n\tmat4 invProjection;\n\tmat4 modelView;\n\tmat4 invModelView;\n\tmat3 normal;\n};\nstruct Struct1 {\n\tsampler2D tex[3];\n\tsampler2D sdfTex;\n};\nstruct Struct2 {\n\tfloat initialVolume;\n\tfloat particleSize;\n};\nstruct Struct3 {\n\tivec2 res;\n\tvec2 invRes;\n\tivec2 mask;\n\tivec2 shift;\n};\nstruct Struct4 {\n\tivec3 res;\n\tvec3 invRes;\n\tivec3 mask;\n\tivec3 shift;\n};\nstruct Struct5 {\n\tvec3 momentum;\n\tfloat mass;\n\tvec3 vel;\n};\n\nlayout(location = 0) in vec4 aPosition;\nlayout(location = 1) in vec4 aColor;\nlayout(location = 2) in vec4 aNormal;\nlayout(location = 3) in vec2 aTexCoord;\nuniform float dt;\nuniform Struct0 matrix;\nuniform Struct1 ctex;\nuniform sampler2D depthTex;\nuniform sampler2D colorTex;\nuniform Struct2 pdata;\nuniform Struct3 r2d;\nuniform Struct4 r3d;\nuniform Struct3 r2dm;\nout vec2 vTexCoord;\nuniform vec3 colorVec;\nuniform vec3 boxCenter;\nuniform vec3 gravity;\nuniform vec3 rayPos;\nuniform vec3 rayDir;\nuniform vec3 prayDir;\nuniform bool dragging;\nuniform ivec3 wallThickness;\nStruct5 c;\nivec3 i3d;\n\nvoid main() {\n\tgl_Position = matrix.transform * aPosition;\n\tvTexCoord = aTexCoord;\n}",
Ka:"#version 300 es\nprecision highp int;\nprecision highp float;\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tmat4 transform;\n\tmat4 model;\n\tmat4 view;\n\tmat4 projection;\n\tmat4 invProjection;\n\tmat4 modelView;\n\tmat4 invModelView;\n\tmat3 normal;\n};\nstruct Struct1 {\n\tsampler2D tex[3];\n\tsampler2D sdfTex;\n};\nstruct Struct2 {\n\tfloat initialVolume;\n\tfloat particleSize;\n};\nstruct Struct3 {\n\tivec2 res;\n\tvec2 invRes;\n\tivec2 mask;\n\tivec2 shift;\n};\nstruct Struct4 {\n\tivec3 res;\n\tvec3 invRes;\n\tivec3 mask;\n\tivec3 shift;\n};\nstruct Struct5 {\n\tvec3 momentum;\n\tfloat mass;\n\tvec3 vel;\n};\n\nuniform float dt;\nuniform Struct0 matrix;\nuniform Struct1 ctex;\nuniform sampler2D depthTex;\nuniform sampler2D colorTex;\nuniform Struct2 pdata;\nuniform Struct3 r2d;\nuniform Struct4 r3d;\nuniform Struct3 r2dm;\nin vec2 vTexCoord;\nuniform vec3 colorVec;\nuniform vec3 boxCenter;\nuniform vec3 gravity;\nuniform vec3 rayPos;\nuniform vec3 rayDir;\nuniform vec3 prayDir;\nuniform bool dragging;\nuniform ivec3 wallThickness;\nlayout(location = 0) out vec4 outColors[3];\nStruct5 c;\nivec3 i3d;\n\nivec2 toIndex2D(Struct3 r2d, vec2 coord) {\n\treturn ivec2(vec2(r2d.res) * fract(coord)) & r2d.mask;\n}\n\nint toIndex(Struct3 r2d, ivec2 i2d) {\n\tivec2 index = (i2d & r2d.mask) << r2d.shift;\n\treturn index.x | index.y;\n}\n\nint toIndex(Struct3 r2d, vec2 coord) {\n\treturn toIndex(r2d, toIndex2D(r2d, coord));\n}\n\nivec3 toIndex3D(Struct4 r3d, int index) {\n\treturn ivec3(index) >> r3d.shift & r3d.mask;\n}\n\nivec3 toIndex3D(Struct3 r2d, Struct4 r3d, vec2 coord) {\n\treturn toIndex3D(r3d, toIndex(r2d, coord));\n}\n\nint hg_toIndex_(Struct4 r3d, ivec3 i3d) {\n\tivec3 index = (i3d & r3d.mask) << r3d.shift;\n\treturn index.x | index.y | index.z;\n}\n\nivec2 hg_toIndex2D_(Struct3 r2d, int index) {\n\treturn ivec2(index) >> r2d.shift & r2d.mask;\n}\n\nivec2 hg_toIndex2D_(Struct3 r2d, Struct4 r3d, ivec3 i3d) {\n\treturn hg_toIndex2D_(r2d, hg_toIndex_(r3d, i3d));\n}\n\nvec4 fetch(Struct3 r2d, Struct4 r3d, sampler2D tex, ivec3 i3d) {\n\treturn texelFetch(tex, hg_toIndex2D_(r2d, r3d, i3d), 0);\n}\n\nvec3 nearestPointOnTriangle(vec3 c, vec3 p1, vec3 p2, vec3 p3) {\n\tvec3 p12 = p2 - p1;\n\tvec3 p13 = p3 - p1;\n\tvec3 p1c = c - p1;\n\tfloat d1 = dot(p12, p1c);\n\tfloat d2 = dot(p13, p1c);\n\tif (d1 <= 0.0 && d2 <= 0.0) {\n\t\treturn p1;\n\t}\n\tvec3 p2c = c - p2;\n\tfloat d3 = dot(p12, p2c);\n\tfloat d4 = dot(p13, p2c);\n\tif (d3 >= 0.0 && d4 <= d3) {\n\t\treturn p2;\n\t}\n\tfloat v3 = d1 * d4 - d3 * d2;\n\tif (v3 <= 0.0 && d1 >= 0.0 && d3 <= 0.0) {\n\t\tfloat v = d1 / (d1 - d3);\n\t\treturn p1 + p12 * v;\n\t}\n\tvec3 p3c = c - p3;\n\tfloat d5 = dot(p12, p3c);\n\tfloat d6 = dot(p13, p3c);\n\tif (d6 >= 0.0 && d5 <= d6) {\n\t\treturn p3;\n\t}\n\tfloat v2 = d5 * d2 - d1 * d6;\n\tif (v2 <= 0.0 && d2 >= 0.0 && d6 <= 0.0) {\n\t\tfloat v = d2 / (d2 - d6);\n\t\treturn p1 + v * p13;\n\t}\n\tfloat v1 = d3 * d6 - d5 * d4;\n\tfloat d34 = d4 - d3;\n\tfloat d56 = d6 - d5;\n\tif (v1 <= 0.0 && d34 >= 0.0 && d56 <= 0.0) {\n\t\tfloat v = d34 / (d34 - d56);\n\t\treturn p2 + v * (p3 - p2);\n\t}\n\tfloat denom = 1.0 / (v1 + v2 + v3);\n\treturn p1 + p12 * (v2 * denom) + p13 * (v3 * denom);\n}\n\nvoid cellMain() {\n\tc.momentum += c.mass * gravity * dt;\n\tif (c.mass > 1e-006) c.vel = c.momentum / c.mass;\n\telse c.vel = vec3(0);\n\tif (dragging) {\n\t\tvec3 wpos = vec3(i3d) + 0.5;\n\t\tvec3 nearestPoint = nearestPointOnTriangle(wpos, rayPos, rayPos + rayDir * 100.0, rayPos + prayDir * 100.0);\n\t\tif (length(nearestPoint - wpos) < 2.0) {\n\t\t\tfloat dist = length(nearestPoint - rayPos);\n\t\t\tvec3 diff = dist * (rayDir - prayDir);\n\t\t\tc.vel = diff / dt;\n\t\t}\n\t}\n\tc.vel = clamp(c.vel * dt, vec3(-1), vec3(1)) / dt;\n\tivec3 i3d = toIndex3D(r2d, r3d, vTexCoord);\n\tvec4 sdf = fetch(r2d, r3d, ctex.sdfTex, i3d);\n\tif (sdf.w < 0.0) {\n\t\tvec3 normal = sdf.xyz;\n\t\tfloat vn = dot(c.vel, normal);\n\t\tif (vn < 0.0) {\n\t\t\tc.vel -= normal * vn;\n\t\t}\n\t}\n}\n\nvec4[3] writeCellData(Struct5 c) {\n\treturn vec4[](vec4(c.momentum.xyz, c.mass), vec4(c.vel, c.mass), vec4(0));\n}\n\nvoid main() {\n\ti3d = toIndex3D(r2d, r3d, vTexCoord);\n\tvec4 momentumMass = vec4(0);\n\tmomentumMass += fetch(r2d, r3d, ctex.tex[0], i3d + ivec3(0, 0, 1));\n\tmomentumMass += fetch(r2d, r3d, ctex.tex[1], i3d);\n\tmomentumMass += fetch(r2d, r3d, ctex.tex[2], i3d - ivec3(0, 0, 1));\n\tmomentumMass *= 0.01;\n\tc = Struct5(momentumMass.xyz, momentumMass.w, vec3(0));\n\tcellMain();\n\toutColors = writeCellData(c);\n}"};
Le.attributes={Cd:{name:"ipos",type:n.i(3),location:0},Ed:{name:"ivel",type:n.i(3),location:1},Ad:{name:"imass",type:n.m,location:2},wd:{name:"igvel0",type:n.i(3),location:3},xd:{name:"igvel1",type:n.i(3),location:4},yd:{name:"igvel2",type:n.i(3),location:5},zd:{name:"ijacobian",type:n.m,location:6},vd:{name:"idensity",type:n.m,location:7},ud:{name:"iaeration",type:n.m,location:8},Fd:{name:"iweightsX",type:n.i(3),location:9},Gd:{name:"iweightsY",type:n.i(3),location:10},Hd:{name:"iweightsZ",type:n.i(3),
location:11},Dd:{name:"irand",type:n.i(3),location:12}};Le.source={Ta:"#version 300 es\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tivec3 res;\n\tvec3 invRes;\n\tivec3 mask;\n\tivec3 shift;\n};\nstruct Struct1 {\n\tivec2 res;\n\tvec2 invRes;\n\tivec2 mask;\n\tivec2 shift;\n};\nstruct Struct2 {\n\tsampler2D tex[3];\n\tsampler2D sdfTex;\n};\nstruct Struct3 {\n\tfloat initialVolume;\n\tfloat particleSize;\n};\n\nuniform float dt;\nuniform Struct2 ctex;\nuniform Struct3 pdata;\nuniform Struct1 r2d;\nuniform Struct0 r3d;\nlayout(location = 0) in vec3 ipos;\nlayout(location = 1) in vec3 ivel;\nlayout(location = 2) in float imass;\nlayout(location = 3) in vec3 igvel0;\nlayout(location = 4) in vec3 igvel1;\nlayout(location = 5) in vec3 igvel2;\nlayout(location = 6) in float ijacobian;\nlayout(location = 7) in float idensity;\nlayout(location = 8) in float iaeration;\nlayout(location = 9) in vec3 iweightsX;\nlayout(location = 10) in vec3 iweightsY;\nlayout(location = 11) in vec3 iweightsZ;\nlayout(location = 12) in vec3 irand;\nout vec3 pos;\nout vec3 vel;\nout float mass;\nout vec3 gvel0;\nout vec3 gvel1;\nout vec3 gvel2;\nout float jacobian;\nout float density;\nout float aeration;\nout vec3 weightsX;\nout vec3 weightsY;\nout vec3 weightsZ;\nout vec3 rand;\n\nvoid copyAll() {\n\tpos = ipos;\n\tvel = ivel;\n\tmass = imass;\n\tgvel0 = igvel0;\n\tgvel1 = igvel1;\n\tgvel2 = igvel2;\n\tjacobian = ijacobian;\n\tdensity = idensity;\n\taeration = iaeration;\n\tweightsX = iweightsX;\n\tweightsY = iweightsY;\n\tweightsZ = iweightsZ;\n\trand = irand;\n}\n\nivec3 toIndex3D(Struct0 r3d, vec3 coord) {\n\treturn ivec3(vec3(r3d.res) * fract(coord)) & r3d.mask;\n}\n\nint toIndex(Struct0 r3d, ivec3 i3d) {\n\tivec3 index = (i3d & r3d.mask) << r3d.shift;\n\treturn index.x | index.y | index.z;\n}\n\nivec2 toIndex2D(Struct1 r2d, int index) {\n\treturn ivec2(index) >> r2d.shift & r2d.mask;\n}\n\nivec2 toIndex2D(Struct1 r2d, Struct0 r3d, ivec3 i3d) {\n\treturn toIndex2D(r2d, toIndex(r3d, i3d));\n}\n\nvec4 fetch(Struct1 r2d, Struct0 r3d, sampler2D tex, ivec3 i3d) {\n\treturn texelFetch(tex, toIndex2D(r2d, r3d, i3d), 0);\n}\n\nvec4 fetchLinear(Struct1 r2d, Struct0 r3d, sampler2D tex, vec3 coord) {\n\tvec3 f3d = coord * vec3(r3d.res) - 0.5;\n\tvec3 fr = fract(f3d);\n\tivec3 i1 = ivec3(floor(f3d)) & r3d.mask;\n\tivec3 i2 = (i1 + 1) & r3d.mask;\n\tvec4 txyz = fetch(r2d, r3d, tex, ivec3(i1.x, i1.y, i1.z));\n\tvec4 txyZ = fetch(r2d, r3d, tex, ivec3(i1.x, i1.y, i2.z));\n\tvec4 txYz = fetch(r2d, r3d, tex, ivec3(i1.x, i2.y, i1.z));\n\tvec4 txYZ = fetch(r2d, r3d, tex, ivec3(i1.x, i2.y, i2.z));\n\tvec4 tXyz = fetch(r2d, r3d, tex, ivec3(i2.x, i1.y, i1.z));\n\tvec4 tXyZ = fetch(r2d, r3d, tex, ivec3(i2.x, i1.y, i2.z));\n\tvec4 tXYz = fetch(r2d, r3d, tex, ivec3(i2.x, i2.y, i1.z));\n\tvec4 tXYZ = fetch(r2d, r3d, tex, ivec3(i2.x, i2.y, i2.z));\n\tvec4 txy = mix(txyz, txyZ, fr.z);\n\tvec4 txY = mix(txYz, txYZ, fr.z);\n\tvec4 tXy = mix(tXyz, tXyZ, fr.z);\n\tvec4 tXY = mix(tXYz, tXYZ, fr.z);\n\tvec4 tx = mix(txy, txY, fr.y);\n\tvec4 tX = mix(tXy, tXY, fr.y);\n\treturn mix(tx, tX, fr.x);\n}\n\nvoid main() {\n\tcopyAll();\n\tmat3 gvel = mat3x3(0);\n\tvec4 velmass = vec4(0);\n\tivec3 i3d = toIndex3D(r3d, ipos * r3d.invRes);\n\tfor (int di = -1; di < 2; di++) {\n\t\tfor (int dj = -1; dj < 2; dj++) {\n\t\t\tfor (int dk = -1; dk < 2; dk++) {\n\t\t\t\tivec3 c3d = i3d + ivec3(di, dj, dk);\n\t\t\t\tvec4 cvelmass = fetch(r2d, r3d, ctex.tex[1], c3d);\n\t\t\t\tfloat weight = weightsX[di + 1] * weightsY[dj + 1] * weightsZ[dk + 1];\n\t\t\t\tvec3 cpos = vec3(c3d) + 0.5;\n\t\t\t\tvec3 d = cpos - ipos;\n\t\t\t\tvec4 wvelmass = cvelmass * weight;\n\t\t\t\tvelmass += wvelmass;\n\t\t\t\tgvel += outerProduct(wvelmass.xyz, d);\n\t\t\t}\n\t\t}\n\t}\n\tvel = velmass.xyz;\n\tdensity = velmass.w;\n\tgvel *= 4.0;\n\tfloat dist = fetchLinear(r2d, r3d, ctex.sdfTex, pos * r3d.invRes).w;\n\tif (dist < 1.5) {\n\t\tjacobian = min(ijacobian, 1.0 / density);\n\t\tjacobian *= determinant(gvel * dt + mat3x3(1));\n\t\tjacobian = clamp(jacobian, 0.05, 20.0);\n\t}\n\telse {\n\t\tjacobian = 1.0 / density;\n\t}\n\tgvel0 = gvel[0];\n\tgvel1 = gvel[1];\n\tgvel2 = gvel[2];\n\tvec3 newPos = clamp(ipos + vel * dt + irand * 0.0001, vec3(1), vec3(r3d.mask));\n\tvec3 newVel = (newPos - ipos) / dt;\n\tpos = newPos;\n\tvel = newVel;\n\tvec3 acc = vel - ivel;\n\tfloat densityRatio = density + max(0.0, 0.2 - dist);\n\taeration *= exp(-dt * 0.02);\n\tfloat t = (densityRatio - 0.7) / -0.29999999999999993;\n\tif (t > 0.0) {\n\t\tfloat a = aeration + length(acc) * t * 5.0 * dt;\n\t\taeration = min(1.0, a);\n\t}\n}",
Ka:"#version 300 es\nprecision highp int;\nprecision highp float;\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tivec3 res;\n\tvec3 invRes;\n\tivec3 mask;\n\tivec3 shift;\n};\nstruct Struct1 {\n\tivec2 res;\n\tvec2 invRes;\n\tivec2 mask;\n\tivec2 shift;\n};\nstruct Struct2 {\n\tsampler2D tex[3];\n\tsampler2D sdfTex;\n};\nstruct Struct3 {\n\tfloat initialVolume;\n\tfloat particleSize;\n};\n\nuniform float dt;\nuniform Struct2 ctex;\nuniform Struct3 pdata;\nuniform Struct1 r2d;\nuniform Struct0 r3d;\nin vec3 pos;\nin vec3 vel;\nin float mass;\nin vec3 gvel0;\nin vec3 gvel1;\nin vec3 gvel2;\nin float jacobian;\nin float density;\nin float aeration;\nin vec3 weightsX;\nin vec3 weightsY;\nin vec3 weightsZ;\nin vec3 rand;\n\nvoid main() {\n}"};
Md.N=function(){var b=[];b.push({name:"ctex.tex[0]",type:d.s(t.u)});b.push({name:"ctex.tex[1]",type:d.s(t.u)});b.push({name:"ctex.tex[2]",type:d.s(t.u)});return{gb:{name:"dt",type:d.m},ya:{transform:{name:"matrix.transform",type:d.j(4,4)},model:{name:"matrix.model",type:d.j(4,4)},view:{name:"matrix.view",type:d.j(4,4)},Ra:{name:"matrix.projection",type:d.j(4,4)},Ma:{name:"matrix.invProjection",type:d.j(4,4)},Na:{name:"matrix.modelView",type:d.j(4,4)},La:{name:"matrix.invModelView",type:d.j(4,4)},
ua:{name:"matrix.normal",type:d.j(3,3)}},la:{mb:new uc(b,"ctex.tex",d.s(t.u)),Ga:{name:"ctex.sdfTex",type:d.s(t.u)}},Da:{name:"depthTex",type:d.s(t.u)},Ia:{name:"colorTex",type:d.s(t.u)},cb:{ib:{name:"pdata.initialVolume",type:d.m},jb:{name:"pdata.particleSize",type:d.m}},Va:{R:{name:"r2d.res",type:d.l(2)},O:{name:"r2d.invRes",type:d.i(2)},P:{name:"r2d.mask",type:d.l(2)},shift:{name:"r2d.shift",type:d.l(2)}},Xa:{R:{name:"r3d.res",type:d.l(3)},O:{name:"r3d.invRes",type:d.i(3)},P:{name:"r3d.mask",type:d.l(3)},
shift:{name:"r3d.shift",type:d.l(3)}},Wa:{R:{name:"r2dm.res",type:d.l(2)},O:{name:"r2dm.invRes",type:d.i(2)},P:{name:"r2dm.mask",type:d.l(2)},shift:{name:"r2dm.shift",type:d.l(2)}},rb:{name:"colorVec",type:d.i(3)},qb:{name:"boxCenter",type:d.i(3)}}}(this);Md.attributes={Kb:{name:"aPosition",type:n.i(4),location:0},Ib:{name:"aColor",type:n.i(4),location:1},Jb:{name:"aNormal",type:n.i(4),location:2},Lb:{name:"aTexCoord",type:n.i(2),location:3},fc:{name:"ppos",type:n.i(3),location:4},Ce:{name:"pjacobian",
type:n.m,location:5},Be:{name:"pdensity",type:n.m,location:6},ze:{name:"paeration",type:n.m,location:7}};Md.source={Ta:"#version 300 es\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tivec2 res;\n\tvec2 invRes;\n\tivec2 mask;\n\tivec2 shift;\n};\nstruct Struct1 {\n\tivec3 res;\n\tvec3 invRes;\n\tivec3 mask;\n\tivec3 shift;\n};\nstruct Struct2 {\n\tmat4 transform;\n\tmat4 model;\n\tmat4 view;\n\tmat4 projection;\n\tmat4 invProjection;\n\tmat4 modelView;\n\tmat4 invModelView;\n\tmat3 normal;\n};\nstruct Struct3 {\n\tsampler2D tex[3];\n\tsampler2D sdfTex;\n};\nstruct Struct4 {\n\tfloat initialVolume;\n\tfloat particleSize;\n};\n\nlayout(location = 0) in vec4 aPosition;\nlayout(location = 1) in vec4 aColor;\nlayout(location = 2) in vec4 aNormal;\nlayout(location = 3) in vec2 aTexCoord;\nuniform float dt;\nuniform Struct2 matrix;\nuniform Struct3 ctex;\nuniform sampler2D depthTex;\nuniform sampler2D colorTex;\nuniform Struct4 pdata;\nuniform Struct0 r2d;\nuniform Struct1 r3d;\nuniform Struct0 r2dm;\nout vec2 vTexCoord;\nuniform vec3 colorVec;\nuniform vec3 boxCenter;\nlayout(location = 4) in vec3 ppos;\nlayout(location = 5) in float pjacobian;\nlayout(location = 6) in float pdensity;\nlayout(location = 7) in float paeration;\nout vec3 vPosition;\nout float aeration;\n\nint toIndex(Struct1 r3d, ivec3 i3d) {\n\tivec3 index = (i3d & r3d.mask) << r3d.shift;\n\treturn index.x | index.y | index.z;\n}\n\nivec2 toIndex2D(Struct0 r2d, int index) {\n\treturn ivec2(index) >> r2d.shift & r2d.mask;\n}\n\nivec2 toIndex2D(Struct0 r2d, Struct1 r3d, ivec3 i3d) {\n\treturn toIndex2D(r2d, toIndex(r3d, i3d));\n}\n\nvec4 fetch(Struct0 r2d, Struct1 r3d, sampler2D tex, ivec3 i3d) {\n\treturn texelFetch(tex, toIndex2D(r2d, r3d, i3d), 0);\n}\n\nvec4 fetchLinear(Struct0 r2d, Struct1 r3d, sampler2D tex, vec3 coord) {\n\tvec3 f3d = coord * vec3(r3d.res) - 0.5;\n\tvec3 fr = fract(f3d);\n\tivec3 i1 = ivec3(floor(f3d)) & r3d.mask;\n\tivec3 i2 = (i1 + 1) & r3d.mask;\n\tvec4 txyz = fetch(r2d, r3d, tex, ivec3(i1.x, i1.y, i1.z));\n\tvec4 txyZ = fetch(r2d, r3d, tex, ivec3(i1.x, i1.y, i2.z));\n\tvec4 txYz = fetch(r2d, r3d, tex, ivec3(i1.x, i2.y, i1.z));\n\tvec4 txYZ = fetch(r2d, r3d, tex, ivec3(i1.x, i2.y, i2.z));\n\tvec4 tXyz = fetch(r2d, r3d, tex, ivec3(i2.x, i1.y, i1.z));\n\tvec4 tXyZ = fetch(r2d, r3d, tex, ivec3(i2.x, i1.y, i2.z));\n\tvec4 tXYz = fetch(r2d, r3d, tex, ivec3(i2.x, i2.y, i1.z));\n\tvec4 tXYZ = fetch(r2d, r3d, tex, ivec3(i2.x, i2.y, i2.z));\n\tvec4 txy = mix(txyz, txyZ, fr.z);\n\tvec4 txY = mix(txYz, txYZ, fr.z);\n\tvec4 tXy = mix(tXyz, tXyZ, fr.z);\n\tvec4 tXY = mix(tXYz, tXYZ, fr.z);\n\tvec4 tx = mix(txy, txY, fr.y);\n\tvec4 tX = mix(tXy, tXY, fr.y);\n\treturn mix(tx, tX, fr.x);\n}\n\nvoid main() {\n\tfloat dist = fetchLinear(r2d, r3d, ctex.sdfTex, ppos * r3d.invRes).w;\n\tfloat dens = pdensity + max(0.0, 0.2 - dist);\n\tvec4 pos = vec4(aPosition.xyz * pdata.particleSize * 0.5 * clamp(dens * 1.5, 0.5, 1.1) + ppos, 1);\n\tvPosition = (matrix.modelView * pos).xyz;\n\taeration = paeration;\n\tgl_Position = matrix.transform * pos;\n}",
Ka:"#version 300 es\nprecision highp int;\nprecision highp float;\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tivec2 res;\n\tvec2 invRes;\n\tivec2 mask;\n\tivec2 shift;\n};\nstruct Struct1 {\n\tivec3 res;\n\tvec3 invRes;\n\tivec3 mask;\n\tivec3 shift;\n};\nstruct Struct2 {\n\tmat4 transform;\n\tmat4 model;\n\tmat4 view;\n\tmat4 projection;\n\tmat4 invProjection;\n\tmat4 modelView;\n\tmat4 invModelView;\n\tmat3 normal;\n};\nstruct Struct3 {\n\tsampler2D tex[3];\n\tsampler2D sdfTex;\n};\nstruct Struct4 {\n\tfloat initialVolume;\n\tfloat particleSize;\n};\n\nuniform float dt;\nuniform Struct2 matrix;\nuniform Struct3 ctex;\nuniform sampler2D depthTex;\nuniform sampler2D colorTex;\nuniform Struct4 pdata;\nuniform Struct0 r2d;\nuniform Struct1 r3d;\nuniform Struct0 r2dm;\nin vec2 vTexCoord;\nuniform vec3 colorVec;\nuniform vec3 boxCenter;\nin vec3 vPosition;\nin float aeration;\nlayout(location = 0) out vec4 oColor;\n\nvec3 lighting(vec3 color, vec3 position, vec3 normal, float specular) {\n\tvec3 light = normalize(vec3(1, -2, -3));\n\tcolor *= (0.4 + max(0.0, -dot(normal, light)) * 0.6);\n\tvec3 eye = normalize(position);\n\tvec3 refl = eye - 2.0 * dot(eye, normal) * normal;\n\tfloat reflDot = max(0.0, -dot(light, refl));\n\tcolor += pow(reflDot, 3.0) * specular;\n\treturn color;\n}\n\nvoid main() {\n\tvec3 dx = dFdx(vPosition.xyz);\n\tvec3 dy = dFdy(vPosition.xyz);\n\tvec3 n = normalize(cross(dx, dy));\n\tvec3 c = mix(vec3(0.2, 0.3, 1), vec3(0.75, 0.85, 1), clamp(aeration, 0.0, 1.0));\n\toColor = vec4(lighting(c, vPosition, n, 0.6), 1);\n}"};
tc.Fa={DEPTH:0,COLOR:1,kg:2};tc.N=function(){var b=[];b.push({name:"ctex.tex[0]",type:d.s(t.u)});b.push({name:"ctex.tex[1]",type:d.s(t.u)});b.push({name:"ctex.tex[2]",type:d.s(t.u)});return{gb:{name:"dt",type:d.m},ya:{transform:{name:"matrix.transform",type:d.j(4,4)},model:{name:"matrix.model",type:d.j(4,4)},view:{name:"matrix.view",type:d.j(4,4)},Ra:{name:"matrix.projection",type:d.j(4,4)},Ma:{name:"matrix.invProjection",type:d.j(4,4)},Na:{name:"matrix.modelView",type:d.j(4,4)},La:{name:"matrix.invModelView",
type:d.j(4,4)},ua:{name:"matrix.normal",type:d.j(3,3)}},la:{mb:new uc(b,"ctex.tex",d.s(t.u)),Ga:{name:"ctex.sdfTex",type:d.s(t.u)}},Da:{name:"depthTex",type:d.s(t.u)},Ia:{name:"colorTex",type:d.s(t.u)},cb:{ib:{name:"pdata.initialVolume",type:d.m},jb:{name:"pdata.particleSize",type:d.m}},Va:{R:{name:"r2d.res",type:d.l(2)},O:{name:"r2d.invRes",type:d.i(2)},P:{name:"r2d.mask",type:d.l(2)},shift:{name:"r2d.shift",type:d.l(2)}},Xa:{R:{name:"r3d.res",type:d.l(3)},O:{name:"r3d.invRes",type:d.i(3)},P:{name:"r3d.mask",
type:d.l(3)},shift:{name:"r3d.shift",type:d.l(3)}},Wa:{R:{name:"r2dm.res",type:d.l(2)},O:{name:"r2dm.invRes",type:d.i(2)},P:{name:"r2dm.mask",type:d.l(2)},shift:{name:"r2dm.shift",type:d.l(2)}},rb:{name:"colorVec",type:d.i(3)},qb:{name:"boxCenter",type:d.i(3)},mode:{name:"mode",type:d.wa}}}(this);tc.attributes={Kb:{name:"aPosition",type:n.i(4),location:0},Ib:{name:"aColor",type:n.i(4),location:1},Jb:{name:"aNormal",type:n.i(4),location:2},Lb:{name:"aTexCoord",type:n.i(2),location:3},fc:{name:"ppos",
type:n.i(3),location:4},Ce:{name:"pjacobian",type:n.m,location:5},Be:{name:"pdensity",type:n.m,location:6},ze:{name:"paeration",type:n.m,location:7}};tc.source={Ta:"#version 300 es\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tmat4 transform;\n\tmat4 model;\n\tmat4 view;\n\tmat4 projection;\n\tmat4 invProjection;\n\tmat4 modelView;\n\tmat4 invModelView;\n\tmat3 normal;\n};\nstruct Struct1 {\n\tsampler2D tex[3];\n\tsampler2D sdfTex;\n};\nstruct Struct2 {\n\tfloat initialVolume;\n\tfloat particleSize;\n};\nstruct Struct3 {\n\tivec2 res;\n\tvec2 invRes;\n\tivec2 mask;\n\tivec2 shift;\n};\nstruct Struct4 {\n\tivec3 res;\n\tvec3 invRes;\n\tivec3 mask;\n\tivec3 shift;\n};\n\nlayout(location = 0) in vec4 aPosition;\nlayout(location = 1) in vec4 aColor;\nlayout(location = 2) in vec4 aNormal;\nlayout(location = 3) in vec2 aTexCoord;\nuniform float dt;\nuniform Struct0 matrix;\nuniform Struct1 ctex;\nuniform sampler2D depthTex;\nuniform sampler2D colorTex;\nuniform Struct2 pdata;\nuniform Struct3 r2d;\nuniform Struct4 r3d;\nuniform Struct3 r2dm;\nout vec2 vTexCoord;\nuniform vec3 colorVec;\nuniform vec3 boxCenter;\nlayout(location = 4) in vec3 ppos;\nlayout(location = 5) in float pjacobian;\nlayout(location = 6) in float pdensity;\nlayout(location = 7) in float paeration;\nuniform int mode;\nout vec3 centerPos;\nout vec3 vColor;\nout float aeration;\n\nvoid main() {\n\tfloat dens = pdensity + max(0.0, 1.0 / pjacobian - 0.8);\n\tmat3 frame = mat3(matrix.invModelView);\n\tvec4 pos = vec4(frame * aPosition.xyz * pdata.particleSize * 0.75 * (mode == 1 ? 2.5 : clamp(dens * 1.5, 0.6, 1.2)) + ppos, 1);\n\tcenterPos = (matrix.modelView * vec4(ppos, 1)).xyz;\n\taeration = paeration;\n\tvTexCoord = aTexCoord;\n\tgl_Position = matrix.transform * pos;\n\tvColor = mix(vec3(0.2, 0.3, 1), vec3(0.6, 0.7, 1), clamp(paeration, 0.0, 1.0));\n}",
Ka:"#version 300 es\nprecision highp int;\nprecision highp float;\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tmat4 transform;\n\tmat4 model;\n\tmat4 view;\n\tmat4 projection;\n\tmat4 invProjection;\n\tmat4 modelView;\n\tmat4 invModelView;\n\tmat3 normal;\n};\nstruct Struct1 {\n\tsampler2D tex[3];\n\tsampler2D sdfTex;\n};\nstruct Struct2 {\n\tfloat initialVolume;\n\tfloat particleSize;\n};\nstruct Struct3 {\n\tivec2 res;\n\tvec2 invRes;\n\tivec2 mask;\n\tivec2 shift;\n};\nstruct Struct4 {\n\tivec3 res;\n\tvec3 invRes;\n\tivec3 mask;\n\tivec3 shift;\n};\n\nuniform float dt;\nuniform Struct0 matrix;\nuniform Struct1 ctex;\nuniform sampler2D depthTex;\nuniform sampler2D colorTex;\nuniform Struct2 pdata;\nuniform Struct3 r2d;\nuniform Struct4 r3d;\nuniform Struct3 r2dm;\nin vec2 vTexCoord;\nuniform vec3 colorVec;\nuniform vec3 boxCenter;\nuniform int mode;\nin vec3 centerPos;\nin vec3 vColor;\nin float aeration;\nlayout(location = 0) out vec4 oColor;\n\nvec3 lighting(vec3 color, vec3 position, vec3 normal, float specular) {\n\tvec3 light = normalize(vec3(1, -2, -3));\n\tcolor *= (0.4 + max(0.0, -dot(normal, light)) * 0.6);\n\tvec3 eye = normalize(position);\n\tvec3 refl = eye - 2.0 * dot(eye, normal) * normal;\n\tfloat reflDot = max(0.0, -dot(light, refl));\n\tcolor += pow(reflDot, 3.0) * specular;\n\treturn color;\n}\n\nvoid main() {\n\tvec2 d = vTexCoord * 2.0 - 1.0;\n\tfloat dd = dot(d, d);\n\tif (dd > 1.0) discard;\n\tfloat z = sqrt(1.0 - dd);\n\tvec3 dpos = vec3(d, z) * pdata.particleSize * 0.5;\n\tvec3 pos = centerPos + dpos;\n\tvec4 projPos = matrix.projection * vec4(pos, 1);\n\tgl_FragDepth = projPos.z / projPos.w;\n\tswitch (mode) {\n\tcase 0:\n\t\t{\n\t\t\toColor = vec4(pos.zzz, 1);\n\t\t}\n\t\tbreak;\n\tcase 1:\n\t\t{\n\t\t\tfloat weight = 1.0 - sqrt(dd);\n\t\t\tfloat aerationWeight = aeration * weight * weight * weight;\n\t\t\toColor = vec4(weight, aerationWeight, aerationWeight * centerPos.z, 0);\n\t\t}\n\t\tbreak;\n\tcase 2:\n\t\t{\n\t\t\tvec3 n = normalize(dpos);\n\t\t\toColor = vec4(lighting(vColor, pos, n, 0.2), 1);\n\t\t}\n\t\tbreak;\n\t}\n}"};
Jc.Fa={ag:0,Bg:1,Zf:2};Jc.N=function(){var b=[];b.push({name:"ctex.tex[0]",type:d.s(t.u)});b.push({name:"ctex.tex[1]",type:d.s(t.u)});b.push({name:"ctex.tex[2]",type:d.s(t.u)});return{gb:{name:"dt",type:d.m},ya:{transform:{name:"matrix.transform",type:d.j(4,4)},model:{name:"matrix.model",type:d.j(4,4)},view:{name:"matrix.view",type:d.j(4,4)},Ra:{name:"matrix.projection",type:d.j(4,4)},Ma:{name:"matrix.invProjection",type:d.j(4,4)},Na:{name:"matrix.modelView",type:d.j(4,4)},La:{name:"matrix.invModelView",
type:d.j(4,4)},ua:{name:"matrix.normal",type:d.j(3,3)}},la:{mb:new uc(b,"ctex.tex",d.s(t.u)),Ga:{name:"ctex.sdfTex",type:d.s(t.u)}},Da:{name:"depthTex",type:d.s(t.u)},Ia:{name:"colorTex",type:d.s(t.u)},cb:{ib:{name:"pdata.initialVolume",type:d.m},jb:{name:"pdata.particleSize",type:d.m}},Va:{R:{name:"r2d.res",type:d.l(2)},O:{name:"r2d.invRes",type:d.i(2)},P:{name:"r2d.mask",type:d.l(2)},shift:{name:"r2d.shift",type:d.l(2)}},Xa:{R:{name:"r3d.res",type:d.l(3)},O:{name:"r3d.invRes",type:d.i(3)},P:{name:"r3d.mask",
type:d.l(3)},shift:{name:"r3d.shift",type:d.l(3)}},Wa:{R:{name:"r2dm.res",type:d.l(2)},O:{name:"r2dm.invRes",type:d.i(2)},P:{name:"r2dm.mask",type:d.l(2)},shift:{name:"r2dm.shift",type:d.l(2)}},rb:{name:"colorVec",type:d.i(3)},qb:{name:"boxCenter",type:d.i(3)},Ae:{name:"pass",type:d.wa},Ff:{name:"screenRes",type:d.l(2)}}}(this);Jc.source={Ta:"#version 300 es\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tmat4 transform;\n\tmat4 model;\n\tmat4 view;\n\tmat4 projection;\n\tmat4 invProjection;\n\tmat4 modelView;\n\tmat4 invModelView;\n\tmat3 normal;\n};\nstruct Struct1 {\n\tsampler2D tex[3];\n\tsampler2D sdfTex;\n};\nstruct Struct2 {\n\tfloat initialVolume;\n\tfloat particleSize;\n};\nstruct Struct3 {\n\tivec2 res;\n\tvec2 invRes;\n\tivec2 mask;\n\tivec2 shift;\n};\nstruct Struct4 {\n\tivec3 res;\n\tvec3 invRes;\n\tivec3 mask;\n\tivec3 shift;\n};\n\nlayout(location = 0) in vec4 aPosition;\nlayout(location = 1) in vec4 aColor;\nlayout(location = 2) in vec4 aNormal;\nlayout(location = 3) in vec2 aTexCoord;\nuniform float dt;\nuniform Struct0 matrix;\nuniform Struct1 ctex;\nuniform sampler2D depthTex;\nuniform sampler2D colorTex;\nuniform Struct2 pdata;\nuniform Struct3 r2d;\nuniform Struct4 r3d;\nuniform Struct3 r2dm;\nout vec2 vTexCoord;\nuniform vec3 colorVec;\nuniform vec3 boxCenter;\nuniform int pass;\nuniform ivec2 screenRes;\n\nvoid main() {\n\tgl_Position = matrix.transform * aPosition;\n\tvTexCoord = aTexCoord;\n}",
Ka:"#version 300 es\nprecision highp int;\nprecision highp float;\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tmat4 transform;\n\tmat4 model;\n\tmat4 view;\n\tmat4 projection;\n\tmat4 invProjection;\n\tmat4 modelView;\n\tmat4 invModelView;\n\tmat3 normal;\n};\nstruct Struct1 {\n\tsampler2D tex[3];\n\tsampler2D sdfTex;\n};\nstruct Struct2 {\n\tfloat initialVolume;\n\tfloat particleSize;\n};\nstruct Struct3 {\n\tivec2 res;\n\tvec2 invRes;\n\tivec2 mask;\n\tivec2 shift;\n};\nstruct Struct4 {\n\tivec3 res;\n\tvec3 invRes;\n\tivec3 mask;\n\tivec3 shift;\n};\nstruct Struct5 {\n\tfloat sigma;\n\tfloat delta;\n\tfloat mu;\n};\n\nuniform float dt;\nuniform Struct0 matrix;\nuniform Struct1 ctex;\nuniform sampler2D depthTex;\nuniform sampler2D colorTex;\nuniform Struct2 pdata;\nuniform Struct3 r2d;\nuniform Struct4 r3d;\nuniform Struct3 r2dm;\nin vec2 vTexCoord;\nuniform vec3 colorVec;\nuniform vec3 boxCenter;\nuniform int pass;\nuniform ivec2 screenRes;\nlayout(location = 0) out vec4 oColor;\n\nbvec2 hg_anon_0(bvec2 a, bvec2 b) {\n\treturn bvec2(ivec2(a) & ivec2(b));\n}\n\nfloat gaussian(vec2 diff, float isigma2) {\n\treturn exp(-0.5 * dot(diff, diff) * isigma2);\n}\n\nvec3 compute1D(sampler2D depthTex, float worldSizeOfPixelAtUnitDist, vec2 coord, vec2 deltaCoord, Struct5 setting) {\n\tfloat depth = texture(depthTex, coord).x;\n\tif (depth < -999999.0) return vec3(depth);\n\tint rad = int(ceil(setting.sigma / (-depth * worldSizeOfPixelAtUnitDist)) + 0.5);\n\tif (rad == 0) return vec3(depth, 0, 0);\n\tfloat sigma = float(rad) / 3.0;\n\tfloat isigma2 = 1.0 / (sigma * sigma);\n\tfloat deltaLow = setting.delta;\n\tfloat deltaHigh = setting.delta;\n\tfloat sum = depth;\n\tfloat sumWeight = 1.0;\n\tvec2 diff = vec2(0);\n\tfor (int i = 1; i < rad + 1; i++) {\n\t\tdiff += deltaCoord;\n\t\tvec2 coord1 = coord - diff;\n\t\tvec2 coord2 = coord + diff;\n\t\tvec2 depths = vec2(texture(depthTex, coord1).x, texture(depthTex, coord2).x);\n\t\tbvec2 accepted = hg_anon_0(greaterThan(depths, vec2(depth - deltaLow)), lessThan(depths, vec2(depth + deltaHigh)));\n\t\tvec2 diffs = (depth - depths) * vec2(accepted);\n\t\tvec2 newLows = max(vec2(deltaLow), diffs + setting.delta);\n\t\tvec2 newHighs = max(vec2(deltaHigh), -diffs + setting.delta);\n\t\tvec2 newLowHigh = max(vec2(newLows.x, newHighs.x), vec2(newLows.y, newHighs.y));\n\t\tdeltaLow = newLowHigh.x;\n\t\tdeltaHigh = newLowHigh.y;\n\t\tfloat weight = any(greaterThan(depths, vec2(depth + deltaHigh))) ? 0.0 : gaussian(vec2(i, 0), isigma2);\n\t\tbvec2 isBackground = lessThan(depths, vec2(depth - deltaLow));\n\t\tdepths = mix(depths, vec2(depth - setting.mu), isBackground);\n\t\tsum += dot(depths * weight, vec2(1));\n\t\tsumWeight += 2.0 * weight;\n\t}\n\treturn vec3(sum / sumWeight, rad, 0);\n}\n\nvec3 computeCleanUp(sampler2D depthTex, vec2 coord, vec2 deltaCoord, Struct5 setting) {\n\tfloat depth = texture(depthTex, coord).x;\n\tif (depth < -999999.0) return vec3(depth);\n\tfloat sum = depth;\n\tfloat sumWeight = 1.0;\n\tvec2 diff = deltaCoord;\n\tfloat delta = setting.delta;\n\tfor (int i = 0; i < 5; i++) {\n\t\tfor (int j = (i == 0 ? 1 : -4); j < 5; j++) {\n\t\t\tvec2 coord1 = coord - diff * vec2(i, j);\n\t\t\tvec2 coord2 = coord + diff * vec2(i, j);\n\t\t\tvec2 depths = vec2(texture(depthTex, coord1).x, texture(depthTex, coord2).x);\n\t\t\tfloat weight = any(greaterThan(depths, vec2(depth + delta))) ? 0.0 : gaussian(vec2(i, j), 0.25);\n\t\t\tbvec2 isBackground = lessThan(depths, vec2(depth - delta));\n\t\t\tdepths = mix(depths, vec2(depth - setting.mu), isBackground);\n\t\t\tsum += dot(depths * weight, vec2(1));\n\t\t\tsumWeight += 2.0 * weight;\n\t\t}\n\t}\n\treturn vec3(sum / sumWeight, 4, 0);\n}\n\nvoid main() {\n\tvec3 ires = vec3(1.0 / vec2(textureSize(depthTex, 0)), 0);\n\tvec2 worldPixelSizeAtUnitDist = 2.0 / (vec2(matrix.projection[0][0], matrix.projection[1][1]) * vec2(screenRes));\n\tvec3 depth = vec3(0);\n\tswitch (pass) {\n\tcase 0:\n\t\t{\n\t\t\tdepth = compute1D(depthTex, worldPixelSizeAtUnitDist.x, vTexCoord, ires.xz, Struct5(0.5, 1.0, 0.3));\n\t\t}\n\t\tbreak;\n\tcase 1:\n\t\t{\n\t\t\tdepth = compute1D(depthTex, worldPixelSizeAtUnitDist.y, vTexCoord, ires.zy, Struct5(0.5, 1.0, 0.3));\n\t\t}\n\t\tbreak;\n\tcase 2:\n\t\t{\n\t\t\tdepth = computeCleanUp(depthTex, vTexCoord, ires.xy, Struct5(0.5, 1.0, 0.3));\n\t\t}\n\t\tbreak;\n\t}\n\toColor = vec4(depth, 1);\n}"};
yd.N=function(){var b=[];b.push({name:"ctex.tex[0]",type:d.s(t.u)});b.push({name:"ctex.tex[1]",type:d.s(t.u)});b.push({name:"ctex.tex[2]",type:d.s(t.u)});return{gb:{name:"dt",type:d.m},ya:{transform:{name:"matrix.transform",type:d.j(4,4)},model:{name:"matrix.model",type:d.j(4,4)},view:{name:"matrix.view",type:d.j(4,4)},Ra:{name:"matrix.projection",type:d.j(4,4)},Ma:{name:"matrix.invProjection",type:d.j(4,4)},Na:{name:"matrix.modelView",type:d.j(4,4)},La:{name:"matrix.invModelView",type:d.j(4,4)},
ua:{name:"matrix.normal",type:d.j(3,3)}},la:{mb:new uc(b,"ctex.tex",d.s(t.u)),Ga:{name:"ctex.sdfTex",type:d.s(t.u)}},Da:{name:"depthTex",type:d.s(t.u)},Ia:{name:"colorTex",type:d.s(t.u)},cb:{ib:{name:"pdata.initialVolume",type:d.m},jb:{name:"pdata.particleSize",type:d.m}},Va:{R:{name:"r2d.res",type:d.l(2)},O:{name:"r2d.invRes",type:d.i(2)},P:{name:"r2d.mask",type:d.l(2)},shift:{name:"r2d.shift",type:d.l(2)}},Xa:{R:{name:"r3d.res",type:d.l(3)},O:{name:"r3d.invRes",type:d.i(3)},P:{name:"r3d.mask",type:d.l(3)},
shift:{name:"r3d.shift",type:d.l(3)}},Wa:{R:{name:"r2dm.res",type:d.l(2)},O:{name:"r2dm.invRes",type:d.i(2)},P:{name:"r2dm.mask",type:d.l(2)},shift:{name:"r2dm.shift",type:d.l(2)}},rb:{name:"colorVec",type:d.i(3)},qb:{name:"boxCenter",type:d.i(3)},Ff:{name:"screenRes",type:d.l(2)},Bd:{name:"inkValue",type:d.m},sd:{name:"foamValue",type:d.m}}}(this);yd.source={Ta:"#version 300 es\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tmat4 transform;\n\tmat4 model;\n\tmat4 view;\n\tmat4 projection;\n\tmat4 invProjection;\n\tmat4 modelView;\n\tmat4 invModelView;\n\tmat3 normal;\n};\nstruct Struct1 {\n\tsampler2D tex[3];\n\tsampler2D sdfTex;\n};\nstruct Struct2 {\n\tfloat initialVolume;\n\tfloat particleSize;\n};\nstruct Struct3 {\n\tivec2 res;\n\tvec2 invRes;\n\tivec2 mask;\n\tivec2 shift;\n};\nstruct Struct4 {\n\tivec3 res;\n\tvec3 invRes;\n\tivec3 mask;\n\tivec3 shift;\n};\n\nlayout(location = 0) in vec4 aPosition;\nlayout(location = 1) in vec4 aColor;\nlayout(location = 2) in vec4 aNormal;\nlayout(location = 3) in vec2 aTexCoord;\nuniform float dt;\nuniform Struct0 matrix;\nuniform Struct1 ctex;\nuniform sampler2D depthTex;\nuniform sampler2D colorTex;\nuniform Struct2 pdata;\nuniform Struct3 r2d;\nuniform Struct4 r3d;\nuniform Struct3 r2dm;\nout vec2 vTexCoord;\nuniform vec3 colorVec;\nuniform vec3 boxCenter;\nuniform ivec2 screenRes;\nuniform float inkValue;\nuniform float foamValue;\n\nvoid main() {\n\tgl_Position = matrix.transform * aPosition;\n\tvTexCoord = aTexCoord;\n}",
Ka:"#version 300 es\nprecision highp int;\nprecision highp float;\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tmat4 transform;\n\tmat4 model;\n\tmat4 view;\n\tmat4 projection;\n\tmat4 invProjection;\n\tmat4 modelView;\n\tmat4 invModelView;\n\tmat3 normal;\n};\nstruct Struct1 {\n\tsampler2D tex[3];\n\tsampler2D sdfTex;\n};\nstruct Struct2 {\n\tfloat initialVolume;\n\tfloat particleSize;\n};\nstruct Struct3 {\n\tivec2 res;\n\tvec2 invRes;\n\tivec2 mask;\n\tivec2 shift;\n};\nstruct Struct4 {\n\tivec3 res;\n\tvec3 invRes;\n\tivec3 mask;\n\tivec3 shift;\n};\n\nuniform float dt;\nuniform Struct0 matrix;\nuniform Struct1 ctex;\nuniform sampler2D depthTex;\nuniform sampler2D colorTex;\nuniform Struct2 pdata;\nuniform Struct3 r2d;\nuniform Struct4 r3d;\nuniform Struct3 r2dm;\nin vec2 vTexCoord;\nuniform vec3 colorVec;\nuniform vec3 boxCenter;\nuniform ivec2 screenRes;\nuniform float inkValue;\nuniform float foamValue;\nlayout(location = 0) out vec4 oColor;\n\nvec4 bilin(sampler2D tex, vec2 res, vec2 ires, vec2 coord) {\n\tvec2 f2d = coord * res - 0.5;\n\tvec2 fr = fract(f2d);\n\tvec2 i1 = floor(f2d) + 0.5;\n\tvec2 i2 = i1 + 1.0;\n\tvec4 coord12 = vec4(i1, i2) * ires.xyxy;\n\tvec4 txy = texture(tex, coord12.xy);\n\tvec4 txY = texture(tex, coord12.xw);\n\tvec4 tXy = texture(tex, coord12.zy);\n\tvec4 tXY = texture(tex, coord12.zw);\n\tvec4 tx = mix(txy, txY, fr.y);\n\tvec4 tX = mix(tXy, tXY, fr.y);\n\treturn mix(tx, tX, fr.x);\n}\n\nvec3 lighting(vec3 color, vec3 position, vec3 normal, float specular) {\n\tvec3 light = normalize(vec3(1, -2, -3));\n\tcolor *= (0.4 + max(0.0, -dot(normal, light)) * 0.6);\n\tvec3 eye = normalize(position);\n\tvec3 refl = eye - 2.0 * dot(eye, normal) * normal;\n\tfloat reflDot = max(0.0, -dot(light, refl));\n\tcolor += pow(reflDot, 3.0) * specular;\n\treturn color;\n}\n\nvoid main() {\n\tivec2 dres = textureSize(depthTex, 0);\n\tvec2 idres = 1.0 / vec2(dres);\n\tfloat depthC = bilin(depthTex, vec2(dres), idres, vTexCoord).x;\n\tif (depthC < -500000.0) discard;\n\tvec2 ideltaXY = vec2(matrix.projection[0][0] * float(screenRes.x), matrix.projection[1][1] * float(screenRes.y)) / (2.0 * -depthC);\n\tvec3 ires = vec3(1.0 / vec2(screenRes), 0);\n\tvec2 depthXY = vec2(bilin(depthTex, vec2(dres), idres, vTexCoord + ires.xz).x, bilin(depthTex, vec2(dres), idres, vTexCoord + ires.zy).x);\n\tvec2 ddelta = (depthXY - depthC) * ideltaXY;\n\tvec3 normal = normalize(vec3(-ddelta, 1));\n\tvec4 viewPos = matrix.invProjection * vec4(vTexCoord, 0, 1);\n\tviewPos.xyz /= viewPos.w;\n\tviewPos *= depthC / viewPos.z;\n\tvec4 colorTexValue = bilin(colorTex, vec2(dres), idres, vTexCoord);\n\tfloat thickness = colorTexValue.x;\n\tfloat fresnel = pow(1.0 - normal.z, 4.0);\n\tvec3 color = lighting(vec3(0), viewPos.xyz, normal, 0.8);\n\tcolor += smoothstep(0.0, 0.2, fresnel) * 0.2;\n\tcolor += exp(vec3(-0.5, -0.19999999999999996, -0.050000000000000044) * thickness * 0.05 * inkValue) * vec3(0.5, 0.55, 0.6);\n\tfloat foamThickness = max(0.0, colorTexValue.y - 1.0 / (0.5 + foamValue * 0.5));\n\tfloat foamZ = foamThickness > 0.0 ? colorTexValue.z / colorTexValue.y : 0.0;\n\tfloat foamDepth = clamp(viewPos.z - foamZ - 0.3, 0.0, thickness * 0.5);\n\tfloat foamAlpha = (1.0 - exp(-foamThickness * 0.1 * foamValue)) * exp(-foamDepth * 0.5);\n\tcolor = mix(color, vec3(0.95, 0.98, 1), foamAlpha);\n\toColor = vec4(color, 1);\n}"};
Ke.N=function(){var b=[];b.push({name:"ctex.tex[0]",type:d.s(t.u)});b.push({name:"ctex.tex[1]",type:d.s(t.u)});b.push({name:"ctex.tex[2]",type:d.s(t.u)});return{gb:{name:"dt",type:d.m},ya:{transform:{name:"matrix.transform",type:d.j(4,4)},model:{name:"matrix.model",type:d.j(4,4)},view:{name:"matrix.view",type:d.j(4,4)},Ra:{name:"matrix.projection",type:d.j(4,4)},Ma:{name:"matrix.invProjection",type:d.j(4,4)},Na:{name:"matrix.modelView",type:d.j(4,4)},La:{name:"matrix.invModelView",type:d.j(4,4)},
ua:{name:"matrix.normal",type:d.j(3,3)}},la:{mb:new uc(b,"ctex.tex",d.s(t.u)),Ga:{name:"ctex.sdfTex",type:d.s(t.u)}},Da:{name:"depthTex",type:d.s(t.u)},Ia:{name:"colorTex",type:d.s(t.u)},cb:{ib:{name:"pdata.initialVolume",type:d.m},jb:{name:"pdata.particleSize",type:d.m}},Va:{R:{name:"r2d.res",type:d.l(2)},O:{name:"r2d.invRes",type:d.i(2)},P:{name:"r2d.mask",type:d.l(2)},shift:{name:"r2d.shift",type:d.l(2)}},Xa:{R:{name:"r3d.res",type:d.l(3)},O:{name:"r3d.invRes",type:d.i(3)},P:{name:"r3d.mask",type:d.l(3)},
shift:{name:"r3d.shift",type:d.l(3)}},Wa:{R:{name:"r2dm.res",type:d.l(2)},O:{name:"r2dm.invRes",type:d.i(2)},P:{name:"r2dm.mask",type:d.l(2)},shift:{name:"r2dm.shift",type:d.l(2)}},rb:{name:"colorVec",type:d.i(3)},qb:{name:"boxCenter",type:d.i(3)}}}(this);Ke.source={Ta:"#version 300 es\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tivec3 res;\n\tvec3 invRes;\n\tivec3 mask;\n\tivec3 shift;\n};\nstruct Struct1 {\n\tivec2 res;\n\tvec2 invRes;\n\tivec2 mask;\n\tivec2 shift;\n};\nstruct Struct2 {\n\tvec3 momentum;\n\tfloat mass;\n\tvec3 vel;\n};\nstruct Struct3 {\n\tsampler2D tex[3];\n\tsampler2D sdfTex;\n};\nstruct Struct4 {\n\tmat4 transform;\n\tmat4 model;\n\tmat4 view;\n\tmat4 projection;\n\tmat4 invProjection;\n\tmat4 modelView;\n\tmat4 invModelView;\n\tmat3 normal;\n};\nstruct Struct5 {\n\tfloat initialVolume;\n\tfloat particleSize;\n};\n\nlayout(location = 0) in vec4 aPosition;\nlayout(location = 1) in vec4 aColor;\nlayout(location = 2) in vec4 aNormal;\nlayout(location = 3) in vec2 aTexCoord;\nuniform float dt;\nuniform Struct4 matrix;\nuniform Struct3 ctex;\nuniform sampler2D depthTex;\nuniform sampler2D colorTex;\nuniform Struct5 pdata;\nuniform Struct1 r2d;\nuniform Struct0 r3d;\nuniform Struct1 r2dm;\nout vec2 vTexCoord;\nuniform vec3 colorVec;\nuniform vec3 boxCenter;\nout vec4 vColor;\n\nivec3 toIndex3D(Struct0 r3d, int index) {\n\treturn ivec3(index) >> r3d.shift & r3d.mask;\n}\n\nint toIndex(Struct0 r3d, ivec3 i3d) {\n\tivec3 index = (i3d & r3d.mask) << r3d.shift;\n\treturn index.x | index.y | index.z;\n}\n\nivec2 toIndex2D(Struct1 r2d, int index) {\n\treturn ivec2(index) >> r2d.shift & r2d.mask;\n}\n\nivec2 toIndex2D(Struct1 r2d, Struct0 r3d, ivec3 i3d) {\n\treturn toIndex2D(r2d, toIndex(r3d, i3d));\n}\n\nStruct2 readCellData(Struct3 tex, ivec2 i2d) {\n\tvec4 v1 = texelFetch(tex.tex[0], i2d, 0);\n\tvec4 v2 = texelFetch(tex.tex[1], i2d, 0);\n\treturn Struct2(vec3(v1.xyz), v1.w, vec3(v2.xyz));\n}\n\nvoid main() {\n\tivec3 i3d = toIndex3D(r3d, gl_InstanceID);\n\tivec2 i2d = toIndex2D(r2d, r3d, i3d);\n\tStruct2 c = readCellData(ctex, i2d);\n\tfloat scale = aPosition.x * 5.0;\n\tvec4 pos = vec4(vec3(i3d) + 0.5 + c.vel * scale, 1);\n\tgl_Position = matrix.transform * pos;\n\tfloat alpha = c.mass * 2.0;\n\tvColor = vec4(1, 1, 1, alpha);\n}",
Ka:"#version 300 es\nprecision highp int;\nprecision highp float;\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tivec3 res;\n\tvec3 invRes;\n\tivec3 mask;\n\tivec3 shift;\n};\nstruct Struct1 {\n\tivec2 res;\n\tvec2 invRes;\n\tivec2 mask;\n\tivec2 shift;\n};\nstruct Struct3 {\n\tsampler2D tex[3];\n\tsampler2D sdfTex;\n};\nstruct Struct4 {\n\tmat4 transform;\n\tmat4 model;\n\tmat4 view;\n\tmat4 projection;\n\tmat4 invProjection;\n\tmat4 modelView;\n\tmat4 invModelView;\n\tmat3 normal;\n};\nstruct Struct5 {\n\tfloat initialVolume;\n\tfloat particleSize;\n};\n\nuniform float dt;\nuniform Struct4 matrix;\nuniform Struct3 ctex;\nuniform sampler2D depthTex;\nuniform sampler2D colorTex;\nuniform Struct5 pdata;\nuniform Struct1 r2d;\nuniform Struct0 r3d;\nuniform Struct1 r2dm;\nin vec2 vTexCoord;\nuniform vec3 colorVec;\nuniform vec3 boxCenter;\nin vec4 vColor;\nlayout(location = 0) out vec4 oColor;\n\nvoid main() {\n\toColor = vColor;\n}"};
gd.jd=!1;M.Ba=!1;G.Fa={hg:16};z.N=function(){for(var b={transform:{name:"matrix.transform",type:d.j(4,4)},model:{name:"matrix.model",type:d.j(4,4)},view:{name:"matrix.view",type:d.j(4,4)},Ra:{name:"matrix.projection",type:d.j(4,4)},Ma:{name:"matrix.invProjection",type:d.j(4,4)},Na:{name:"matrix.modelView",type:d.j(4,4)},La:{name:"matrix.invModelView",type:d.j(4,4)},ua:{name:"matrix.normal",type:d.j(3,3)}},a={cd:{name:"material.ambient",type:d.m},qd:{name:"material.diffuse",type:d.m},Pd:{name:"material.specular",
type:d.m},Od:{name:"material.shininess",type:d.m},rd:{name:"material.emission",type:d.m},Ya:{name:"material.texture",type:d.s(t.u)}},c={name:"numLights",type:d.wa},e=[],f=0;16>f;){var g="lights["+f++ +"]";e.push({position:{name:g+".position",type:d.i(4)},color:{name:g+".color",type:d.i(3)},ua:{name:g+".normal",type:d.i(3)}})}return{ya:b,Aa:a,Rb:c,vc:new uc(e,"lights",d.Gc)}}(this);z.attributes={Kb:{name:"aPosition",type:n.i(4),location:0},Ib:{name:"aColor",type:n.i(4),location:1},Jb:{name:"aNormal",
type:n.i(3),location:2},Lb:{name:"aTexCoord",type:n.i(2),location:3}};z.Yc="#version 300 es\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tmat4 transform;\n\tmat4 model;\n\tmat4 view;\n\tmat4 projection;\n\tmat4 invProjection;\n\tmat4 modelView;\n\tmat4 invModelView;\n\tmat3 normal;\n};\nstruct Struct1 {\n\tfloat ambient;\n\tfloat diffuse;\n\tfloat specular;\n\tfloat shininess;\n\tfloat emission;\n\tsampler2D texture;\n};\nstruct Struct2 {\n\tvec4 position;\n\tvec3 color;\n\tvec3 normal;\n};\n\nlayout(location = 0) in vec4 aPosition;\nlayout(location = 1) in vec4 aColor;\nlayout(location = 2) in vec3 aNormal;\nlayout(location = 3) in vec2 aTexCoord;\nuniform Struct0 matrix;\nuniform Struct1 material;\nuniform int numLights;\nuniform Struct2 lights[16];\nout vec4 vColor;\nout vec3 vPosition;\nout vec3 vNormal;\nout vec2 vTexCoord;\n\nvoid main() {\n\tgl_Position = matrix.transform * aPosition;\n\tgl_PointSize = 1.0;\n\tvColor = aColor;\n\tvPosition = (matrix.modelView * aPosition).xyz;\n\tvNormal = matrix.normal * aNormal;\n\tvTexCoord = aTexCoord;\n}";
z.Nc="#version 300 es\nprecision highp int;\nprecision highp float;\nprecision highp sampler2D;\nprecision highp sampler3D;\nprecision highp samplerCube;\nprecision highp samplerCubeShadow;\nprecision highp sampler2DShadow;\nprecision highp sampler2DArray;\nprecision highp sampler2DArrayShadow;\nprecision highp isampler2D;\nprecision highp isampler3D;\nprecision highp isamplerCube;\nprecision highp isampler2DArray;\nprecision highp usampler2D;\nprecision highp usampler3D;\nprecision highp usamplerCube;\nprecision highp usampler2DArray;\n\nstruct Struct0 {\n\tmat4 transform;\n\tmat4 model;\n\tmat4 view;\n\tmat4 projection;\n\tmat4 invProjection;\n\tmat4 modelView;\n\tmat4 invModelView;\n\tmat3 normal;\n};\nstruct Struct1 {\n\tfloat ambient;\n\tfloat diffuse;\n\tfloat specular;\n\tfloat shininess;\n\tfloat emission;\n\tsampler2D texture;\n};\nstruct Struct2 {\n\tvec4 position;\n\tvec3 color;\n\tvec3 normal;\n};\n\nuniform Struct0 matrix;\nuniform Struct1 material;\nuniform int numLights;\nuniform Struct2 lights[16];\nin vec4 vColor;\nin vec3 vPosition;\nin vec3 vNormal;\nin vec2 vTexCoord;\nlayout(location = 0) out vec4 oColor;\n\nvec4 computeBaseColor() {\n\treturn texture(material.texture, vTexCoord) * vColor;\n}\n\nvec3 safeNormalize(vec3 v) {\n\treturn dot(v, v) > 0.0 ? normalize(v) : vec3(0);\n}\n\nvec3 ambientLight(vec3 lightColor, vec3 color) {\n\treturn lightColor * color * material.ambient;\n}\n\nvec3 directionalLight(vec3 lightColor, vec3 lightDirection, vec3 eye, vec3 normal, vec3 color) {\n\tfloat ldot = max(-dot(lightDirection, normal), 0.0);\n\tvec3 res = lightColor * color * ldot * material.diffuse;\n\tif (dot(normal, eye) < 0.0) {\n\t\tvec3 reflEye = eye - 2.0 * normal * dot(eye, normal);\n\t\tfloat rdot = max(-dot(reflEye, lightDirection), 0.0);\n\t\tres += lightColor * pow(rdot, material.shininess) * material.specular;\n\t}\n\treturn res;\n}\n\nvoid main() {\n\tvec4 baseColor = computeBaseColor();\n\tif (baseColor.w == 0.0) {\n\t\tdiscard;\n\t}\n\tif (numLights == 0) {\n\t\toColor = baseColor;\n\t\treturn;\n\t}\n\tvec3 eye = safeNormalize(vPosition);\n\tvec3 n = safeNormalize(vNormal);\n\tif (!gl_FrontFacing) {\n\t\tn = -n;\n\t}\n\tvec3 color = baseColor.xyz;\n\tvec3 total = color * material.emission;\n\tfor (int i = 0; i < numLights; i++) {\n\t\tStruct2 light = lights[i];\n\t\tvec4 lp = light.position;\n\t\tvec3 lc = light.color;\n\t\tvec3 ln = light.normal;\n\t\tbool amb = lp.w == 0.0 && dot(ln, ln) == 0.0;\n\t\tif (amb) {\n\t\t\ttotal += ambientLight(lc, color);\n\t\t}\n\t\telse {\n\t\t\tbool dir = lp.w == 0.0;\n\t\t\tif (!dir) {\n\t\t\t\tln = safeNormalize(vPosition - lp.xyz);\n\t\t\t}\n\t\t\tfloat ldot = max(-dot(ln, n), 0.0);\n\t\t\ttotal += directionalLight(lc, ln, eye, n, color);\n\t\t}\n\t}\n\toColor = vec4(total, baseColor.w);\n}";
E.Ue="F1 F2 F3 F4 F5 F6 F7 F8 F9 F10 F11 F12".split(" ");E.Qf="Escape Digit0 Digit1 Digit2 Digit3 Digit4 Digit5 Digit6 Digit7 Digit8 Digit9 Minus Equal Backspace Tab KeyQ KeyW KeyE KeyR KeyT KeyY KeyU KeyI KeyO KeyP BracketLeft BracketRight Enter ControlLeft KeyA KeyS KeyD KeyF KeyG KeyH KeyJ KeyK KeyL Semicolon Quote Backquote ShiftLeft Backslash KeyZ KeyX KeyC KeyV KeyB KeyN KeyM Comma Period Slash ShiftRight NumpadMultiply AltLeft Space CapsLock F1 F2 F3 F4 F5 F6 F7 F8 F9 F10 Numpad7 Numpad8 Numpad9 NumpadSubtract Numpad4 Numpad5 Numpad6 NumpadAdd Numpad1 Numpad2 Numpad3 Numpad0 NumpadDecimal IntlBackslash F11 F12 IntlYen NumpadEnter ControlRight NumpadDivide PrintScreen AltRight NumLock Home ArrowUp PageUp ArrowLeft ArrowRight End ArrowDown PageDown Insert Delete ContextMenu".split(" ");
N.rh()})("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);